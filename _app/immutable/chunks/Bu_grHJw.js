const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CHKDjEZ-.js","./DvumDe3Y.js","./HrrS11cL.js","./DeqPN9fI.js","./DZr1-enG.js","./CPws4d4z.js","./D594CN9I.js","./Bo-R5oOz.js","./Cpj98o6Y.js","./DIXDofUi.js"])))=>i.map(i=>d[i]);
var D1=Object.defineProperty;var M1=(r,e,t)=>e in r?D1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Xa=(r,e,t)=>M1(r,typeof e!="symbol"?e+"":e,t);import{s as Yi,e as D,c as M,b as G,f as w,m as I,i as F,h as b,n as st,p as vi,T as Fh,z as Qi,v as Ge,a4 as Ts,a5 as Nh,a as ee,g as te,l as Le,L as Gh,y as jt,a6 as ts,r as tt,u as xs,t as W,d as Y,U as Ft,V as Nt,j as pe,q as Ct,a7 as P1,J as O1,C as Vi,W as Pn,B as Gr}from"./CNfp-pg6.js";import{S as Rr,i as br,f as On,b as Gi,d as Ui,m as zi,a as rt,g as cr,t as ft,c as ur,e as Bi}from"./Bl6iaqvC.js";import{F as k1,a as F1,L as Uh,t as Va}from"./C_BCGpTB.js";import{e as mt}from"./D6YF6ztN.js";import{A as ja}from"./BO6XNHuD.js";import{g as zh}from"./Cpj98o6Y.js";import{_ as Ki}from"./C1FmrZbK.js";function Xe(r,e){if(!r)throw new Error(e)}class Bh{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return Xe(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return Xe(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var t;return(t=this.entries_[e])==null?void 0:t.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){Xe(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}const dt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function fo(r){const e=li();for(let t=0,i=r.length;t<i;++t)or(e,r[t]);return e}function Oo(r,e,t){return t?(t[0]=r[0]-e,t[1]=r[1]-e,t[2]=r[2]+e,t[3]=r[3]+e,t):[r[0]-e,r[1]-e,r[2]+e,r[3]+e]}function Xh(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r.slice()}function Vh(r,e,t){let i,n;return e<r[0]?i=r[0]-e:r[2]<e?i=e-r[2]:i=0,t<r[1]?n=r[1]-t:r[3]<t?n=t-r[3]:n=0,i*i+n*n}function on(r,e){return jh(r,e[0],e[1])}function er(r,e){return r[0]<=e[0]&&e[2]<=r[2]&&r[1]<=e[1]&&e[3]<=r[3]}function jh(r,e,t){return r[0]<=e&&e<=r[2]&&r[1]<=t&&t<=r[3]}function go(r,e){const t=r[0],i=r[1],n=r[2],s=r[3],o=e[0],a=e[1];let l=dt.UNKNOWN;return o<t?l=l|dt.LEFT:o>n&&(l=l|dt.RIGHT),a<i?l=l|dt.BELOW:a>s&&(l=l|dt.ABOVE),l===dt.UNKNOWN&&(l=dt.INTERSECTING),l}function li(){return[1/0,1/0,-1/0,-1/0]}function an(r,e,t,i,n){return n?(n[0]=r,n[1]=e,n[2]=t,n[3]=i,n):[r,e,t,i]}function vs(r){return an(1/0,1/0,-1/0,-1/0,r)}function N1(r,e){const t=r[0],i=r[1];return an(t,i,t,i,e)}function G1(r,e,t,i,n){const s=vs(n);return Wh(s,r,e,t,i)}function Wa(r,e){return r[0]==e[0]&&r[2]==e[2]&&r[1]==e[1]&&r[3]==e[3]}function U1(r,e){return e[0]<r[0]&&(r[0]=e[0]),e[2]>r[2]&&(r[2]=e[2]),e[1]<r[1]&&(r[1]=e[1]),e[3]>r[3]&&(r[3]=e[3]),r}function or(r,e){e[0]<r[0]&&(r[0]=e[0]),e[0]>r[2]&&(r[2]=e[0]),e[1]<r[1]&&(r[1]=e[1]),e[1]>r[3]&&(r[3]=e[1])}function Wh(r,e,t,i,n){for(;t<i;t+=n)z1(r,e[t],e[t+1]);return r}function z1(r,e,t){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}function Yh(r,e){let t;return t=e(ws(r)),t||(t=e(Cs(r)),t)||(t=e(Rs(r)),t)||(t=e(Xn(r)),t)?t:!1}function dr(r){let e=0;return Ir(r)||(e=Ye(r)*Bt(r)),e}function ws(r){return[r[0],r[1]]}function Cs(r){return[r[2],r[1]]}function ln(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function B1(r,e){let t;if(e==="bottom-left")t=ws(r);else if(e==="bottom-right")t=Cs(r);else if(e==="top-left")t=Xn(r);else if(e==="top-right")t=Rs(r);else throw new Error("Invalid corner");return t}function _o(r,e,t,i,n){const[s,o,a,l,h,c,u,d]=X1(r,e,t,i);return an(Math.min(s,a,h,u),Math.min(o,l,c,d),Math.max(s,a,h,u),Math.max(o,l,c,d),n)}function X1(r,e,t,i){const n=e*i[0]/2,s=e*i[1]/2,o=Math.cos(t),a=Math.sin(t),l=n*o,h=n*a,c=s*o,u=s*a,d=r[0],f=r[1];return[d-l+u,f-h-c,d-l-u,f-h+c,d+l-u,f+h+c,d+l+u,f+h-c,d-l+u,f-h-c]}function Bt(r){return r[3]-r[1]}function Ht(r,e,t){const i=t||li();return zt(r,e)?(r[0]>e[0]?i[0]=r[0]:i[0]=e[0],r[1]>e[1]?i[1]=r[1]:i[1]=e[1],r[2]<e[2]?i[2]=r[2]:i[2]=e[2],r[3]<e[3]?i[3]=r[3]:i[3]=e[3]):vs(i),i}function Xn(r){return[r[0],r[3]]}function Rs(r){return[r[2],r[3]]}function Ye(r){return r[2]-r[0]}function zt(r,e){return r[0]<=e[2]&&r[2]>=e[0]&&r[1]<=e[3]&&r[3]>=e[1]}function Ir(r){return r[2]<r[0]||r[3]<r[1]}function V1(r,e){return e?(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e):r}function j1(r,e,t){let i=!1;const n=go(r,e),s=go(r,t);if(n===dt.INTERSECTING||s===dt.INTERSECTING)i=!0;else{const o=r[0],a=r[1],l=r[2],h=r[3],c=e[0],u=e[1],d=t[0],f=t[1],g=(f-u)/(d-c);let _,m;s&dt.ABOVE&&!(n&dt.ABOVE)&&(_=d-(f-h)/g,i=_>=o&&_<=l),!i&&s&dt.RIGHT&&!(n&dt.RIGHT)&&(m=f-(d-l)*g,i=m>=a&&m<=h),!i&&s&dt.BELOW&&!(n&dt.BELOW)&&(_=d-(f-a)/g,i=_>=o&&_<=l),!i&&s&dt.LEFT&&!(n&dt.LEFT)&&(m=f-(d-o)*g,i=m>=a&&m<=h)}return i}function W1(r,e){const t=e.getExtent(),i=ln(r);if(e.canWrapX()&&(i[0]<t[0]||i[0]>=t[2])){const n=Ye(t),o=Math.floor((i[0]-t[0])/n)*n;r[0]-=o,r[2]-=o}return r}const de={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class bs{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}class wi{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}function In(r,e){return r>e?1:r<e?-1:0}function Y1(r,e){return r<e?1:r>e?-1:0}function ko(r,e,t){if(r[0]<=e)return 0;const i=r.length;if(e<=r[i-1])return i-1;if(typeof t=="function"){for(let n=1;n<i;++n){const s=r[n];if(s===e)return n;if(s<e)return t(e,r[n-1],s)>0?n-1:n}return i-1}if(t>0){for(let n=1;n<i;++n)if(r[n]<e)return n-1;return i-1}if(t<0){for(let n=1;n<i;++n)if(r[n]<=e)return n;return i-1}for(let n=1;n<i;++n){if(r[n]==e)return n;if(r[n]<e)return r[n-1]-e<e-r[n]?n-1:n}return i-1}function K1(r,e,t){for(;e<t;){const i=r[e];r[e]=r[t],r[t]=i,++e,--t}}function mo(r,e){const t=Array.isArray(e)?e:[e],i=t.length;for(let n=0;n<i;n++)r[r.length]=t[n]}function Hi(r,e){const t=r.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(r[i]!==e[i])return!1;return!0}function H1(r,e,t){const i=e;return r.every(function(n,s){if(s===0)return!0;const o=i(r[s-1],n);return!(o>0||o===0)})}function kn(){return!0}function Sr(){return!1}function is(){}function Z1(r){let e=!1,t,i,n;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==n||!Hi(s,i))&&(e=!0,n=this,i=s,t=r.apply(this,arguments)),t}}function Kh(r){function e(){let t;try{t=r()}catch(i){return Promise.reject(i)}return t instanceof Promise?t:Promise.resolve(t)}return e()}function cn(r){for(const e in r)delete r[e]}function Fo(r){let e;for(e in r)return!1;return!e}class Ar extends bs{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,t){if(!e||!t)return;const i=this.listeners_||(this.listeners_={}),n=i[e]||(i[e]=[]);n.includes(t)||n.push(t)}dispatchEvent(e){const t=typeof e=="string",i=t?e:e.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const s=t?new wi(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let h=0,c=n.length;h<c;++h)if("handleEvent"in n[h]?l=n[h].handleEvent(s):l=n[h].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,is);delete o[i]}return l}disposeInternal(){this.listeners_&&cn(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,t){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const n=i.indexOf(t);n!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[n]=is,++this.pendingRemovals_[e]):(i.splice(n,1),i.length===0&&delete this.listeners_[e]))}}const H={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Oe(){throw new Error("Unimplemented abstract method.")}let q1=0;function Ne(r){return r.ol_uid||(r.ol_uid=String(++q1))}function Hh(r){return Math.pow(r,3)}function Vn(r){return 1-Hh(1-r)}function $1(r){return 3*r*r-2*r*r*r}function J1(r){return r}class No extends Ar{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.interimTile=null,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(de.CHANGE)}release(){this.state===H.ERROR&&this.setState(H.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let e=this.interimTile;if(!e)return this;do{if(e.getState()==H.LOADED)return this.transition_=0,e;e=e.interimTile}while(e);return this}refreshInterimChain(){let e=this.interimTile;if(!e)return;let t=this;do{if(e.getState()==H.LOADED){e.interimTile=null;break}e.getState()==H.LOADING?t=e:e.getState()==H.IDLE?t.interimTile=e.interimTile:t=e,e=t.interimTile}while(e)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==H.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){Oe()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const n=t-i+1e3/60;return n>=this.transition_?1:Hh(n/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}}const ji=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Q1=ji.includes("firefox"),eu=ji.includes("safari")&&!ji.includes("chrom"),tu=eu&&(ji.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ji)),iu=ji.includes("webkit")&&!ji.includes("edge"),Zh=ji.includes("macintosh"),qh=typeof devicePixelRatio<"u"?devicePixelRatio:1,$h=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Jh=typeof Image<"u"&&Image.prototype.decode,Qh=function(){let r=!1;try{const e=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return r}();function ht(r,e,t,i){let n;return t&&t.length?n=t.shift():$h?n=new OffscreenCanvas(r||300,e||300):n=document.createElement("canvas"),r&&(n.width=r),e&&(n.height=e),n.getContext("2d",i)}let Us;function po(){return Us||(Us=ht(1,1)),Us}function Fn(r){const e=r.canvas;e.width=1,e.height=1,r.clearRect(0,0,1,1)}function Ya(r,e){const t=e.parentNode;t&&t.replaceChild(r,e)}function yo(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function nu(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function ru(r,e){const t=r.childNodes;for(let i=0;;++i){const n=t[i],s=e[i];if(!n&&!s)break;if(n!==s){if(!n){r.appendChild(s);continue}if(!s){r.removeChild(n),--i;continue}r.insertBefore(s,n)}}}const be={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ze(r,e,t,i,n){if(i&&i!==r&&(t=t.bind(i)),n){const o=t;t=function(){r.removeEventListener(e,t),o.apply(this,arguments)}}const s={target:r,type:e,listener:t};return r.addEventListener(e,t),s}function ns(r,e,t,i){return ze(r,e,t,i,!0)}function He(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),cn(r))}function su(r,e,t){const i=r;let n=!0,s=!1,o=!1;const a=[ns(i,de.LOAD,function(){o=!0,s||e()})];return i.src&&Jh?(s=!0,i.decode().then(function(){n&&e()}).catch(function(l){n&&(o?e():t())})):a.push(ns(i,de.ERROR,t)),function(){n=!1,a.forEach(He)}}function ou(r,e){return new Promise((t,i)=>{function n(){o(),t(r)}function s(){o(),i(new Error("Image load error"))}function o(){r.removeEventListener("load",n),r.removeEventListener("error",s)}r.addEventListener("load",n),r.addEventListener("error",s)})}function au(r,e){return e&&(r.src=e),r.src&&Jh?new Promise((t,i)=>r.decode().then(()=>t(r)).catch(n=>r.complete&&r.width?t(r):i(n))):ou(r)}class Go extends No{constructor(e,t,i,n,s,o){super(e,t,o),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,n!==null&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=H.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=H.ERROR,this.unlistenImage_(),this.image_=lu(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=H.LOADED:this.state=H.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==H.ERROR&&(this.state=H.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==H.IDLE&&(this.state=H.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=su(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function lu(){const r=ht(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}const ec=.5,hu={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function Ka(r){return hu[r]}const Uo={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class rs{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Uo[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Lr=6378137,Rn=Math.PI*Lr,cu=[-Rn,-Rn,Rn,Rn],uu=[-180,-85,180,85],Ur=Lr*Math.log(Math.tan(Math.PI/2));class dn extends rs{constructor(e){super({code:e,units:"m",extent:cu,global:!0,worldExtent:uu,getPointResolution:function(t,i){return t/Math.cosh(i[1]/Lr)}})}}const Ha=[new dn("EPSG:3857"),new dn("EPSG:102100"),new dn("EPSG:102113"),new dn("EPSG:900913"),new dn("http://www.opengis.net/def/crs/EPSG/0/3857"),new dn("http://www.opengis.net/gml/srs/epsg.xml#3857")];function du(r,e,t){const i=r.length;t=t>1?t:2,e===void 0&&(t>2?e=r.slice():e=new Array(i));for(let n=0;n<i;n+=t){e[n]=Rn*r[n]/180;let s=Lr*Math.log(Math.tan(Math.PI*(+r[n+1]+90)/360));s>Ur?s=Ur:s<-Ur&&(s=-Ur),e[n+1]=s}return e}function fu(r,e,t){const i=r.length;t=t>1?t:2,e===void 0&&(t>2?e=r.slice():e=new Array(i));for(let n=0;n<i;n+=t)e[n]=180*r[n]/Rn,e[n+1]=360*Math.atan(Math.exp(r[n+1]/Lr))/Math.PI-90;return e}const gu=6378137,Za=[-180,-90,180,90],_u=Math.PI*gu/180;class qi extends rs{constructor(e,t){super({code:e,units:"degrees",extent:Za,axisOrientation:t,global:!0,metersPerUnit:_u,worldExtent:Za})}}const qa=[new qi("CRS:84"),new qi("EPSG:4326","neu"),new qi("urn:ogc:def:crs:OGC:1.3:CRS84"),new qi("urn:ogc:def:crs:OGC:2:84"),new qi("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new qi("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new qi("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Eo={};function mu(r){return Eo[r]||Eo[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function pu(r,e){Eo[r]=e}let Sn={};function ss(r,e,t){const i=r.getCode(),n=e.getCode();i in Sn||(Sn[i]={}),Sn[i][n]=t}function yu(r,e){let t;return r in Sn&&e in Sn[r]&&(t=Sn[r][e]),t}function Je(r,e,t){return Math.min(Math.max(r,e),t)}function Eu(r,e,t,i,n,s){const o=n-t,a=s-i;if(o!==0||a!==0){const l=((r-t)*o+(e-i)*a)/(o*o+a*a);l>1?(t=n,i=s):l>0&&(t+=o*l,i+=a*l)}return An(r,e,t,i)}function An(r,e,t,i){const n=t-r,s=i-e;return n*n+s*s}function Tu(r){const e=r.length;for(let i=0;i<e;i++){let n=i,s=Math.abs(r[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(r[a][i]);l>s&&(s=l,n=a)}if(s===0)return null;const o=r[n];r[n]=r[i],r[i]=o;for(let a=i+1;a<e;a++){const l=-r[a][i]/r[i][i];for(let h=i;h<e+1;h++)i==h?r[a][h]=0:r[a][h]+=l*r[i][h]}}const t=new Array(e);for(let i=e-1;i>=0;i--){t[i]=r[i][e]/r[i][i];for(let n=i-1;n>=0;n--)r[n][e]-=r[n][i]*t[i]}return t}function Qr(r){return r*Math.PI/180}function Ln(r,e){const t=r%e;return t*e<0?t+e:t}function Kt(r,e,t){return r+t*(e-r)}function zo(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}function zr(r,e){return Math.floor(zo(r,e))}function Br(r,e){return Math.ceil(zo(r,e))}function xu(r,e){return r[0]+=+e[0],r[1]+=+e[1],r}function os(r,e){let t=!0;for(let i=r.length-1;i>=0;--i)if(r[i]!=e[i]){t=!1;break}return t}function Bo(r,e){const t=Math.cos(e),i=Math.sin(e),n=r[0]*t-r[1]*i,s=r[1]*t+r[0]*i;return r[0]=n,r[1]=s,r}function vu(r,e){return r[0]*=e,r[1]*=e,r}function tc(r,e){if(e.canWrapX()){const t=Ye(e.getExtent()),i=wu(r,e,t);i&&(r[0]-=i*t)}return r}function wu(r,e,t){const i=e.getExtent();let n=0;return e.canWrapX()&&(r[0]<i[0]||r[0]>i[2])&&(t=t||Ye(i),n=Math.floor((r[0]-i[0])/t)),n}const Cu=63710088e-1;function $a(r,e,t){t=t||Cu;const i=Qr(r[1]),n=Qr(e[1]),s=(n-i)/2,o=Qr(e[0]-r[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(n);return 2*t*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function ic(...r){console.warn(...r)}function Ja(...r){console.error(...r)}let To=!0;function Ru(r){To=!1}function Xo(r,e){if(e!==void 0){for(let t=0,i=r.length;t<i;++t)e[t]=r[t];e=e}else e=r.slice();return e}function nc(r,e){if(e!==void 0&&r!==e){for(let t=0,i=r.length;t<i;++t)e[t]=r[t];r=e}return r}function bu(r){pu(r.getCode(),r),ss(r,r,Xo)}function Iu(r){r.forEach(bu)}function Ut(r){return typeof r=="string"?mu(r):r||null}function Qa(r,e,t,i){r=Ut(r);let n;const s=r.getPointResolutionFunc();if(s)n=s(e,t);else{const o=r.getUnits();if(o=="degrees"||i=="degrees")n=e;else{const a=jo(r,Ut("EPSG:4326"));if(a===nc&&o!=="degrees")n=e*r.getMetersPerUnit();else{let h=[t[0]-e/2,t[1],t[0]+e/2,t[1],t[0],t[1]-e/2,t[0],t[1]+e/2];h=a(h,h,2);const c=$a(h.slice(0,2),h.slice(2,4)),u=$a(h.slice(4,6),h.slice(6,8));n=(c+u)/2}const l=r.getMetersPerUnit();l!==void 0&&(n/=l)}}return n}function el(r){Iu(r),r.forEach(function(e){r.forEach(function(t){e!==t&&ss(e,t,Xo)})})}function Su(r,e,t,i){r.forEach(function(n){e.forEach(function(s){ss(n,s,t),ss(s,n,i)})})}function Vo(r,e){return r?typeof r=="string"?Ut(r):r:Ut(e)}function ii(r,e){if(r===e)return!0;const t=r.getUnits()===e.getUnits();return(r.getCode()===e.getCode()||jo(r,e)===Xo)&&t}function jo(r,e){const t=r.getCode(),i=e.getCode();let n=yu(t,i);return n||(n=nc),n}function as(r,e){const t=Ut(r),i=Ut(e);return jo(t,i)}function Au(r,e,t){return as(e,t)(r,void 0,r.length)}function ls(r,e){return r}function mi(r,e){return To&&!os(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(To=!1,ic("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r}function Wo(r,e){return r}function en(r,e){return r}function Lu(){el(Ha),el(qa),Su(qa,Ha,du,fu)}Lu();const Du=10,tl=.25;class rc{constructor(e,t,i,n,s,o){this.sourceProj_=e,this.targetProj_=t;let a={};const l=as(this.targetProj_,this.sourceProj_);this.transformInv_=function(p){const T=p[0]+"/"+p[1];return a[T]||(a[T]=l(p)),a[T]},this.maxSourceExtent_=n,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&Ye(n)>=Ye(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Ye(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Ye(this.targetProj_.getExtent()):null;const h=Xn(i),c=Rs(i),u=Cs(i),d=ws(i),f=this.transformInv_(h),g=this.transformInv_(c),_=this.transformInv_(u),m=this.transformInv_(d),y=Du+(o?Math.max(0,Math.ceil(Math.log2(dr(i)/(o*o*256*256)))):0);if(this.addQuad_(h,c,u,d,f,g,_,m,y),this.wrapsXInSource_){let p=1/0;this.triangles_.forEach(function(T,E,x){p=Math.min(p,T.source[0][0],T.source[1][0],T.source[2][0])}),this.triangles_.forEach(T=>{if(Math.max(T.source[0][0],T.source[1][0],T.source[2][0])-p>this.sourceWorldWidth_/2){const E=[[T.source[0][0],T.source[0][1]],[T.source[1][0],T.source[1][1]],[T.source[2][0],T.source[2][1]]];E[0][0]-p>this.sourceWorldWidth_/2&&(E[0][0]-=this.sourceWorldWidth_),E[1][0]-p>this.sourceWorldWidth_/2&&(E[1][0]-=this.sourceWorldWidth_),E[2][0]-p>this.sourceWorldWidth_/2&&(E[2][0]-=this.sourceWorldWidth_);const x=Math.min(E[0][0],E[1][0],E[2][0]);Math.max(E[0][0],E[1][0],E[2][0])-x<this.sourceWorldWidth_/2&&(T.source=E)}})}a={}}addTriangle_(e,t,i,n,s,o){this.triangles_.push({source:[n,s,o],target:[e,t,i]})}addQuad_(e,t,i,n,s,o,a,l,h){const c=fo([s,o,a,l]),u=this.sourceWorldWidth_?Ye(c)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const m=fo([e,t,i,n]);g=Ye(m)/this.targetWorldWidth_>tl||g}!f&&this.sourceProj_.isGlobal()&&u&&(g=u>tl||g)}if(!g&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!zt(c,this.maxSourceExtent_))return;let _=0;if(!g&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(h>0)g=!0;else if(_=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(h>0){if(!g){const m=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(m);let p;f?p=(Ln(s[0],d)+Ln(a[0],d))/2-Ln(y[0],d):p=(s[0]+a[0])/2-y[0];const T=(s[1]+a[1])/2-y[1];g=p*p+T*T>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const m=[(t[0]+i[0])/2,(t[1]+i[1])/2],y=this.transformInv_(m),p=[(n[0]+e[0])/2,(n[1]+e[1])/2],T=this.transformInv_(p);this.addQuad_(e,t,m,p,s,o,y,T,h-1),this.addQuad_(p,m,i,n,T,y,a,l,h-1)}else{const m=[(e[0]+t[0])/2,(e[1]+t[1])/2],y=this.transformInv_(m),p=[(i[0]+n[0])/2,(i[1]+n[1])/2],T=this.transformInv_(p);this.addQuad_(e,m,p,n,s,y,T,l,h-1),this.addQuad_(m,t,i,p,y,o,a,T,h-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}_&11||this.addTriangle_(e,i,n,s,a,l),_&14||this.addTriangle_(e,i,t,s,a,o),_&&(_&13||this.addTriangle_(t,n,e,o,l,s),_&7||this.addTriangle_(t,n,i,o,l,a))}calculateSourceExtent(){const e=li();return this.triangles_.forEach(function(t,i,n){const s=t.source;or(e,s[0]),or(e,s[1]),or(e,s[2])}),e}getTriangles(){return this.triangles_}}let zs;const Ei=[];function il(r,e,t,i,n){r.beginPath(),r.moveTo(0,0),r.lineTo(e,t),r.lineTo(i,n),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(e,i)+1,Math.max(t,n)),r.restore()}function Bs(r,e){return Math.abs(r[e*4]-210)>2||Math.abs(r[e*4+3]-.75*255)>2}function Mu(){if(zs===void 0){const r=ht(6,6,Ei);r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",il(r,4,5,4,0),il(r,4,5,0,5);const e=r.getImageData(0,0,3,3).data;zs=Bs(e,0)||Bs(e,4)||Bs(e,8),Fn(r),Ei.push(r.canvas)}return zs}function nl(r,e,t,i){const n=Au(t,e,r);let s=Qa(e,i,t);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=r.getMetersPerUnit();a!==void 0&&(s/=a);const l=r.getExtent();if(!l||on(l,n)){const h=Qa(r,s,n)/s;isFinite(h)&&h>0&&(s/=h)}return s}function sc(r,e,t,i){const n=ln(t);let s=nl(r,e,n,i);return(!isFinite(s)||s<=0)&&Yh(t,function(o){return s=nl(r,e,o,i),isFinite(s)&&s>0}),s}function oc(r,e,t,i,n,s,o,a,l,h,c,u,d,f){const g=ht(Math.round(t*r),Math.round(t*e),Ei);if(u||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(t,t);function _(x){return Math.round(x*t)/t}g.globalCompositeOperation="lighter";const m=li();l.forEach(function(x,v,C){U1(m,x.extent)});let y;const p=t/i,T=(u?1:1+Math.pow(2,-24))/p;if(!d||l.length!==1||h!==0){if(y=ht(Math.round(Ye(m)*p),Math.round(Bt(m)*p),Ei),u||(y.imageSmoothingEnabled=!1),n&&f){const x=(n[0]-m[0])*p,v=-(n[3]-m[3])*p,C=Ye(n)*p,R=Bt(n)*p;y.rect(x,v,C,R),y.clip()}l.forEach(function(x,v,C){const R=(x.extent[0]-m[0])*p,S=-(x.extent[3]-m[3])*p,P=Ye(x.extent)*p,O=Bt(x.extent)*p;x.image.width>0&&x.image.height>0&&y.drawImage(x.image,h,h,x.image.width-2*h,x.image.height-2*h,u?R:Math.round(R),u?S:Math.round(S),u?P:Math.round(R+P)-Math.round(R),u?O:Math.round(S+O)-Math.round(S))})}const E=Xn(o);return a.getTriangles().forEach(function(x,v,C){const R=x.source,S=x.target;let P=R[0][0],O=R[0][1],N=R[1][0],V=R[1][1],U=R[2][0],L=R[2][1];const k=_((S[0][0]-E[0])/s),Q=_(-(S[0][1]-E[1])/s),q=_((S[1][0]-E[0])/s),ie=_(-(S[1][1]-E[1])/s),J=_((S[2][0]-E[0])/s),Z=_(-(S[2][1]-E[1])/s),fe=P,Ie=O;P=0,O=0,N-=fe,V-=Ie,U-=fe,L-=Ie;const X=[[N,V,0,0,q-k],[U,L,0,0,J-k],[0,0,N,V,ie-Q],[0,0,U,L,Z-Q]],De=Tu(X);if(!De)return;if(g.save(),g.beginPath(),Mu()||!u){g.moveTo(q,ie);const K=4,ce=k-q,Ke=Q-ie;for(let me=0;me<K;me++)g.lineTo(q+_((me+1)*ce/K),ie+_(me*Ke/(K-1))),me!=K-1&&g.lineTo(q+_((me+1)*ce/K),ie+_((me+1)*Ke/(K-1)));g.lineTo(J,Z)}else g.moveTo(q,ie),g.lineTo(k,Q),g.lineTo(J,Z);g.clip(),g.transform(De[0],De[2],De[1],De[3],k,Q),g.translate(m[0]-fe,m[3]-Ie);let Re;if(y)Re=y.canvas,g.scale(T,-T);else{const K=l[0],ce=K.extent;Re=K.image,g.scale(Ye(ce)/Re.width,-Bt(ce)/Re.height)}g.drawImage(Re,0,0),g.restore()}),y&&(Fn(y),Ei.push(y.canvas)),c&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(x,v,C){const R=x.target,S=(R[0][0]-E[0])/s,P=-(R[0][1]-E[1])/s,O=(R[1][0]-E[0])/s,N=-(R[1][1]-E[1])/s,V=(R[2][0]-E[0])/s,U=-(R[2][1]-E[1])/s;g.beginPath(),g.moveTo(O,N),g.lineTo(S,P),g.lineTo(V,U),g.closePath(),g.stroke()}),g.restore()),g.canvas}class Is extends No{constructor(e,t,i,n,s,o,a,l,h,c,u,d){super(s,H.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=n,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const f=n.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const m=g?Ht(f,g):f;if(dr(m)===0){this.state=H.EMPTY;return}const y=e.getExtent();y&&(_?_=Ht(_,y):_=y);const p=n.getResolution(this.wrappedTileCoord_[0]),T=sc(e,i,m,p);if(!isFinite(T)||T<=0){this.state=H.EMPTY;return}const E=c!==void 0?c:ec;if(this.triangulation_=new rc(e,i,m,_,T*E,p),this.triangulation_.getTriangles().length===0){this.state=H.EMPTY;return}this.sourceZ_=t.getZForResolution(T);let x=this.triangulation_.calculateSourceExtent();if(_&&(e.canWrapX()?(x[1]=Je(x[1],_[1],_[3]),x[3]=Je(x[3],_[1],_[3])):x=Ht(x,_)),!dr(x))this.state=H.EMPTY;else{const v=t.getTileRangeForExtentAndZ(x,this.sourceZ_);for(let C=v.minX;C<=v.maxX;C++)for(let R=v.minY;R<=v.maxY;R++){const S=h(this.sourceZ_,C,R,a);S&&this.sourceTiles_.push(S)}this.sourceTiles_.length===0&&(this.state=H.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{t&&t.getState()==H.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}),this.sourceTiles_.length=0,e.length===0)this.state=H.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),n=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=oc(n,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=H.LOADED}this.changed()}load(){if(this.state==H.IDLE){this.state=H.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const i=t.getState();if(i==H.IDLE||i==H.LOADING){e++;const n=ze(t,de.CHANGE,function(s){const o=t.getState();(o==H.LOADED||o==H.ERROR||o==H.EMPTY)&&(He(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(n)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,i,n){t.getState()==H.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(He),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Fn(this.canvas_.getContext("2d")),Ei.push(this.canvas_),this.canvas_=null),super.release()}}function hs(r,e,t,i){return i!==void 0?(i[0]=r,i[1]=e,i[2]=t,i):[r,e,t]}function Nn(r,e,t){return r+"/"+e+"/"+t}function ki(r){return Nn(r[0],r[1],r[2])}function Pu(r){return r.split("/").map(Number)}function Ou(r){return(r[1]<<r[0])+r[2]}function ku(r,e){const t=r[0],i=r[1],n=r[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,n):!0}class Yo extends Bh{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(e){for(;this.canExpireCache()&&!(this.peekLast().getKey()in e);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const e=this.peekFirstKey(),i=Pu(e)[0];this.forEach(n=>{n.tileCoord[0]!==i&&(this.remove(ki(n.tileCoord)),n.release())})}}const Dn={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},fr={PROPERTYCHANGE:"propertychange"};class Dr extends Ar{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(de.CHANGE)}getRevision(){return this.revision_}onInternal(e,t){if(Array.isArray(e)){const i=e.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=ze(this,e[s],t);return n}return ze(this,e,t)}onceInternal(e,t){let i;if(Array.isArray(e)){const n=e.length;i=new Array(n);for(let s=0;s<n;++s)i[s]=ns(this,e[s],t)}else i=ns(this,e,t);return t.ol_key=i,i}unInternal(e,t){const i=t.ol_key;if(i)Fu(i);else if(Array.isArray(e))for(let n=0,s=e.length;n<s;++n)this.removeEventListener(e[n],t);else this.removeEventListener(e,t)}}Dr.prototype.on;Dr.prototype.once;Dr.prototype.un;function Fu(r){if(Array.isArray(r))for(let e=0,t=r.length;e<t;++e)He(r[e]);else He(r)}class rl extends wi{constructor(e,t,i){super(e),this.key=t,this.oldValue=i}}class ci extends Dr{constructor(e){super(),this.on,this.once,this.un,Ne(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let t;return this.values_&&this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,t){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new rl(i,e,t)),i=fr.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new rl(i,e,t))}addChangeListener(e,t){this.addEventListener(`change:${e}`,t)}removeChangeListener(e,t){this.removeEventListener(`change:${e}`,t)}set(e,t,i){const n=this.values_||(this.values_={});if(i)n[e]=t;else{const s=n[e];n[e]=t,s!==t&&this.notify(e,s)}}setProperties(e,t){for(const i in e)this.set(i,e[i],t)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,t){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],Fo(this.values_)&&(this.values_=null),t||this.notify(e,i)}}}class Nu extends ci{constructor(e){super(),this.projection=Ut(e.projection),this.attributions_=sl(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible!==void 0?e.attributionsCollapsible:!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const t=this;this.viewPromise_=new Promise(function(i,n){t.viewResolver=i,t.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=sl(e),this.changed()}setState(e){this.state_=e,this.changed()}}function sl(r){return r?Array.isArray(r)?function(e){return r}:typeof r=="function"?r:function(e){return[r]}:null}class Ko{constructor(e,t,i,n){this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function fn(r,e,t,i,n){return n!==void 0?(n.minX=r,n.maxX=e,n.minY=t,n.maxY=i,n):new Ko(r,e,t,i)}const Gu=42,Ho=256;function Uu(r,e,t,i,n){let s;for(e+=i;e<t;e+=i)if(s=n(r.slice(e-i,e),r.slice(e,e+i)),s)return s;return!1}function zu(r,e,t,i,n){return!Yh(n,function(o){return!tn(r,e,t,i,o[0],o[1])})}function tn(r,e,t,i,n,s){let o=0,a=r[t-i],l=r[t-i+1];for(;e<t;e+=i){const h=r[e],c=r[e+1];l<=s?c>s&&(h-a)*(s-l)-(n-a)*(c-l)>0&&o++:c<=s&&(h-a)*(s-l)-(n-a)*(c-l)<0&&o--,a=h,l=c}return o!==0}function ac(r,e,t,i,n,s){if(t.length===0||!tn(r,e,t[0],i,n,s))return!1;for(let o=1,a=t.length;o<a;++o)if(tn(r,t[o-1],t[o],i,n,s))return!1;return!0}function lc(r,e,t,i,n){const s=Wh(li(),r,e,t,i);return zt(n,s)?er(n,s)||s[0]>=n[0]&&s[2]<=n[2]||s[1]>=n[1]&&s[3]<=n[3]?!0:Uu(r,e,t,i,function(o,a){return j1(n,o,a)}):!1}function hc(r,e,t,i,n){return!!(lc(r,e,t,i,n)||tn(r,e,t,i,n[0],n[1])||tn(r,e,t,i,n[0],n[3])||tn(r,e,t,i,n[2],n[1])||tn(r,e,t,i,n[2],n[3]))}function Bu(r,e,t,i,n){if(!hc(r,e,t[0],i,n))return!1;if(t.length===1)return!0;for(let s=1,o=t.length;s<o;++s)if(zu(r,t[s-1],t[s],i,n)&&!lc(r,t[s-1],t[s],i,n))return!1;return!0}function ol(r){return r[0]>0&&r[1]>0}function Xu(r,e,t){return t===void 0&&(t=[0,0]),t[0]=r[0]*e+.5|0,t[1]=r[1]*e+.5|0,t}function _t(r,e){return Array.isArray(r)?r:(e===void 0?e=[r,r]:(e[0]=r,e[1]=r),e)}const gn=[0,0,0],Ii=5;class Zo{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Xe(H1(this.resolutions_,(n,s)=>s-n),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let n=0,s=this.resolutions_.length-1;n<s;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Xe(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Xn(i)),Xe(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Xe(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Ho,Xe(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((n,s)=>{const o=new Ko(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const n=this.getTileRangeForExtentAndZ(e,t);for(let s=n.minX,o=n.maxX;s<=o;++s)for(let a=n.minY,l=n.maxY;a<=l;++a)i([t,s,a])}forEachTileCoordParentTileRange(e,t,i,n){let s,o,a,l=null,h=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,n);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=fn(o,o,a,a,i)):s=this.getTileRangeForExtentAndZ(l,h,i),t(h,s))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return fn(s,s+1,o,o+1,t)}const n=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const n=e[0],s=e[1],o=e[2];if(t===n)return fn(s,o,s,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,t-n),h=Math.floor(s*l),c=Math.floor(o*l);if(t<n)return fn(h,h,c,c,i);const u=Math.floor(l*(s+1))-1,d=Math.floor(l*(o+1))-1;return fn(h,u,c,d,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,gn);const n=gn[1],s=gn[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,gn);const o=gn[1],a=gn[2];return fn(n,o,s,a,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),n=_t(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*n[0]*i,t[1]-(e[2]+.5)*n[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),n=this.getResolution(e[0]),s=_t(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*s[0]*n,a=i[1]-(e[2]+1)*s[1]*n,l=o+s[0]*n,h=a+s[1]*n;return an(o,a,l,h,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,n,s){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),h=_t(this.getTileSize(o),this.tmpSize_);let c=a*(e-l[0])/i/h[0],u=a*(l[1]-t)/i/h[1];return n?(c=Br(c,Ii)-1,u=Br(u,Ii)-1):(c=zr(c,Ii),u=zr(u,Ii)),hs(o,c,u,s)}getTileCoordForXYAndZ_(e,t,i,n,s){const o=this.getOrigin(i),a=this.getResolution(i),l=_t(this.getTileSize(i),this.tmpSize_);let h=(e-o[0])/a/l[0],c=(o[1]-t)/a/l[1];return n?(h=Br(h,Ii)-1,c=Br(c,Ii)-1):(h=zr(h,Ii),c=zr(c,Ii)),hs(i,h,c,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=ko(this.resolutions_,e,t||0);return Je(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return hc(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let n=this.minZoom;n<t;++n)i[n]=this.getTileRangeForExtentAndZ(e,n);this.fullTileRanges_=i}}function qo(r){let e=r.getDefaultTileGrid();return e||(e=Wu(r),r.setDefaultTileGrid(e)),e}function Vu(r,e,t){const i=e[0],n=r.getTileCoordCenter(e),s=Ss(t);if(!on(s,n)){const o=Ye(s),a=Math.ceil((s[0]-n[0])/o);return n[0]+=o*a,r.getTileCoordForCoordAndZ(n,i)}return e}function ju(r,e,t,i){i=i!==void 0?i:"top-left";const n=uc(r,e,t);return new Zo({extent:r,origin:B1(r,i),resolutions:n,tileSize:t})}function cc(r){const e=r||{},t=e.extent||Ut("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:uc(t,e.maxZoom,e.tileSize,e.maxResolution)};return new Zo(i)}function uc(r,e,t,i){e=e!==void 0?e:Gu,t=_t(t!==void 0?t:Ho);const n=Bt(r),s=Ye(r);i=i>0?i:Math.max(s/t[0],n/t[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function Wu(r,e,t,i){const n=Ss(r);return ju(n,e,t,i)}function Ss(r){r=Ut(r);let e=r.getExtent();if(!e){const t=180*Uo.degrees/r.getMetersPerUnit();e=an(-t,-t,t,t)}return e}class dc extends Nu{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.opaque_=e.opaque!==void 0?e.opaque:!1,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&_t(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tileCache=new Yo(e.cacheSize||0),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(e,t){const i=this.getTileCacheForProjection(e);i&&i.expireCache(t)}forEachLoadedTile(e,t,i,n){const s=this.getTileCacheForProjection(e);if(!s)return!1;let o=!0,a,l,h;for(let c=i.minX;c<=i.maxX;++c)for(let u=i.minY;u<=i.maxY;++u)l=Nn(t,c,u),h=!1,s.containsKey(l)&&(a=s.get(l),h=a.getState()===H.LOADED,h&&(h=n(a)!==!1)),h||(o=!1);return o}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getOpaque(e){return this.opaque_}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,n,s){return Oe()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:qo(e)}getTileCacheForProjection(e){const t=this.getProjection();return Xe(t===null||ii(t,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const n=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),o=_t(n.getTileSize(e),this.tmpSize);return s==1?o:Xu(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const i=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=Vu(i,e,t)),ku(e,i)?e:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(e,t){const i=this.getTileCacheForProjection(t);e>i.highWaterMark&&(i.highWaterMark=e)}useTile(e,t,i,n){}}class fc extends wi{constructor(e,t){super(e),this.tile=t}}function Yu(r,e){const t=/\{z\}/g,i=/\{x\}/g,n=/\{y\}/g,s=/\{-y\}/g;return function(o,a,l){if(o)return r.replace(t,o[0].toString()).replace(i,o[1].toString()).replace(n,o[2].toString()).replace(s,function(){const h=o[0],c=e.getFullTileRange(h);if(!c)throw new Error("The {-y} placeholder requires a tile grid with extent");return(c.getHeight()-o[2]-1).toString()})}}function Ku(r,e){const t=r.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=Yu(r[n],e);return Hu(i)}function Hu(r){return r.length===1?r[0]:function(e,t,i){if(!e)return;const n=Ou(e),s=Ln(n,r.length);return r[s](e,t,i)}}function Zu(r){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(r);if(t){const i=t[1].charCodeAt(0),n=t[2].charCodeAt(0);let s;for(s=i;s<=n;++s)e.push(r.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(r),t){const i=parseInt(t[2],10);for(let n=parseInt(t[1],10);n<=i;n++)e.push(r.replace(t[0],n.toString()));return e}return e.push(r),e}class $o extends dc{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===$o.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=Ne(t),n=t.getState();let s;n==H.LOADING?(this.tileLoadingKeys_[i]=!0,s=Dn.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=n==H.ERROR?Dn.TILELOADERROR:n==H.LOADED?Dn.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new fc(s,t))}setTileLoadFunction(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=Zu(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Ku(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}useTile(e,t,i){const n=Nn(e,t,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}class qu extends $o{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:$u,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Go,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const n in this.tileCacheForProjection){const s=this.tileCacheForProjection[n];s.expireCache(s==i?t:{})}}getGutterForProjection(e){return this.getProjection()&&e&&!ii(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getOpaque(e){return this.getProjection()&&e&&!ii(this.getProjection(),e)?!1:super.getOpaque(e)}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||ii(t,e)))return this.tileGrid;const i=Ne(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=qo(e)),this.tileGridForProjection[i]}getTileCacheForProjection(e){const t=this.getProjection();if(!t||ii(t,e))return this.tileCache;const i=Ne(e);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Yo(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(e,t,i,n,s,o){const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,s),h=l?this.tileUrlFunction(l,n,s):void 0,c=new this.tileClass(a,h!==void 0?H.IDLE:H.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(de.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,t,i,n,s){const o=this.getProjection();if(!o||!s||ii(o,s))return this.getTileInternal(e,t,i,n,o||s);const a=this.getTileCacheForProjection(s),l=[e,t,i];let h;const c=ki(l);a.containsKey(c)&&(h=a.get(c));const u=this.getKey();if(h&&h.key==u)return h;const d=this.getTileGridForProjection(o),f=this.getTileGridForProjection(s),g=this.getTileCoordForTileUrlFunction(l,s),_=new Is(o,d,s,f,l,g,this.getTilePixelRatio(n),this.getGutter(),(m,y,p,T)=>this.getTileInternal(m,y,p,T,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return _.key=u,h?(_.interimTile=h,_.refreshInterimChain(),a.replace(c,_)):a.set(c,_),_}getTileInternal(e,t,i,n,s){let o=null;const a=Nn(e,t,i),l=this.getKey();if(!this.tileCache.containsKey(a))o=this.createTile_(e,t,i,n,s,l),this.tileCache.set(a,o);else if(o=this.tileCache.get(a),o.key!=l){const h=o;o=this.createTile_(e,t,i,n,s,l),h.getState()==H.IDLE?o.interimTile=h.interimTile:o.interimTile=h,o.refreshInterimChain(),this.tileCache.replace(a,o)}return o}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(e,t){const i=Ut(e);if(i){const n=Ne(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=t)}}clear(){super.clear();for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}function $u(r,e){r.getImage().src=e}class Ju extends qu{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:cc({extent:Ss(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}class cs extends ci{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const t=e;this.setGeometry(t)}else{const t=e;this.setProperties(t)}}clone(){const e=new cs(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const t=this.getGeometry();t&&e.setGeometry(t.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(He(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=ze(e,de.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?Qu(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Qu(r){if(typeof r=="function")return r;let e;return Array.isArray(r)?e=r:(Xe(typeof r.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[r]),function(){return e}}const Jo=new Array(6);function Gt(){return[1,0,0,1,0,0]}function ed(r){return As(r,1,0,0,1,0,0)}function Qo(r,e){const t=r[0],i=r[1],n=r[2],s=r[3],o=r[4],a=r[5],l=e[0],h=e[1],c=e[2],u=e[3],d=e[4],f=e[5];return r[0]=t*l+n*h,r[1]=i*l+s*h,r[2]=t*c+n*u,r[3]=i*c+s*u,r[4]=t*d+n*f+o,r[5]=i*d+s*f+a,r}function As(r,e,t,i,n,s,o){return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r[4]=s,r[5]=o,r}function td(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r}function yt(r,e){const t=e[0],i=e[1];return e[0]=r[0]*t+r[2]*i+r[4],e[1]=r[1]*t+r[3]*i+r[5],e}function id(r,e){const t=Math.cos(e),i=Math.sin(e);return Qo(r,As(Jo,t,i,-i,t,0,0))}function al(r,e,t){return Qo(r,As(Jo,e,0,0,t,0,0))}function nd(r,e,t){return Qo(r,As(Jo,1,0,0,1,e,t))}function Ci(r,e,t,i,n,s,o,a){const l=Math.sin(s),h=Math.cos(s);return r[0]=i*h,r[1]=n*l,r[2]=-i*l,r[3]=n*h,r[4]=o*i*h-a*i*l+e,r[5]=o*n*l+a*n*h+t,r}function gc(r,e){const t=rd(e);Xe(t!==0,"Transformation matrix cannot be inverted");const i=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return r[0]=o/t,r[1]=-n/t,r[2]=-s/t,r[3]=i/t,r[4]=(s*l-o*a)/t,r[5]=-(i*l-n*a)/t,r}function rd(r){return r[0]*r[3]-r[1]*r[2]}const ll=[1e6,1e6,1e6,1e6,2,2];function sd(r){return"matrix("+r.map((t,i)=>Math.round(t*ll[i])/ll[i]).join(", ")+")"}function sn(r,e,t,i,n,s){s=s||[];let o=0;for(let a=e;a<t;a+=i){const l=r[a],h=r[a+1];s[o++]=n[0]*l+n[2]*h+n[4],s[o++]=n[1]*l+n[3]*h+n[5]}return s&&s.length!=o&&(s.length=o),s}function _c(r,e,t,i,n,s,o){o=o||[];const a=Math.cos(n),l=Math.sin(n),h=s[0],c=s[1];let u=0;for(let d=e;d<t;d+=i){const f=r[d]-h,g=r[d+1]-c;o[u++]=h+f*a-g*l,o[u++]=c+f*l+g*a;for(let _=d+2;_<d+i;++_)o[u++]=r[_]}return o&&o.length!=u&&(o.length=u),o}function od(r,e,t,i,n,s,o,a){a=a||[];const l=o[0],h=o[1];let c=0;for(let u=e;u<t;u+=i){const d=r[u]-l,f=r[u+1]-h;a[c++]=l+n*d,a[c++]=h+s*f;for(let g=u+2;g<u+i;++g)a[c++]=r[g]}return a&&a.length!=c&&(a.length=c),a}function ad(r,e,t,i,n,s,o){o=o||[];let a=0;for(let l=e;l<t;l+=i){o[a++]=r[l]+n,o[a++]=r[l+1]+s;for(let h=l+2;h<l+i;++h)o[a++]=r[h]}return o&&o.length!=a&&(o.length=a),o}const hl=Gt();class ld extends ci{constructor(){super(),this.extent_=li(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Z1((e,t,i)=>{if(!i)return this.getSimplifiedGeometry(t);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(t)})}simplifyTransformed(e,t){return this.simplifyTransformedInternal(this.getRevision(),e,t)}clone(){return Oe()}closestPointXY(e,t,i,n){return Oe()}containsXY(e,t){const i=this.getClosestPoint([e,t]);return i[0]===e&&i[1]===t}getClosestPoint(e,t){return t=t||[NaN,NaN],this.closestPointXY(e[0],e[1],t,1/0),t}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Oe()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&vs(t),this.extentRevision_=this.getRevision()}return V1(this.extent_,e)}rotate(e,t){Oe()}scale(e,t,i){Oe()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Oe()}getType(){return Oe()}applyTransform(e){Oe()}intersectsExtent(e){return Oe()}translate(e,t){Oe()}transform(e,t){const i=Ut(e),n=i.getUnits()=="tile-pixels"?function(s,o,a){const l=i.getExtent(),h=i.getWorldExtent(),c=Bt(h)/Bt(l);return Ci(hl,h[0],h[3],c,-c,0,0,0),sn(s,0,s.length,a,hl,o),as(i,t)(s,o,a)}:as(i,t);return this.applyTransform(n),this}}class ea extends ld{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return G1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Oe()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const t=this.getSimplifiedGeometryInternal(e);return t.getFlatCoordinates().length<this.flatCoordinates.length?t:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,t){this.stride=cl(e),this.layout=e,this.flatCoordinates=t}setCoordinates(e,t){Oe()}setLayout(e,t,i){let n;if(e)n=cl(e);else{for(let s=0;s<i;++s){if(t.length===0){this.layout="XY",this.stride=2;return}t=t[0]}n=t.length,e=hd(n)}this.layout=e,this.stride=n}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(e,t){const i=this.getFlatCoordinates();if(i){const n=this.getStride();_c(i,0,i.length,n,e,t,i),this.changed()}}scale(e,t,i){t===void 0&&(t=e),i||(i=ln(this.getExtent()));const n=this.getFlatCoordinates();if(n){const s=this.getStride();od(n,0,n.length,s,e,t,i,n),this.changed()}}translate(e,t){const i=this.getFlatCoordinates();if(i){const n=this.getStride();ad(i,0,i.length,n,e,t,i),this.changed()}}}function hd(r){let e;return r==2?e="XY":r==3?e="XYZ":r==4&&(e="XYZM"),e}function cl(r){let e;return r=="XY"?e=2:r=="XYZ"||r=="XYM"?e=3:r=="XYZM"&&(e=4),e}function cd(r,e,t){const i=r.getFlatCoordinates();if(!i)return null;const n=r.getStride();return sn(i,0,i.length,n,e,t)}function ud(r,e,t,i){for(let n=0,s=t.length;n<s;++n)r[e++]=t[n];return e}function mc(r,e,t,i){for(let n=0,s=t.length;n<s;++n){const o=t[n];for(let a=0;a<i;++a)r[e++]=o[a]}return e}function dd(r,e,t,i,n){n=n||[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=mc(r,e,t[o],i);n[s++]=l,e=l}return n.length=s,n}class ta extends ea{constructor(e,t){super(),this.setCoordinates(e,t)}clone(){const e=new ta(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,t,i,n){const s=this.flatCoordinates,o=An(e,t,s[0],s[1]);if(o<n){const a=this.stride;for(let l=0;l<a;++l)i[l]=s[l];return i.length=a,o}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return N1(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return jh(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,t){this.setLayout(t,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ud(this.flatCoordinates,0,e,this.stride),this.changed()}}const wt={ADD:"add",REMOVE:"remove"},ul={LENGTH:"length"};class Xr extends wi{constructor(e,t,i){super(e),this.element=t,this.index=i}}class si extends ci{constructor(e,t){if(super(),this.on,this.once,this.un,t=t||{},this.unique_=!!t.unique,this.array_=e||[],this.unique_)for(let i=0,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let t=0,i=e.length;t<i;++t)this.push(e[t]);return this}forEach(e){const t=this.array_;for(let i=0,n=t.length;i<n;++i)e(t[i],i,t)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(ul.LENGTH)}insertAt(e,t){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t),this.array_.splice(e,0,t),this.updateLength_(),this.dispatchEvent(new Xr(wt.ADD,t,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const t=this.getLength();return this.insertAt(t,e),this.getLength()}remove(e){const t=this.array_;for(let i=0,n=t.length;i<n;++i)if(t[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const t=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new Xr(wt.REMOVE,t,e)),t}setAt(e,t){const i=this.getLength();if(e>=i){this.insertAt(e,t);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(t,e);const n=this.array_[e];this.array_[e]=t,this.dispatchEvent(new Xr(wt.REMOVE,n,e)),this.dispatchEvent(new Xr(wt.ADD,t,e))}updateLength_(){this.set(ul.LENGTH,this.array_.length)}assertUnique_(e,t){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===e&&i!==t)throw new Error("Duplicate item added to a unique collection")}}function fd(r,e,t,i,n){pc(r,e,t||0,i||r.length-1,n||gd)}function pc(r,e,t,i,n){for(;i>t;){if(i-t>600){var s=i-t+1,o=e-t+1,a=Math.log(s),l=.5*Math.exp(2*a/3),h=.5*Math.sqrt(a*l*(s-l)/s)*(o-s/2<0?-1:1),c=Math.max(t,Math.floor(e-o*l/s+h)),u=Math.min(i,Math.floor(e+(s-o)*l/s+h));pc(r,e,c,u,n)}var d=r[e],f=t,g=i;for(qn(r,t,e),n(r[i],d)>0&&qn(r,t,i);f<g;){for(qn(r,f,g),f++,g--;n(r[f],d)<0;)f++;for(;n(r[g],d)>0;)g--}n(r[t],d)===0?qn(r,t,g):(g++,qn(r,g,i)),g<=e&&(t=g+1),e<=g&&(i=g-1)}}function qn(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}function gd(r,e){return r<e?-1:r>e?1:0}class _d{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let t=this.data;const i=[];if(!jr(e,t))return i;const n=this.toBBox,s=[];for(;t;){for(let o=0;o<t.children.length;o++){const a=t.children[o],l=t.leaf?n(a):a;jr(e,l)&&(t.leaf?i.push(a):Vs(e,l)?this._all(a,i):s.push(a))}t=s.pop()}return i}collides(e){let t=this.data;if(!jr(e,t))return!1;const i=[];for(;t;){for(let n=0;n<t.children.length;n++){const s=t.children[n],o=t.leaf?this.toBBox(s):s;if(jr(e,o)){if(t.leaf||Vs(e,o))return!0;i.push(s)}}t=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=t;else if(this.data.height===t.height)this._splitRoot(this.data,t);else{if(this.data.height<t.height){const i=this.data;this.data=t,t=i}this._insert(t,this.data.height-t.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Tn([]),this}remove(e,t){if(!e)return this;let i=this.data;const n=this.toBBox(e),s=[],o=[];let a,l,h;for(;i||s.length;){if(i||(i=s.pop(),l=s[s.length-1],a=o.pop(),h=!0),i.leaf){const c=md(e,i.children,t);if(c!==-1)return i.children.splice(c,1),s.push(i),this._condense(s),this}!h&&!i.leaf&&Vs(i,n)?(s.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],h=!1):i=null}return this}toBBox(e){return e}compareMinX(e,t){return e.minX-t.minX}compareMinY(e,t){return e.minY-t.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,t){const i=[];for(;e;)e.leaf?t.push(...e.children):i.push(...e.children),e=i.pop();return t}_build(e,t,i,n){const s=i-t+1;let o=this._maxEntries,a;if(s<=o)return a=Tn(e.slice(t,i+1)),_n(a,this.toBBox),a;n||(n=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,n-1))),a=Tn([]),a.leaf=!1,a.height=n;const l=Math.ceil(s/o),h=l*Math.ceil(Math.sqrt(o));dl(e,t,i,h,this.compareMinX);for(let c=t;c<=i;c+=h){const u=Math.min(c+h-1,i);dl(e,c,u,l,this.compareMinY);for(let d=c;d<=u;d+=l){const f=Math.min(d+l-1,u);a.children.push(this._build(e,d,f,n-1))}}return _n(a,this.toBBox),a}_chooseSubtree(e,t,i,n){for(;n.push(t),!(t.leaf||n.length-1===i);){let s=1/0,o=1/0,a;for(let l=0;l<t.children.length;l++){const h=t.children[l],c=Xs(h),u=Ed(e,h)-c;u<o?(o=u,s=c<s?c:s,a=h):u===o&&c<s&&(s=c,a=h)}t=a||t.children[0]}return t}_insert(e,t,i){const n=i?e:this.toBBox(e),s=[],o=this._chooseSubtree(n,this.data,t,s);for(o.children.push(e),ir(o,n);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(n,s,t)}_split(e,t){const i=e[t],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);const o=this._chooseSplitIndex(i,s,n),a=Tn(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,_n(i,this.toBBox),_n(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,t){this.data=Tn([e,t]),this.data.height=e.height+1,this.data.leaf=!1,_n(this.data,this.toBBox)}_chooseSplitIndex(e,t,i){let n,s=1/0,o=1/0;for(let a=t;a<=i-t;a++){const l=tr(e,0,a,this.toBBox),h=tr(e,a,i,this.toBBox),c=Td(l,h),u=Xs(l)+Xs(h);c<s?(s=c,n=a,o=u<o?u:o):c===s&&u<o&&(o=u,n=a)}return n||i-t}_chooseSplitAxis(e,t,i){const n=e.leaf?this.compareMinX:pd,s=e.leaf?this.compareMinY:yd,o=this._allDistMargin(e,t,i,n),a=this._allDistMargin(e,t,i,s);o<a&&e.children.sort(n)}_allDistMargin(e,t,i,n){e.children.sort(n);const s=this.toBBox,o=tr(e,0,t,s),a=tr(e,i-t,i,s);let l=Vr(o)+Vr(a);for(let h=t;h<i-t;h++){const c=e.children[h];ir(o,e.leaf?s(c):c),l+=Vr(o)}for(let h=i-t-1;h>=t;h--){const c=e.children[h];ir(a,e.leaf?s(c):c),l+=Vr(a)}return l}_adjustParentBBoxes(e,t,i){for(let n=i;n>=0;n--)ir(t[n],e)}_condense(e){for(let t=e.length-1,i;t>=0;t--)e[t].children.length===0?t>0?(i=e[t-1].children,i.splice(i.indexOf(e[t]),1)):this.clear():_n(e[t],this.toBBox)}}function md(r,e,t){if(!t)return e.indexOf(r);for(let i=0;i<e.length;i++)if(t(r,e[i]))return i;return-1}function _n(r,e){tr(r,0,r.children.length,e,r)}function tr(r,e,t,i,n){n||(n=Tn(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let s=e;s<t;s++){const o=r.children[s];ir(n,r.leaf?i(o):o)}return n}function ir(r,e){return r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY),r}function pd(r,e){return r.minX-e.minX}function yd(r,e){return r.minY-e.minY}function Xs(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function Vr(r){return r.maxX-r.minX+(r.maxY-r.minY)}function Ed(r,e){return(Math.max(e.maxX,r.maxX)-Math.min(e.minX,r.minX))*(Math.max(e.maxY,r.maxY)-Math.min(e.minY,r.minY))}function Td(r,e){const t=Math.max(r.minX,e.minX),i=Math.max(r.minY,e.minY),n=Math.min(r.maxX,e.maxX),s=Math.min(r.maxY,e.maxY);return Math.max(0,n-t)*Math.max(0,s-i)}function Vs(r,e){return r.minX<=e.minX&&r.minY<=e.minY&&e.maxX<=r.maxX&&e.maxY<=r.maxY}function jr(r,e){return e.minX<=r.maxX&&e.minY<=r.maxY&&e.maxX>=r.minX&&e.maxY>=r.minY}function Tn(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function dl(r,e,t,i,n){const s=[e,t];for(;s.length;){if(t=s.pop(),e=s.pop(),t-e<=i)continue;const o=e+Math.ceil((t-e)/i/2)*i;fd(r,o,e,t,n),s.push(e,o,o,t)}}function fl(r,e,t,i,n,s,o){const a=r[e],l=r[e+1],h=r[t]-a,c=r[t+1]-l;let u;if(h===0&&c===0)u=e;else{const d=((n-a)*h+(s-l)*c)/(h*h+c*c);if(d>1)u=t;else if(d>0){for(let f=0;f<i;++f)o[f]=Kt(r[e+f],r[t+f],d);o.length=i;return}else u=e}for(let d=0;d<i;++d)o[d]=r[u+d];o.length=i}function yc(r,e,t,i,n){let s=r[e],o=r[e+1];for(e+=i;e<t;e+=i){const a=r[e],l=r[e+1],h=An(s,o,a,l);h>n&&(n=h),s=a,o=l}return n}function xd(r,e,t,i,n){for(let s=0,o=t.length;s<o;++s){const a=t[s];n=yc(r,e,a,i,n),e=a}return n}function Ec(r,e,t,i,n,s,o,a,l,h,c){if(e==t)return h;let u,d;if(n===0){if(d=An(o,a,r[e],r[e+1]),d<h){for(u=0;u<i;++u)l[u]=r[e+u];return l.length=i,d}return h}c=c||[NaN,NaN];let f=e+i;for(;f<t;)if(fl(r,f-i,f,i,o,a,c),d=An(o,a,c[0],c[1]),d<h){for(h=d,u=0;u<i;++u)l[u]=c[u];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/n|0,1);if(fl(r,t-i,e,i,o,a,c),d=An(o,a,c[0],c[1]),d<h){for(h=d,u=0;u<i;++u)l[u]=c[u];l.length=i}return h}function vd(r,e,t,i,n,s,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,d=t.length;u<d;++u){const f=t[u];h=Ec(r,e,f,i,n,s,o,a,l,h,c),e=f}return h}function wd(r,e,t,i,n,s,o){const a=(t-e)/i;if(a<3){for(;e<t;e+=i)s[o++]=r[e],s[o++]=r[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[e,t-i];let c=0;for(;h.length>0;){const u=h.pop(),d=h.pop();let f=0;const g=r[d],_=r[d+1],m=r[u],y=r[u+1];for(let p=d+i;p<u;p+=i){const T=r[p],E=r[p+1],x=Eu(T,E,g,_,m,y);x>f&&(c=p,f=x)}f>n&&(l[(c-e)/i]=1,d+i<c&&h.push(d,c),c+i<u&&h.push(c,u))}for(let u=0;u<a;++u)l[u]&&(s[o++]=r[e+u*i],s[o++]=r[e+u*i+1]);return o}function Ji(r,e){return e*Math.round(r/e)}function Cd(r,e,t,i,n,s,o){if(e==t)return o;let a=Ji(r[e],n),l=Ji(r[e+1],n);e+=i,s[o++]=a,s[o++]=l;let h,c;do if(h=Ji(r[e],n),c=Ji(r[e+1],n),e+=i,e==t)return s[o++]=h,s[o++]=c,o;while(h==a&&c==l);for(;e<t;){const u=Ji(r[e],n),d=Ji(r[e+1],n);if(e+=i,u==h&&d==c)continue;const f=h-a,g=c-l,_=u-a,m=d-l;if(f*m==g*_&&(f<0&&_<f||f==_||f>0&&_>f)&&(g<0&&m<g||g==m||g>0&&m>g)){h=u,c=d;continue}s[o++]=h,s[o++]=c,a=h,l=c,h=u,c=d}return s[o++]=h,s[o++]=c,o}function Rd(r,e,t,i,n,s,o,a){for(let l=0,h=t.length;l<h;++l){const c=t[l];o=Cd(r,e,c,i,n,s,o),a.push(o),e=c}return o}function bn(r,e,t,i,n){n=n!==void 0?n:[];let s=0;for(let o=e;o<t;o+=i)n[s++]=r.slice(o,o+i);return n.length=s,n}function us(r,e,t,i,n){n=n!==void 0?n:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];n[s++]=bn(r,e,l,i,n[s]),e=l}return n.length=s,n}function gl(r,e,t,i,n){n=n!==void 0?n:[];let s=0;for(let o=0,a=t.length;o<a;++o){const l=t[o];n[s++]=l.length===1&&l[0]===e?[]:us(r,e,l,i,n[s]),e=l[l.length-1]}return n.length=s,n}function Tc(r,e,t,i){let n=0,s=r[t-i],o=r[t-i+1];for(;e<t;e+=i){const a=r[e],l=r[e+1];n+=o*a-s*l,s=a,o=l}return n/2}function bd(r,e,t,i){let n=0;for(let s=0,o=t.length;s<o;++s){const a=t[s];n+=Tc(r,e,a,i),e=a}return n}class gr extends ea{constructor(e,t){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,t!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(t,e):this.setCoordinates(e,t)}clone(){return new gr(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,t,i,n){return n<Vh(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ec(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,t,i,n))}getArea(){return Tc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return bn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const t=[];return t.length=wd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,t,0),new gr(t,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,t){this.setLayout(t,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=mc(this.flatCoordinates,0,e,this.stride),this.changed()}}function Id(r,e,t,i){let n=r[e],s=r[e+1],o=0;for(let a=e+i;a<t;a+=i){const l=r[a],h=r[a+1];o+=Math.sqrt((l-n)*(l-n)+(h-s)*(h-s)),n=l,s=h}return o}function Sd(r,e,t,i,n,s,o){let a,l,h,c,u,d,f;const g=n[s+1],_=[];for(let p=0,T=t.length;p<T;++p){const E=t[p];for(c=r[E-i],d=r[E-i+1],a=e;a<E;a+=i)u=r[a],f=r[a+1],(g<=d&&f<=g||d<=g&&g<=f)&&(h=(g-d)/(f-d)*(u-c)+c,_.push(h)),c=u,d=f}let m=NaN,y=-1/0;for(_.sort(In),c=_[0],a=1,l=_.length;a<l;++a){u=_[a];const p=Math.abs(u-c);p>y&&(h=(c+u)/2,ac(r,e,t,i,h,g)&&(m=h,y=p)),c=u}return isNaN(m)&&(m=n[s]),[m,g,y]}function Ad(r,e,t,i){for(;e<t-i;){for(let n=0;n<i;++n){const s=r[e+n];r[e+n]=r[t-i+n],r[t-i+n]=s}e+=i,t-=i}}function xc(r,e,t,i){let n=0,s=r[t-i],o=r[t-i+1];for(;e<t;e+=i){const a=r[e],l=r[e+1];n+=(a-s)*(l+o),s=a,o=l}return n===0?void 0:n>0}function Ld(r,e,t,i,n){n=n!==void 0?n:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=xc(r,e,a,i);if(s===0){if(n&&l||!n&&!l)return!1}else if(n&&!l||!n&&l)return!1;e=a}return!0}function _l(r,e,t,i,n){n=n!==void 0?n:!1;for(let s=0,o=t.length;s<o;++s){const a=t[s],l=xc(r,e,a,i);(s===0?n&&l||!n&&!l:n&&!l||!n&&l)&&Ad(r,e,a,i),e=a}return e}class _r extends ea{constructor(e,t,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,t!==void 0&&i?(this.setFlatCoordinates(t,e),this.ends_=i):this.setCoordinates(e,t)}appendLinearRing(e){this.flatCoordinates?mo(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new _r(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,t,i,n){return n<Vh(this.getExtent(),e,t)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xd(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),vd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,t,i,n))}containsXY(e,t){return ac(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,t)}getArea(){return bd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let t;return e!==void 0?(t=this.getOrientedFlatCoordinates().slice(),_l(t,0,this.ends_,this.stride,e)):t=this.flatCoordinates,us(t,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=ln(this.getExtent());this.flatInteriorPoint_=Sd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ta(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new gr(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,t=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],h=new gr(t.slice(s,l),e);n.push(h),s=l}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Ld(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=_l(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const t=[],i=[];return t.length=Rd(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),t,0,i),new _r(t,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return Bu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,t){this.setLayout(t,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=dd(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function ml(r){if(Ir(r))throw new Error("Cannot create polygon from empty extent");const e=r[0],t=r[1],i=r[2],n=r[3],s=[e,t,e,n,i,n,i,t,e,t];return new _r(s,"XY",[s.length])}function ds(r){return r instanceof Image||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageBitmap?r:null}function xo(r){return r instanceof Uint8Array||r instanceof Uint8ClampedArray||r instanceof Float32Array||r instanceof DataView?r:null}let mn=null;function Dd(r){mn||(mn=ht(r.width,r.height,void 0,{willReadFrequently:!0}));const e=mn.canvas,t=r.width;e.width!==t&&(e.width=t);const i=r.height;return e.height!==i&&(e.height=i),mn.clearRect(0,0,t,i),mn.drawImage(r,0,0),mn.getImageData(0,0,t,i).data}const Md=[256,256];class ia extends No{constructor(e){const t=H.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null}getSize(){if(this.size_)return this.size_;const e=ds(this.data_);return e?[e.width,e.height]:Md}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==H.IDLE&&this.state!==H.ERROR)return;this.state=H.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=H.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=H.ERROR,e.changed()})}}class na extends ia{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8Array(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const t=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),i=this.targetTileGrid_.getExtent();let n=this.sourceTileGrid_.getExtent();const s=i?Ht(t,i):t;if(dr(s)===0){this.state=H.EMPTY;return}const o=e.sourceProj,a=o.getExtent();a&&(n?n=Ht(n,a):n=a);const l=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),h=e.targetProj,c=sc(o,h,s,l);if(!isFinite(c)||c<=0){this.state=H.EMPTY;return}const u=e.errorThreshold!==void 0?e.errorThreshold:ec;if(this.triangulation_=new rc(o,h,s,n,c*u,l),this.triangulation_.getTriangles().length===0){this.state=H.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(c);let d=this.triangulation_.calculateSourceExtent();if(n&&(o.canWrapX()?(d[1]=Je(d[1],n[1],n[3]),d[3]=Je(d[3],n[1],n[3])):d=Ht(d,n)),!dr(d))this.state=H.EMPTY;else{const f=this.sourceTileGrid_.getTileRangeForExtentAndZ(d,this.sourceZ_),g=e.getTileFunction;for(let _=f.minX;_<=f.maxX;_++)for(let m=f.minY;m<=f.maxY;m++){const y=g(this.sourceZ_,_,m,this.pixelRatio_);y&&this.sourceTiles_.push(y)}this.sourceTiles_.length===0&&(this.state=H.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{if(!t||t.getState()!==H.LOADED)return;const i=t.getSize(),n=this.gutter_;let s;const o=xo(t.getData());o?s=o:s=Dd(ds(t.getData()));const a=[i[0]+2*n,i[1]+2*n],l=s instanceof Float32Array,h=a[0]*a[1],c=l?Float32Array:Uint8Array,u=new c(s.buffer),d=c.BYTES_PER_ELEMENT,f=d*u.length/h,g=u.byteLength/a[1],_=Math.floor(g/d/a[0]),m=h*_;let y=u;if(u.length!==m){y=new c(m);let p=0,T=0;const E=a[0]*_;for(let x=0;x<a[1];++x){for(let v=0;v<E;++v)y[p++]=u[T+v];T+=g/d}}e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),data:new Uint8Array(y.buffer),dataType:c,bytesPerPixel:f,pixelSize:a})}),this.sourceTiles_.length=0,e.length===0)this.state=H.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),n=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let h,c;const u=e[0].bytesPerPixel,d=Math.ceil(u/3);for(let f=d-1;f>=0;--f){const g=[];for(let E=0,x=e.length;E<x;++E){const v=e[E],C=v.data,R=v.pixelSize,S=R[0],P=R[1],O=ht(S,P,Ei),N=O.createImageData(S,P),V=N.data;let U=f*3;for(let L=0,k=V.length;L<k;L+=4)V[L]=C[U],V[L+1]=C[U+1],V[L+2]=C[U+2],V[L+3]=255,U+=u;O.putImageData(N,0,0),g.push({extent:v.extent,image:O.canvas})}const _=oc(n,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,g,this.gutter_,!1,!1,!1,!0);for(let E=0,x=g.length;E<x;++E){const C=g[E].image.getContext("2d");Fn(C),Ei.push(C.canvas)}const m=_.getContext("2d"),y=m.getImageData(0,0,_.width,_.height);Fn(m),Ei.push(_),h||(c=new Uint8Array(u*y.width*y.height),h=new e[0].dataType(c.buffer));const p=y.data;let T=f*3;for(let E=0,x=p.length;E<x;E+=4)p[E+3]===255?(c[T]=p[E],c[T+1]=p[E+1],c[T+2]=p[E+2]):(c[T]=0,c[T+1]=0,c[T+2]=0),T+=u}this.reprojData_=h,this.reprojSize_=[Math.round(n*this.pixelRatio_),Math.round(s*this.pixelRatio_)],this.state=H.LOADED}this.changed()}load(){if(this.state!==H.IDLE&&this.state!==H.ERROR)return;this.state=H.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const i=t.getState();if(i!==H.IDLE&&i!==H.LOADING)return;e++;const n=ze(t,de.CHANGE,function(){const s=t.getState();(s==H.LOADED||s==H.ERROR||s==H.EMPTY)&&(He(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(n)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t){t.getState()==H.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(He),this.sourcesListenerKeys_=null}}class Pd extends dc{constructor(e){const t=e.projection===void 0?"EPSG:3857":e.projection;let i=e.tileGrid;i===void 0&&t&&(i=cc({extent:Ss(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:i,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?_t(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.tileCacheForProjection_={}}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const t=this.getTileGrid();return t?_t(t.getTileSize(e)):[256,256]}getGutterForProjection(e){const t=this.getProjection();return!t||ii(t,e)?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,t,i,n,s){const o=this.getTileCacheForProjection(n),a=Nn(e,t,i);if(o.containsKey(a)){const m=o.get(a);if(m&&m.key==this.getKey())return m}const l=this.getTileGrid(),h=Math.max.apply(null,l.getResolutions().map((m,y)=>{const p=_t(l.getTileSize(y)),T=this.getTileSize(y);return Math.max(T[0]/p[0],T[1]/p[1])})),c=this.getTileGridForProjection(s),u=this.getTileGridForProjection(n),d=[e,t,i],f=this.getTileCoordForTileUrlFunction(d,n),g=Object.assign({sourceProj:s,sourceTileGrid:c,targetProj:n,targetTileGrid:u,tileCoord:d,wrappedTileCoord:f,pixelRatio:h,gutter:this.getGutterForProjection(s),getTileFunction:(m,y,p,T)=>this.getTile(m,y,p,T,s)},this.tileOptions),_=new na(g);return _.key=this.getKey(),_}getTile(e,t,i,n,s){const o=this.getProjection();if(o&&s&&!ii(o,s))return this.getReprojTile_(e,t,i,s,o);const a=this.getTileSize(e),l=Nn(e,t,i);if(this.tileCache.containsKey(l))return this.tileCache.get(l);const h=this.loader_;function c(){return Kh(function(){return h(e,t,i)})}const u=Object.assign({tileCoord:[e,t,i],loader:c,size:a},this.tileOptions),d=new ia(u);return d.key=this.getKey(),d.addEventListener(de.CHANGE,this.handleTileChange_),this.tileCache.set(l,d),d}handleTileChange_(e){const t=e.target,i=Ne(t),n=t.getState();let s;n==H.LOADING?(this.tileLoadingKeys_[i]=!0,s=Dn.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=n==H.ERROR?Dn.TILELOADERROR:n==H.LOADED?Dn.TILELOADEND:void 0),s&&this.dispatchEvent(new fc(s,t))}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||ii(t,e)))return this.tileGrid;const i=Ne(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=qo(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,t){const i=Ut(e);if(i){const n=Ne(i);n in this.tileGridForProjection_||(this.tileGridForProjection_[n]=t)}}getTileCacheForProjection(e){const t=this.getProjection();if(!t||ii(t,e))return this.tileCache;const i=Ne(e);return i in this.tileCacheForProjection_||(this.tileCacheForProjection_[i]=new Yo(.1)),this.tileCacheForProjection_[i]}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const n in this.tileCacheForProjection_){const s=this.tileCacheForProjection_[n];s.expireCache(s==i?t:{})}}clear(){super.clear();for(const e in this.tileCacheForProjection_)this.tileCacheForProjection_[e].clear()}}function Et(r){return(e,...t)=>Od(r,e,t)}function jn(r,e){return Et(vc(r,e).get)}const{apply:Od,construct:o3,defineProperty:a3,get:l3,getOwnPropertyDescriptor:vc,getPrototypeOf:ra,has:h3,ownKeys:kd,set:c3,setPrototypeOf:u3}=Reflect,{iterator:Mr,species:d3,toStringTag:Fd,for:f3}=Symbol,Nd=Object,{create:sa,defineProperty:Gd,freeze:g3,is:_3}=Nd,Ud=Array,zd=Ud.prototype,wc=zd[Mr],Bd=Et(wc),Cc=ArrayBuffer,Xd=Cc.prototype;jn(Xd,"byteLength");const pl=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;pl&&jn(pl.prototype,"byteLength");const Rc=ra(Uint8Array);Rc.from;const Mt=Rc.prototype;Mt[Mr];Et(Mt.keys);Et(Mt.values);Et(Mt.entries);Et(Mt.set);Et(Mt.reverse);Et(Mt.fill);Et(Mt.copyWithin);Et(Mt.sort);Et(Mt.slice);Et(Mt.subarray);jn(Mt,"buffer");jn(Mt,"byteOffset");jn(Mt,"length");jn(Mt,Fd);const Vd=Uint8Array,bc=Uint16Array,oa=Uint32Array,jd=Float32Array,mr=ra([][Mr]()),Ic=Et(mr.next),Wd=Et(function*(){}().next),Yd=ra(mr),Kd=DataView.prototype,Hd=Et(Kd.getUint16),aa=WeakMap,Sc=aa.prototype,Ac=Et(Sc.get),Zd=Et(Sc.set),Lc=new aa,qd=sa(null,{next:{value:function(){const e=Ac(Lc,this);return Ic(e)}},[Mr]:{value:function(){return this}}});function $d(r){if(r[Mr]===wc&&mr.next===Ic)return r;const e=sa(qd);return Zd(Lc,e,Bd(r)),e}const Jd=new aa,Qd=sa(Yd,{next:{value:function(){const e=Ac(Jd,this);return Wd(e)},writable:!0,configurable:!0}});for(const r of kd(mr))r!=="next"&&Gd(Qd,r,vc(mr,r));const Dc=new Cc(4),ef=new jd(Dc),tf=new oa(Dc),Qt=new bc(512),ei=new Vd(512);for(let r=0;r<256;++r){const e=r-127;e<-24?(Qt[r]=0,Qt[r|256]=32768,ei[r]=24,ei[r|256]=24):e<-14?(Qt[r]=1024>>-e-14,Qt[r|256]=1024>>-e-14|32768,ei[r]=-e-1,ei[r|256]=-e-1):e<=15?(Qt[r]=e+15<<10,Qt[r|256]=e+15<<10|32768,ei[r]=13,ei[r|256]=13):e<128?(Qt[r]=31744,Qt[r|256]=64512,ei[r]=24,ei[r|256]=24):(Qt[r]=31744,Qt[r|256]=64512,ei[r]=13,ei[r|256]=13)}const la=new oa(2048);for(let r=1;r<1024;++r){let e=r<<13,t=0;for(;!(e&8388608);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,la[r]=e|t}for(let r=1024;r<2048;++r)la[r]=939524096+(r-1024<<13);const Wn=new oa(64);for(let r=1;r<31;++r)Wn[r]=r<<23;Wn[31]=1199570944;Wn[32]=2147483648;for(let r=33;r<63;++r)Wn[r]=2147483648+(r-32<<23);Wn[63]=3347054592;const Mc=new bc(64);for(let r=1;r<64;++r)r!==32&&(Mc[r]=1024);function nf(r){const e=r>>10;return tf[0]=la[Mc[e]+(r&1023)]+Wn[e],ef[0]}function Pc(r,e,...t){return nf(Hd(r,e,...$d(t)))}var ha={exports:{}};function Oc(r,e,t){const i=t&&t.debug||!1;i&&console.log("[xml-utils] getting "+e+" in "+r);const n=typeof r=="object"?r.outer:r,s=n.slice(0,n.indexOf(">")+1),o=['"',"'"];for(let a=0;a<o.length;a++){const l=o[a],h=e+"\\="+l+"([^"+l+"]*)"+l;i&&console.log("[xml-utils] pattern:",h);const u=new RegExp(h).exec(s);if(i&&console.log("[xml-utils] match:",u),u)return u[1]}}ha.exports=Oc;ha.exports.default=Oc;var rf=ha.exports;const js=zh(rf);var ca={exports:{}},ua={exports:{}},da={exports:{}};function kc(r,e,t){const n=new RegExp(e).exec(r.slice(t));return n?t+n.index:-1}da.exports=kc;da.exports.default=kc;var sf=da.exports,fa={exports:{}};function Fc(r,e,t){const n=new RegExp(e).exec(r.slice(t));return n?t+n.index+n[0].length-1:-1}fa.exports=Fc;fa.exports.default=Fc;var of=fa.exports,ga={exports:{}};function Nc(r,e){const t=new RegExp(e,"g"),i=r.match(t);return i?i.length:0}ga.exports=Nc;ga.exports.default=Nc;var af=ga.exports;const lf=sf,Ws=of,yl=af;function Gc(r,e,t){const i=t&&t.debug||!1,n=!(t&&typeof t.nested===!1),s=t&&t.startIndex||0;i&&console.log("[xml-utils] starting findTagByName with",e," and ",t);const o=lf(r,`<${e}[ 
>/]`,s);if(i&&console.log("[xml-utils] start:",o),o===-1)return;const a=r.slice(o+e.length);let l=Ws(a,"^[^<]*[ /]>",0);const h=l!==-1&&a[l-1]==="/";if(i&&console.log("[xml-utils] selfClosing:",h),h===!1)if(n){let f=0,g=1,_=0;for(;(l=Ws(a,"[ /]"+e+">",f))!==-1;){const m=a.substring(f,l+1);if(g+=yl(m,"<"+e+`[ 
	>]`),_+=yl(m,"</"+e+">"),_>=g)break;f=l}}else l=Ws(a,"[ /]"+e+">",0);const c=o+e.length+l+1;if(i&&console.log("[xml-utils] end:",c),c===-1)return;const u=r.slice(o,c);let d;return h?d=null:d=u.slice(u.indexOf(">")+1,u.lastIndexOf("<")),{inner:d,outer:u,start:o,end:c}}ua.exports=Gc;ua.exports.default=Gc;var hf=ua.exports;const cf=hf;function Uc(r,e,t){const i=[],n=t&&t.debug||!1,s=t&&typeof t.nested=="boolean"?t.nested:!0;let o=t&&t.startIndex||0,a;for(;a=cf(r,e,{debug:n,startIndex:o});)s?o=a.start+1+e.length:o=a.end,i.push(a);return n&&console.log("findTagsByName found",i.length,"tags"),i}ca.exports=Uc;ca.exports.default=Uc;var uf=ca.exports;const df=zh(uf),ar={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},ti={};for(const r in ar)ar.hasOwnProperty(r)&&(ti[ar[r]]=parseInt(r,10));const ff=[ti.BitsPerSample,ti.ExtraSamples,ti.SampleFormat,ti.StripByteCounts,ti.StripOffsets,ti.StripRowCounts,ti.TileByteCounts,ti.TileOffsets,ti.SubIFDs],Ys={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},xe={};for(const r in Ys)Ys.hasOwnProperty(r)&&(xe[Ys[r]]=parseInt(r,10));const Pt={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},gf={Unspecified:0,Assocalpha:1,Unassalpha:2},m3={Version:0,AddCompression:1},p3={None:0,Deflate:1,Zstandard:2},_f={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function mf(r,e){const{width:t,height:i}=r,n=new Uint8Array(t*i*3);let s;for(let o=0,a=0;o<r.length;++o,a+=3)s=256-r[o]/e*256,n[a]=s,n[a+1]=s,n[a+2]=s;return n}function pf(r,e){const{width:t,height:i}=r,n=new Uint8Array(t*i*3);let s;for(let o=0,a=0;o<r.length;++o,a+=3)s=r[o]/e*256,n[a]=s,n[a+1]=s,n[a+2]=s;return n}function yf(r,e){const{width:t,height:i}=r,n=new Uint8Array(t*i*3),s=e.length/3,o=e.length/3*2;for(let a=0,l=0;a<r.length;++a,l+=3){const h=r[a];n[l]=e[h]/65536*256,n[l+1]=e[h+s]/65536*256,n[l+2]=e[h+o]/65536*256}return n}function Ef(r){const{width:e,height:t}=r,i=new Uint8Array(e*t*3);for(let n=0,s=0;n<r.length;n+=4,s+=3){const o=r[n],a=r[n+1],l=r[n+2],h=r[n+3];i[s]=255*((255-o)/256)*((255-h)/256),i[s+1]=255*((255-a)/256)*((255-h)/256),i[s+2]=255*((255-l)/256)*((255-h)/256)}return i}function Tf(r){const{width:e,height:t}=r,i=new Uint8ClampedArray(e*t*3);for(let n=0,s=0;n<r.length;n+=3,s+=3){const o=r[n],a=r[n+1],l=r[n+2];i[s]=o+1.402*(l-128),i[s+1]=o-.34414*(a-128)-.71414*(l-128),i[s+2]=o+1.772*(a-128)}return i}const xf=.95047,vf=1,wf=1.08883;function Cf(r){const{width:e,height:t}=r,i=new Uint8Array(e*t*3);for(let n=0,s=0;n<r.length;n+=3,s+=3){const o=r[n+0],a=r[n+1]<<24>>24,l=r[n+2]<<24>>24;let h=(o+16)/116,c=a/500+h,u=h-l/200,d,f,g;c=xf*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),h=vf*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),u=wf*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),d=c*3.2406+h*-1.5372+u*-.4986,f=c*-.9689+h*1.8758+u*.0415,g=c*.0557+h*-.204+u*1.057,d=d>.0031308?1.055*d**(1/2.4)-.055:12.92*d,f=f>.0031308?1.055*f**(1/2.4)-.055:12.92*f,g=g>.0031308?1.055*g**(1/2.4)-.055:12.92*g,i[s]=Math.max(0,Math.min(1,d))*255,i[s+1]=Math.max(0,Math.min(1,f))*255,i[s+2]=Math.max(0,Math.min(1,g))*255}return i}const zc=new Map;function Zi(r,e){Array.isArray(r)||(r=[r]),r.forEach(t=>zc.set(t,e))}async function Bc(r){const e=zc.get(r.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${r.Compression}`);const t=await e();return new t(r)}Zi([void 0,1],()=>Ki(()=>import("./CHKDjEZ-.js"),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.default));Zi(5,()=>Ki(()=>import("./HrrS11cL.js"),__vite__mapDeps([2,1]),import.meta.url).then(r=>r.default));Zi(6,()=>{throw new Error("old style JPEG compression is not supported.")});Zi(7,()=>Ki(()=>import("./DeqPN9fI.js"),__vite__mapDeps([3,1]),import.meta.url).then(r=>r.default));Zi([8,32946],()=>Ki(()=>import("./DZr1-enG.js"),__vite__mapDeps([4,5,1]),import.meta.url).then(r=>r.default));Zi(32773,()=>Ki(()=>import("./D594CN9I.js"),__vite__mapDeps([6,1]),import.meta.url).then(r=>r.default));Zi(34887,()=>Ki(()=>import("./Bo-R5oOz.js"),__vite__mapDeps([7,5,8,1]),import.meta.url).then(async r=>(await r.zstd.init(),r)).then(r=>r.default));Zi(50001,()=>Ki(()=>import("./DIXDofUi.js"),__vite__mapDeps([9,1]),import.meta.url).then(r=>r.default));function Ls(r,e,t,i=1){return new(Object.getPrototypeOf(r)).constructor(e*t*i)}function Rf(r,e,t,i,n){const s=e/i,o=t/n;return r.map(a=>{const l=Ls(a,i,n);for(let h=0;h<n;++h){const c=Math.min(Math.round(o*h),t-1);for(let u=0;u<i;++u){const d=Math.min(Math.round(s*u),e-1),f=a[c*e+d];l[h*i+u]=f}}return l})}function Mn(r,e,t){return(1-t)*r+t*e}function bf(r,e,t,i,n){const s=e/i,o=t/n;return r.map(a=>{const l=Ls(a,i,n);for(let h=0;h<n;++h){const c=o*h,u=Math.floor(c),d=Math.min(Math.ceil(c),t-1);for(let f=0;f<i;++f){const g=s*f,_=g%1,m=Math.floor(g),y=Math.min(Math.ceil(g),e-1),p=a[u*e+m],T=a[u*e+y],E=a[d*e+m],x=a[d*e+y],v=Mn(Mn(p,T,_),Mn(E,x,_),c%1);l[h*i+f]=v}}return l})}function If(r,e,t,i,n,s="nearest"){switch(s.toLowerCase()){case"nearest":return Rf(r,e,t,i,n);case"bilinear":case"linear":return bf(r,e,t,i,n);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function Sf(r,e,t,i,n,s){const o=e/i,a=t/n,l=Ls(r,i,n,s);for(let h=0;h<n;++h){const c=Math.min(Math.round(a*h),t-1);for(let u=0;u<i;++u){const d=Math.min(Math.round(o*u),e-1);for(let f=0;f<s;++f){const g=r[c*e*s+d*s+f];l[h*i*s+u*s+f]=g}}}return l}function Af(r,e,t,i,n,s){const o=e/i,a=t/n,l=Ls(r,i,n,s);for(let h=0;h<n;++h){const c=a*h,u=Math.floor(c),d=Math.min(Math.ceil(c),t-1);for(let f=0;f<i;++f){const g=o*f,_=g%1,m=Math.floor(g),y=Math.min(Math.ceil(g),e-1);for(let p=0;p<s;++p){const T=r[u*e*s+m*s+p],E=r[u*e*s+y*s+p],x=r[d*e*s+m*s+p],v=r[d*e*s+y*s+p],C=Mn(Mn(T,E,_),Mn(x,v,_),c%1);l[h*i*s+f*s+p]=C}}}return l}function Lf(r,e,t,i,n,s,o="nearest"){switch(o.toLowerCase()){case"nearest":return Sf(r,e,t,i,n,s);case"bilinear":case"linear":return Af(r,e,t,i,n,s);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function Df(r,e,t){let i=0;for(let n=e;n<t;++n)i+=r[n];return i}function vo(r,e,t){switch(r){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function Mf(r,e){return(r===1||r===2)&&e<=32&&e%8===0?!1:!(r===3&&(e===16||e===32||e===64))}function Pf(r,e,t,i,n,s,o){const a=new DataView(r),l=t===2?o*s:o*s*i,h=t===2?1:i,c=vo(e,n,l),u=parseInt("1".repeat(n),2);if(e===1){let d;t===1?d=i*n:d=n;let f=s*d;f&7&&(f=f+7&-8);for(let g=0;g<o;++g){const _=g*f;for(let m=0;m<s;++m){const y=_+m*h*n;for(let p=0;p<h;++p){const T=y+p*n,E=(g*s+m)*h+p,x=Math.floor(T/8),v=T%8;if(v+n<=8)c[E]=a.getUint8(x)>>8-n-v&u;else if(v+n<=16)c[E]=a.getUint16(x)>>16-n-v&u;else if(v+n<=24){const C=a.getUint16(x)<<8|a.getUint8(x+2);c[E]=C>>24-n-v&u}else c[E]=a.getUint32(x)>>32-n-v&u}}}}return c.buffer}class Xc{constructor(e,t,i,n,s,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=i,this.littleEndian=n,this.tiles=s?{}:null,this.isTiled=!e.StripOffsets;const a=e.PlanarConfiguration;if(this.planarConfiguration=typeof a>"u"?1:a,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,i=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(n,s){return Pc(this,n,s)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const i=this.getSampleFormat(e),n=this.getBitsPerSample(e);return vo(i,n,t)}async getTileOrStrip(e,t,i,n,s){const o=Math.ceil(this.getWidth()/this.getTileWidth()),a=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:h}=this;this.planarConfiguration===1?l=t*o+e:this.planarConfiguration===2&&(l=i*o*a+t*o+e);let c,u;this.isTiled?(c=this.fileDirectory.TileOffsets[l],u=this.fileDirectory.TileByteCounts[l]):(c=this.fileDirectory.StripOffsets[l],u=this.fileDirectory.StripByteCounts[l]);const d=(await this.source.fetch([{offset:c,length:u}],s))[0];let f;return h===null||!h[l]?(f=(async()=>{let g=await n.decode(this.fileDirectory,d);const _=this.getSampleFormat(),m=this.getBitsPerSample();return Mf(_,m)&&(g=Pf(g,_,this.planarConfiguration,this.getSamplesPerPixel(),m,this.getTileWidth(),this.getBlockHeight(t))),g})(),h!==null&&(h[l]=f)):f=h[l],{x:e,y:t,sample:i,data:await f}}async _readRaster(e,t,i,n,s,o,a,l,h){const c=this.getTileWidth(),u=this.getTileHeight(),d=this.getWidth(),f=this.getHeight(),g=Math.max(Math.floor(e[0]/c),0),_=Math.min(Math.ceil(e[2]/c),Math.ceil(d/c)),m=Math.max(Math.floor(e[1]/u),0),y=Math.min(Math.ceil(e[3]/u),Math.ceil(f/u)),p=e[2]-e[0];let T=this.getBytesPerPixel();const E=[],x=[];for(let R=0;R<t.length;++R)this.planarConfiguration===1?E.push(Df(this.fileDirectory.BitsPerSample,0,t[R])/8):E.push(0),x.push(this.getReaderForSample(t[R]));const v=[],{littleEndian:C}=this;for(let R=m;R<y;++R)for(let S=g;S<_;++S){let P;this.planarConfiguration===1&&(P=this.getTileOrStrip(S,R,0,s,h));for(let O=0;O<t.length;++O){const N=O,V=t[O];this.planarConfiguration===2&&(T=this.getSampleByteSize(V),P=this.getTileOrStrip(S,R,V,s,h));const U=P.then(L=>{const k=L.data,Q=new DataView(k),q=this.getBlockHeight(L.y),ie=L.y*u,J=L.x*c,Z=ie+q,fe=(L.x+1)*c,Ie=x[N],X=Math.min(q,q-(Z-e[3]),f-ie),De=Math.min(c,c-(fe-e[2]),d-J);for(let Re=Math.max(0,e[1]-ie);Re<X;++Re)for(let K=Math.max(0,e[0]-J);K<De;++K){const ce=(Re*c+K)*T,Ke=Ie.call(Q,ce+E[N],C);let me;n?(me=(Re+ie-e[1])*p*t.length+(K+J-e[0])*t.length+N,i[me]=Ke):(me=(Re+ie-e[1])*p+K+J-e[0],i[N][me]=Ke)}});v.push(U)}}if(await Promise.all(v),o&&e[2]-e[0]!==o||a&&e[3]-e[1]!==a){let R;return n?R=Lf(i,e[2]-e[0],e[3]-e[1],o,a,t.length,l):R=If(i,e[2]-e[0],e[3]-e[1],o,a,l),R.width=o,R.height=a,R}return i.width=o||e[2]-e[0],i.height=a||e[3]-e[1],i}async readRasters({window:e,samples:t=[],interleave:i,pool:n=null,width:s,height:o,resampleMethod:a,fillValue:l,signal:h}={}){const c=e||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const u=c[2]-c[0],d=c[3]-c[1],f=u*d,g=this.getSamplesPerPixel();if(!t||!t.length)for(let p=0;p<g;++p)t.push(p);else for(let p=0;p<t.length;++p)if(t[p]>=g)return Promise.reject(new RangeError(`Invalid sample index '${t[p]}'.`));let _;if(i){const p=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,T=Math.max.apply(null,this.fileDirectory.BitsPerSample);_=vo(p,T,f*t.length),l&&_.fill(l)}else{_=[];for(let p=0;p<t.length;++p){const T=this.getArrayForSample(t[p],f);Array.isArray(l)&&p<l.length?T.fill(l[p]):l&&!Array.isArray(l)&&T.fill(l),_.push(T)}}const m=n||await Bc(this.fileDirectory);return await this._readRaster(c,t,_,i,m,s,o,a,h)}async readRGB({window:e,interleave:t=!0,pool:i=null,width:n,height:s,resampleMethod:o,enableAlpha:a=!1,signal:l}={}){const h=e||[0,0,this.getWidth(),this.getHeight()];if(h[0]>h[2]||h[1]>h[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===Pt.RGB){let y=[0,1,2];if(this.fileDirectory.ExtraSamples!==gf.Unspecified&&a){y=[];for(let p=0;p<this.fileDirectory.BitsPerSample.length;p+=1)y.push(p)}return this.readRasters({window:e,interleave:t,samples:y,pool:i,width:n,height:s,resampleMethod:o,signal:l})}let u;switch(c){case Pt.WhiteIsZero:case Pt.BlackIsZero:case Pt.Palette:u=[0];break;case Pt.CMYK:u=[0,1,2,3];break;case Pt.YCbCr:case Pt.CIELab:u=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const d={window:h,interleave:!0,samples:u,pool:i,width:n,height:s,resampleMethod:o,signal:l},{fileDirectory:f}=this,g=await this.readRasters(d),_=2**this.fileDirectory.BitsPerSample[0];let m;switch(c){case Pt.WhiteIsZero:m=mf(g,_);break;case Pt.BlackIsZero:m=pf(g,_);break;case Pt.Palette:m=yf(g,f.ColorMap);break;case Pt.CMYK:m=Ef(g);break;case Pt.YCbCr:m=Tf(g);break;case Pt.CIELab:m=Cf(g);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const y=new Uint8Array(m.length/3),p=new Uint8Array(m.length/3),T=new Uint8Array(m.length/3);for(let E=0,x=0;E<m.length;E+=3,++x)y[x]=m[E],p[x]=m[E+1],T[x]=m[E+2];m=[y,p,T]}return m.width=g.width,m.height=g.height,m}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const i=this.fileDirectory.GDAL_METADATA;let n=df(i,"Item");e===null?n=n.filter(s=>js(s,"sample")===void 0):n=n.filter(s=>Number(js(s,"sample"))===e);for(let s=0;s<n.length;++s){const o=n[s];t[js(o,"name")]=o.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(i)return i[1]===0&&i[4]===0?[i[0],-i[5],i[10]]:[Math.sqrt(i[0]*i[0]+i[4]*i[4]),-Math.sqrt(i[1]*i[1]+i[5]*i[5]),i[10]];if(e){const[n,s,o]=e.getResolution();return[n*e.getWidth()/this.getWidth(),s*e.getHeight()/this.getHeight(),o*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(e=!1){const t=this.getHeight(),i=this.getWidth();if(this.fileDirectory.ModelTransformation&&!e){const[n,s,o,a,l,h,c,u]=this.fileDirectory.ModelTransformation,f=[[0,0],[0,t],[i,0],[i,t]].map(([m,y])=>[a+n*m+s*y,u+l*m+h*y]),g=f.map(m=>m[0]),_=f.map(m=>m[1]);return[Math.min(...g),Math.min(..._),Math.max(...g),Math.max(..._)]}else{const n=this.getOrigin(),s=this.getResolution(),o=n[0],a=n[1],l=o+s[0]*i,h=a+s[1]*t;return[Math.min(o,l),Math.min(a,h),Math.max(o,l),Math.max(a,h)]}}}class Of{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const i=this.getUint32(e,t),n=this.getUint32(e+4,t);let s;if(t){if(s=i+2**32*n,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*i+n,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}getInt64(e,t){let i=0;const n=(this._dataView.getUint8(e+(t?7:0))&128)>0;let s=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(t?o:7-o));n&&(s?a!==0&&(a=~(a-1)&255,s=!1):a=~a&255),i+=a*256**o}return n&&(i=-i),i}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return Pc(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class kf{constructor(e,t,i,n){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=i,this._bigTiff=n}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),i=this.readUint32(e+4);let n;if(this._littleEndian){if(n=t+2**32*i,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}if(n=2**32*t+i,!Number.isSafeInteger(n))throw new Error(`${n} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return n}readInt64(e){let t=0;const i=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let n=!0;for(let s=0;s<8;s++){let o=this._dataView.getUint8(e+(this._littleEndian?s:7-s));i&&(n?o!==0&&(o=~(o-1)&255,n=!1):o=~o&255),t+=o*256**s}return i&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const Ff=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class Nf{constructor(e=Ff,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(i=>{Ki(()=>import("./CaSv2t6h.js"),[],import.meta.url).then(n=>{i(n.create)})}),this._awaitingDecoder.then(i=>{this._awaitingDecoder=null,this.workers=[];for(let n=0;n<e;n++)this.workers.push({worker:i(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?Bc(e).then(i=>i.decode(e,t)):new Promise(i=>{const n=this.workers.find(a=>a.idle)||this.workers[Math.floor(Math.random()*this.size)];n.idle=!1;const s=this.messageId++,o=a=>{a.data.id===s&&(n.idle=!0,i(a.data.decoded),n.worker.removeEventListener("message",o))};n.worker.addEventListener("message",o),n.worker.postMessage({fileDirectory:e,buffer:t,id:s},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const El=`\r
\r
`;function Vc(r){if(typeof Object.fromEntries<"u")return Object.fromEntries(r);const e={};for(const[t,i]of r)e[t.toLowerCase()]=i;return e}function Gf(r){const e=r.split(`\r
`).map(t=>{const i=t.split(":").map(n=>n.trim());return i[0]=i[0].toLowerCase(),i});return Vc(e)}function Uf(r){const[e,...t]=r.split(";").map(n=>n.trim()),i=t.map(n=>n.split("="));return{type:e,params:Vc(i)}}function wo(r){let e,t,i;return r&&([,e,t,i]=r.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),i=parseInt(i,10)),{start:e,end:t,total:i}}function zf(r,e){let t=null;const i=new TextDecoder("ascii"),n=[],s=`--${e}`,o=`${s}--`;for(let a=0;a<10;++a)i.decode(new Uint8Array(r,a,s.length))===s&&(t=a);if(t===null)throw new Error("Could not find initial boundary");for(;t<r.byteLength;){const a=i.decode(new Uint8Array(r,t,Math.min(s.length+1024,r.byteLength-t)));if(a.length===0||a.startsWith(o))break;if(!a.startsWith(s))throw new Error("Part does not start with boundary");const l=a.substr(s.length+2);if(l.length===0)break;const h=l.indexOf(El),c=Gf(l.substr(0,h)),{start:u,end:d,total:f}=wo(c["content-range"]),g=t+s.length+h+El.length,_=parseInt(d,10)+1-parseInt(u,10);n.push({headers:c,data:r.slice(g,g+_),offset:u,length:_,fileSize:f}),t=g+_+4}return n}class _a{async fetch(e,t=void 0){return Promise.all(e.map(i=>this.fetchSlice(i,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class Bf extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,i]of e)this.onEviction(t,i.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const i=t.get(e);return this._getItemValue(e,i)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield e)}for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:i=this.maxAge}={}){const n=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;return this.cache.has(e)?this.cache.set(e,{value:t,expiry:n}):this._set(e,{value:t,expiry:n}),this}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],i=t.length-e;i<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(i>0&&this._emitEvictions(t.slice(0,i)),this.oldCache=new Map(t.slice(i)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const i=e[t],[n,s]=i;this._deleteIfExpired(n,s)===!1&&(yield[n,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const i=e[t],[n,s]=i;this.cache.has(n)||this._deleteIfExpired(n,s)===!1&&(yield[n,s.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[i,n]of this.entriesAscending())e.call(t,n,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function Xf(r){return new Promise(e=>setTimeout(e,r))}function Vf(r,e){const t=Array.isArray(r)?r:Array.from(r),i=Array.isArray(e)?e:Array.from(e);return t.map((n,s)=>[n,i[s]])}class Gn extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,Gn),this.name="AbortError"}}class jf extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const Wf=jf;class Yf{constructor(e,t,i=null){this.offset=e,this.length=t,this.data=i}get top(){return this.offset+this.length}}class Tl{constructor(e,t,i){this.offset=e,this.length=t,this.blockIds=i}}class Kf extends _a{constructor(e,{blockSize:t=65536,cacheSize:i=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new Bf({maxSize:i,onEviction:(n,s)=>{this.evictedBlocks.set(n,s)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const i=[],n=[],s=[];this.evictedBlocks.clear();for(const{offset:d,length:f}of e){let g=d+f;const{fileSize:_}=this;_!==null&&(g=Math.min(g,_));const m=Math.floor(d/this.blockSize)*this.blockSize;for(let y=m;y<g;y+=this.blockSize){const p=Math.floor(y/this.blockSize);!this.blockCache.has(p)&&!this.blockRequests.has(p)&&(this.blockIdsToFetch.add(p),n.push(p)),this.blockRequests.has(p)&&i.push(this.blockRequests.get(p)),s.push(p)}}await Xf(),this.fetchBlocks(t);const o=[];for(const d of n)this.blockRequests.has(d)&&o.push(this.blockRequests.get(d));await Promise.allSettled(i),await Promise.allSettled(o);const a=[],l=s.filter(d=>this.abortedBlockIds.has(d)||!this.blockCache.has(d));if(l.forEach(d=>this.blockIdsToFetch.add(d)),l.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const d of l){const f=this.blockRequests.get(d);if(!f)throw new Error(`Block ${d} is not in the block requests`);a.push(f)}await Promise.allSettled(a)}if(t&&t.aborted)throw new Gn("Request was aborted");const h=s.map(d=>this.blockCache.get(d)||this.evictedBlocks.get(d)),c=h.filter(d=>!d);if(c.length)throw new Wf(c,"Request failed");const u=new Map(Vf(s,h));return this.readSliceData(e,u)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),i=this.source.fetch(t,e);for(let n=0;n<t.length;++n){const s=t[n];for(const o of s.blockIds)this.blockRequests.set(o,(async()=>{try{const a=(await i)[n],l=o*this.blockSize,h=l-a.offset,c=Math.min(h+this.blockSize,a.data.byteLength),u=a.data.slice(h,c),d=new Yf(l,u.byteLength,u,o);this.blockCache.set(o,d),this.abortedBlockIds.delete(o)}catch(a){if(a.name==="AbortError")a.signal=e,this.blockCache.delete(o),this.abortedBlockIds.add(o);else throw a}finally{this.blockRequests.delete(o)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((o,a)=>o-a);if(t.length===0)return[];let i=[],n=null;const s=[];for(const o of t)n===null||n+1===o?(i.push(o),n=o):(s.push(new Tl(i[0]*this.blockSize,i.length*this.blockSize,i)),i=[o],n=o);return s.push(new Tl(i[0]*this.blockSize,i.length*this.blockSize,i)),s}readSliceData(e,t){return e.map(i=>{let n=i.offset+i.length;this.fileSize!==null&&(n=Math.min(this.fileSize,n));const s=Math.floor(i.offset/this.blockSize),o=Math.floor(n/this.blockSize),a=new ArrayBuffer(i.length),l=new Uint8Array(a);for(let h=s;h<=o;++h){const c=t.get(h),u=c.offset-i.offset,d=c.top-n;let f=0,g=0,_;u<0?f=-u:u>0&&(g=u),d<0?_=c.length-f:_=n-c.offset-f;const m=new Uint8Array(c.data,f,_);l.set(m,g)}return a})}}class ma{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class pa{constructor(e){this.url=e}async request({headers:e,signal:t}={}){throw new Error("request is not implemented")}}class Hf extends ma{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class Zf extends pa{constructor(e,t){super(e),this.credentials=t}async request({headers:e,signal:t}={}){const i=await fetch(this.url,{headers:e,credentials:this.credentials,signal:t});return new Hf(i)}}class qf extends ma{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class $f extends pa{constructRequest(e,t){return new Promise((i,n)=>{const s=new XMLHttpRequest;s.open("GET",this.url),s.responseType="arraybuffer";for(const[o,a]of Object.entries(e))s.setRequestHeader(o,a);s.onload=()=>{const o=s.response;i(new qf(s,o))},s.onerror=n,s.onabort=()=>n(new Gn("Request aborted")),s.send(),t&&(t.aborted&&s.abort(),t.addEventListener("abort",()=>s.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}const Ks={};class Jf extends ma{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class Qf extends pa{constructor(e){super(e),this.parsedUrl=Ks.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",Ks)}constructRequest(e,t){return new Promise((i,n)=>{const s=this.httpApi.get({...this.parsedUrl,headers:e},o=>{const a=new Promise(l=>{const h=[];o.on("data",c=>{h.push(c)}),o.on("end",()=>{const c=Buffer.concat(h).buffer;l(c)}),o.on("error",n)});i(new Jf(o,a))});s.on("error",n),t&&(t.aborted&&s.destroy(new Gn("Request aborted")),t.addEventListener("abort",()=>s.destroy(new Gn("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class ya extends _a{constructor(e,t,i,n){super(),this.client=e,this.headers=t,this.maxRanges=i,this.allowFullFile=n,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(i=>this.fetchSlice(i,t))))}async fetchSlices(e,t){const i=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:n,length:s})=>`${n}-${n+s}`).join(",")}`},signal:t});if(i.ok)if(i.status===206){const{type:n,params:s}=Uf(i.getHeader("content-type"));if(n==="multipart/byteranges"){const u=zf(await i.getData(),s.boundary);return this._fileSize=u[0].fileSize||null,u}const o=await i.getData(),{start:a,end:l,total:h}=wo(i.getHeader("content-range"));this._fileSize=h||null;const c=[{data:o,offset:a,length:l-a}];if(e.length>1){const u=await Promise.all(e.slice(1).map(d=>this.fetchSlice(d,t)));return c.concat(u)}return c}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const n=await i.getData();return this._fileSize=n.byteLength,[{data:n,offset:0,length:n.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:i,length:n}=e,s=await this.client.request({headers:{...this.headers,Range:`bytes=${i}-${i+n}`},signal:t});if(s.ok)if(s.status===206){const o=await s.getData(),{total:a}=wo(s.getHeader("content-range"));return this._fileSize=a||null,{data:o,offset:i,length:n}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await s.getData();return this._fileSize=o.byteLength,{data:o,offset:0,length:o.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function Ea(r,{blockSize:e,cacheSize:t}){return e===null?r:new Kf(r,{blockSize:e,cacheSize:t})}function e2(r,{headers:e={},credentials:t,maxRanges:i=0,allowFullFile:n=!1,...s}={}){const o=new Zf(r,t),a=new ya(o,e,i,n);return Ea(a,s)}function t2(r,{headers:e={},maxRanges:t=0,allowFullFile:i=!1,...n}={}){const s=new $f(r),o=new ya(s,e,t,i);return Ea(o,n)}function i2(r,{headers:e={},maxRanges:t=0,allowFullFile:i=!1,...n}={}){const s=new Qf(r),o=new ya(s,e,t,i);return Ea(o,n)}function Co(r,{forceXHR:e=!1,...t}={}){return typeof fetch=="function"&&!e?e2(r,t):typeof XMLHttpRequest<"u"?t2(r,t):i2(r,t)}class n2 extends _a{constructor(e){super(),this.file=e}async fetchSlice(e,t){return new Promise((i,n)=>{const s=this.file.slice(e.offset,e.offset+e.length),o=new FileReader;o.onload=a=>i(a.target.result),o.onerror=n,o.onabort=n,o.readAsArrayBuffer(s),t&&t.addEventListener("abort",()=>o.abort())})}}function r2(r){return new n2(r)}function Ro(r){switch(r){case xe.BYTE:case xe.ASCII:case xe.SBYTE:case xe.UNDEFINED:return 1;case xe.SHORT:case xe.SSHORT:return 2;case xe.LONG:case xe.SLONG:case xe.FLOAT:case xe.IFD:return 4;case xe.RATIONAL:case xe.SRATIONAL:case xe.DOUBLE:case xe.LONG8:case xe.SLONG8:case xe.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${r}`)}}function s2(r){const e=r.GeoKeyDirectory;if(!e)return null;const t={};for(let i=4;i<=e[3]*4;i+=4){const n=_f[e[i]],s=e[i+1]?ar[e[i+1]]:null,o=e[i+2],a=e[i+3];let l=null;if(!s)l=a;else{if(l=r[s],typeof l>"u"||l===null)throw new Error(`Could not get value of geoKey '${n}'.`);typeof l=="string"?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),o===1&&(l=l[0]))}t[n]=l}return t}function pn(r,e,t,i){let n=null,s=null;const o=Ro(e);switch(e){case xe.BYTE:case xe.ASCII:case xe.UNDEFINED:n=new Uint8Array(t),s=r.readUint8;break;case xe.SBYTE:n=new Int8Array(t),s=r.readInt8;break;case xe.SHORT:n=new Uint16Array(t),s=r.readUint16;break;case xe.SSHORT:n=new Int16Array(t),s=r.readInt16;break;case xe.LONG:case xe.IFD:n=new Uint32Array(t),s=r.readUint32;break;case xe.SLONG:n=new Int32Array(t),s=r.readInt32;break;case xe.LONG8:case xe.IFD8:n=new Array(t),s=r.readUint64;break;case xe.SLONG8:n=new Array(t),s=r.readInt64;break;case xe.RATIONAL:n=new Uint32Array(t*2),s=r.readUint32;break;case xe.SRATIONAL:n=new Int32Array(t*2),s=r.readInt32;break;case xe.FLOAT:n=new Float32Array(t),s=r.readFloat32;break;case xe.DOUBLE:n=new Float64Array(t),s=r.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===xe.RATIONAL||e===xe.SRATIONAL)for(let a=0;a<t;a+=2)n[a]=s.call(r,i+a*o),n[a+1]=s.call(r,i+(a*o+4));else for(let a=0;a<t;++a)n[a]=s.call(r,i+a*o);return e===xe.ASCII?new TextDecoder("utf-8").decode(n):n}class o2{constructor(e,t,i){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=i}}class Wr extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class jc{async readRasters(e={}){const{window:t,width:i,height:n}=e;let{resX:s,resY:o,bbox:a}=e;const l=await this.getImage();let h=l;const c=await this.getImageCount(),u=l.getBoundingBox();if(t&&a)throw new Error('Both "bbox" and "window" passed.');if(i||n){if(t){const[g,_]=l.getOrigin(),[m,y]=l.getResolution();a=[g+t[0]*m,_+t[1]*y,g+t[2]*m,_+t[3]*y]}const f=a||u;if(i){if(s)throw new Error("Both width and resX passed");s=(f[2]-f[0])/i}if(n){if(o)throw new Error("Both width and resY passed");o=(f[3]-f[1])/n}}if(s||o){const f=[];for(let g=0;g<c;++g){const _=await this.getImage(g),{SubfileType:m,NewSubfileType:y}=_.fileDirectory;(g===0||m===2||y&1)&&f.push(_)}f.sort((g,_)=>g.getWidth()-_.getWidth());for(let g=0;g<f.length;++g){const _=f[g],m=(u[2]-u[0])/_.getWidth(),y=(u[3]-u[1])/_.getHeight();if(h=_,s&&s>m||o&&o>y)break}}let d=t;if(a){const[f,g]=l.getOrigin(),[_,m]=h.getResolution(l);d=[Math.round((a[0]-f)/_),Math.round((a[1]-g)/m),Math.round((a[2]-f)/_),Math.round((a[3]-g)/m)],d=[Math.min(d[0],d[2]),Math.min(d[1],d[3]),Math.max(d[0],d[2]),Math.max(d[1],d[3])]}return h.readRasters({...e,window:d})}}class Un extends jc{constructor(e,t,i,n,s={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=i,this.firstIFDOffset=n,this.cache=s.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const i=this.bigTiff?4048:1024;return new kf((await this.source.fetch([{offset:e,length:typeof t<"u"?t:i}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,i=this.bigTiff?8:2;let n=await this.getSlice(e);const s=this.bigTiff?n.readUint64(e):n.readUint16(e),o=s*t+(this.bigTiff?16:6);n.covers(e,o)||(n=await this.getSlice(e,o));const a={};let l=e+(this.bigTiff?8:2);for(let u=0;u<s;l+=t,++u){const d=n.readUint16(l),f=n.readUint16(l+2),g=this.bigTiff?n.readUint64(l+4):n.readUint32(l+4);let _,m;const y=Ro(f),p=l+(this.bigTiff?12:8);if(y*g<=(this.bigTiff?8:4))_=pn(n,f,g,p);else{const T=n.readOffset(p),E=Ro(f)*g;if(n.covers(T,E))_=pn(n,f,g,T);else{const x=await this.getSlice(T,E);_=pn(x,f,g,T)}}g===1&&ff.indexOf(d)===-1&&!(f===xe.RATIONAL||f===xe.SRATIONAL)?m=_[0]:m=_,a[ar[d]]=m}const h=s2(a),c=n.readOffset(e+i+t*s);return new o2(a,h,c)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof Wr?new Wr(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new Wr(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new Xc(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(i){if(i instanceof Wr)t=!1;else throw i}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",i=t.length+100;let n=await this.getSlice(e,i);if(t===pn(n,xe.ASCII,t.length,e)){const o=pn(n,xe.ASCII,i,e).split(`
`)[0],a=Number(o.split("=")[1].split(" ")[0])+o.length;a>i&&(n=await this.getSlice(e,a));const l=pn(n,xe.ASCII,a,e);this.ghostValues={},l.split(`
`).filter(h=>h.length>0).map(h=>h.split("=")).forEach(([h,c])=>{this.ghostValues[h]=c})}return this.ghostValues}static async fromSource(e,t,i){const n=(await e.fetch([{offset:0,length:1024}],i))[0],s=new Of(n),o=s.getUint16(0,0);let a;if(o===18761)a=!0;else if(o===19789)a=!1;else throw new TypeError("Invalid byte order value.");const l=s.getUint16(2,a);let h;if(l===42)h=!1;else if(l===43){if(h=!0,s.getUint16(4,a)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const c=h?s.getUint64(8,a):s.getUint32(4,a);return new Un(e,a,h,c,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class a2 extends jc{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,i=0;for(let n=0;n<this.imageFiles.length;n++){const s=this.imageFiles[n];for(let o=0;o<this.imageCounts[n];o++){if(e===t){const a=await s.requestIFD(i);return new Xc(a.fileDirectory,a.geoKeyDirectory,s.dataView,s.littleEndian,s.cache,s.source)}t++,i++}i=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,i)=>t+i,0),this.imageCount}}async function l2(r,e={},t){return Un.fromSource(Co(r,e),t)}async function h2(r,e){return Un.fromSource(r2(r),e)}async function c2(r,e=[],t={},i){const n=await Un.fromSource(Co(r,t),i),s=await Promise.all(e.map(o=>Un.fromSource(Co(o,t))));return new a2(n,s)}function u2(r){return((r.fileDirectory.NewSubfileType||0)&4)===4}function d2(r,e){if(!r)return!1;if(r===!0)return!0;if(e.getSamplesPerPixel()!==3)return!1;const t=e.fileDirectory.PhotometricInterpretation,i=Pt;return t===i.CMYK||t===i.YCbCr||t===i.CIELab||t===i.ICCLab}const xl="STATISTICS_MAXIMUM",vl="STATISTICS_MINIMUM",Hs=256;let Zs;function f2(){return Zs||(Zs=new Nf),Zs}function g2(r){try{return r.getBoundingBox()}catch{return[0,0,r.getWidth(),r.getHeight()]}}function _2(r){try{return r.getOrigin().slice(0,2)}catch{return[0,r.getHeight()]}}function m2(r,e){try{return r.getResolution(e)}catch{return[e.getWidth()/r.getWidth(),e.getHeight()/r.getHeight()]}}function p2(r){const e=r.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey&&e.ProjectedCSTypeGeoKey!==32767){const t="EPSG:"+e.ProjectedCSTypeGeoKey;let i=Ut(t);if(!i){const n=Ka(e.ProjLinearUnitsGeoKey);n&&(i=new rs({code:t,units:n}))}return i}if(e.GeographicTypeGeoKey&&e.GeographicTypeGeoKey!==32767){const t="EPSG:"+e.GeographicTypeGeoKey;let i=Ut(t);if(!i){const n=Ka(e.GeogAngularUnitsGeoKey);n&&(i=new rs({code:t,units:n}))}return i}return null}function y2(r){return r.getImageCount().then(function(e){const t=new Array(e);for(let i=0;i<e;++i)t[i]=r.getImage(i);return Promise.all(t)})}function E2(r,e){let t;return r.blob?t=h2(r.blob):r.overviews?t=c2(r.url,r.overviews,e):t=l2(r.url,e),t.then(y2)}function nr(r,e,t,i,n){if(Array.isArray(r)){const s=r.length;if(!Array.isArray(e)||s!=e.length){const o=new Error(i);throw n(o),o}for(let o=0;o<s;++o)nr(r[o],e[o],t,i,n);return}if(e=e,Math.abs(r-e)>t*r)throw new Error(i)}function T2(r){return r instanceof Int8Array?-128:r instanceof Int16Array?-32768:r instanceof Int32Array?-2147483648:r instanceof Float32Array?12e-39:0}function x2(r){return r instanceof Int8Array?127:r instanceof Uint8Array||r instanceof Uint8ClampedArray?255:r instanceof Int16Array?32767:r instanceof Uint16Array?65535:r instanceof Int32Array?2147483647:r instanceof Uint32Array?4294967295:r instanceof Float32Array?34e37:255}class v2 extends Pd{constructor(e){super({state:"loading",tileGrid:null,projection:e.projection||null,opaque:e.opaque,transition:e.transition,interpolate:e.interpolate!==!1,wrapX:e.wrapX}),this.sourceInfo_=e.sources;const t=this.sourceInfo_.length;this.sourceOptions_=e.sourceOptions,this.sourceImagery_=new Array(t),this.sourceMasks_=new Array(t),this.resolutionFactors_=new Array(t),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=e.normalize!==!1,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=e.convertToRGB||!1,this.setKey(this.sourceInfo_.map(s=>s.url).join(","));const i=this,n=new Array(t);for(let s=0;s<t;++s)n[s]=E2(this.sourceInfo_[s],this.sourceOptions_);Promise.all(n).then(function(s){i.configure_(s)}).catch(function(s){Ja(s),i.error_=s,i.setState("error")})}getError(){return this.error_}determineProjection(e){const t=e[0];for(let i=t.length-1;i>=0;--i){const n=t[i],s=p2(n);if(s){this.projection=s;break}}}configure_(e){let t,i,n,s,o;const a=new Array(e.length),l=new Array(e.length),h=new Array(e.length);let c=0;const u=e.length;for(let _=0;_<u;++_){const m=[],y=[];e[_].forEach(R=>{u2(R)?y.push(R):m.push(R)});const p=m.length;if(y.length>0&&y.length!==p)throw new Error(`Expected one mask per image found ${y.length} masks and ${p} images`);let T,E;const x=new Array(p),v=new Array(p),C=new Array(p);l[_]=new Array(p),h[_]=new Array(p);for(let R=0;R<p;++R){const S=m[R],P=S.getGDALNoData();h[_][R]=S.getGDALMetadata(0),l[_][R]=P;const O=this.sourceInfo_[_].bands;a[_]=O?O.length:S.getSamplesPerPixel();const N=p-(R+1);T||(T=g2(S)),E||(E=_2(S));const V=m2(S,m[0]);C[N]=V[0];const U=[S.getTileWidth(),S.getTileHeight()];U[0]!==U[1]&&U[1]<Hs&&(U[0]=Hs,U[1]=Hs),x[N]=U;const L=V[0]/Math.abs(V[1]);v[N]=[U[0],U[1]/L]}if(t?Ht(t,T,t):t=T,!i)i=E;else{const R=`Origin mismatch for source ${_}, got [${E}] but expected [${i}]`;nr(i,E,0,R,this.viewRejector)}if(!o)o=C,this.resolutionFactors_[_]=1;else{o.length-c>C.length&&(c=o.length-C.length);const R=o[o.length-1]/C[C.length-1];this.resolutionFactors_[_]=R;const S=C.map(O=>O*=R),P=`Resolution mismatch for source ${_}, got [${S}] but expected [${o}]`;nr(o.slice(c,o.length),S,.02,P,this.viewRejector)}n?nr(n.slice(c,n.length),v,.01,`Tile size mismatch for source ${_}`,this.viewRejector):n=v,s?nr(s.slice(c,s.length),x,0,`Tile size mismatch for source ${_}`,this.viewRejector):s=x,this.sourceImagery_[_]=m.reverse(),this.sourceMasks_[_]=y.reverse()}for(let _=0,m=this.sourceImagery_.length;_<m;++_){const y=this.sourceImagery_[_];for(;y.length<o.length;)y.unshift(void 0)}this.getProjection()||this.determineProjection(e),this.samplesPerPixel_=a,this.nodataValues_=l,this.metadata_=h;e:for(let _=0;_<u;++_){if(this.sourceInfo_[_].nodata!==void 0){this.addAlpha_=!0;break}if(this.sourceMasks_[_].length){this.addAlpha_=!0;break}const m=l[_],y=this.sourceInfo_[_].bands;if(y){for(let p=0;p<y.length;++p)if(m[y[p]-1]!==null){this.addAlpha_=!0;break e}continue}for(let p=0;p<m.length;++p)if(m[p]!==null){this.addAlpha_=!0;break e}}let d=this.addAlpha_?1:0;for(let _=0;_<u;++_)d+=a[_];this.bandCount=d;const f=new Zo({extent:t,minZoom:c,origin:i,resolutions:o,tileSizes:n});this.tileGrid=f,this.setTileSizes(s),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");const g=1;o.length===2?o=[o[0],o[1],o[1]/2]:o.length===1&&(o=[o[0]*2,o[0],o[0]/2]),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:o,center:ls(ln(t),this.projection),extent:Wo(t,this.projection),zoom:g})}loadTile_(e,t,i){const n=this.getTileSize(e),s=this.sourceImagery_.length,o=new Array(s*2),a=this.nodataValues_,l=this.sourceInfo_,h=f2();for(let c=0;c<s;++c){const u=l[c],d=this.resolutionFactors_[c],f=[Math.round(t*(n[0]*d)),Math.round(i*(n[1]*d)),Math.round((t+1)*(n[0]*d)),Math.round((i+1)*(n[1]*d))],g=this.sourceImagery_[c][e];let _;u.bands&&(_=u.bands.map(function(E){return E-1}));let m;"nodata"in u&&u.nodata!==null?m=u.nodata:_?m=_.map(function(E){return a[c][E]}):m=a[c];const y={window:f,width:n[0],height:n[1],samples:_,fillValue:m,pool:h,interleave:!1};d2(this.convertToRGB_,g)?o[c]=g.readRGB(y):o[c]=g.readRasters(y);const p=s+c,T=this.sourceMasks_[c][e];if(!T){o[p]=Promise.resolve(null);continue}o[p]=T.readRasters({window:f,width:n[0],height:n[1],samples:[0],pool:h,interleave:!1})}return Promise.all(o).then(this.composeTile_.bind(this,n)).catch(function(c){throw Ja(c),c})}composeTile_(e,t){const i=this.metadata_,n=this.sourceInfo_,s=this.sourceImagery_.length,o=this.bandCount,a=this.samplesPerPixel_,l=this.nodataValues_,h=this.normalize_,c=this.addAlpha_,u=e[0]*e[1],d=u*o;let f;h?f=new Uint8Array(d):f=new Float32Array(d);let g=0;for(let _=0;_<u;++_){let m=c;for(let y=0;y<s;++y){const p=n[y];let T=p.min,E=p.max,x,v;if(h){const C=i[y][0];T===void 0&&(C&&vl in C?T=parseFloat(C[vl]):T=T2(t[y][0])),E===void 0&&(C&&xl in C?E=parseFloat(C[xl]):E=x2(t[y][0])),x=255/(E-T),v=-T*x}for(let C=0;C<a[y];++C){const R=t[y][C][_];let S;if(h?S=Je(x*R+v,0,255):S=R,!c)f[g]=S;else{let P=p.nodata;if(P===void 0){let N;p.bands?N=p.bands[C]-1:N=C,P=l[y][N]}const O=isNaN(P);(!O&&R!==P||O&&!isNaN(R))&&(m=!1,f[g]=S)}g++}if(!m){const C=s+y,R=t[C];R&&!R[0][_]&&(m=!0)}}c&&(m||(f[g]=255),g++)}return f}}const vt={ANIMATING:0,INTERACTING:1},w2='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class C2 extends Ju{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[w2];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",n=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,opaque:e.opaque!==void 0?e.opaque:!0,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:n,wrapX:e.wrapX,zDirection:e.zDirection})}}const Ue={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Wc extends ci{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const t=Object.assign({},e);typeof e.properties=="object"&&(delete t.properties,Object.assign(t,e.properties)),t[Ue.OPACITY]=e.opacity!==void 0?e.opacity:1,Xe(typeof t[Ue.OPACITY]=="number","Layer opacity must be a number"),t[Ue.VISIBLE]=e.visible!==void 0?e.visible:!0,t[Ue.Z_INDEX]=e.zIndex,t[Ue.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,t[Ue.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,t[Ue.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,t[Ue.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=t.className!==void 0?t.className:"ol-layer",delete t.className,this.setProperties(t),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const t=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return t.opacity=Je(Math.round(this.getOpacity()*100)/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=i===void 0&&!t.managed?1/0:i,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t,t}getLayersArray(e){return Oe()}getLayerStatesArray(e){return Oe()}getExtent(){return this.get(Ue.EXTENT)}getMaxResolution(){return this.get(Ue.MAX_RESOLUTION)}getMinResolution(){return this.get(Ue.MIN_RESOLUTION)}getMinZoom(){return this.get(Ue.MIN_ZOOM)}getMaxZoom(){return this.get(Ue.MAX_ZOOM)}getOpacity(){return this.get(Ue.OPACITY)}getSourceState(){return Oe()}getVisible(){return this.get(Ue.VISIBLE)}getZIndex(){return this.get(Ue.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Ue.EXTENT,e)}setMaxResolution(e){this.set(Ue.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Ue.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Ue.MAX_ZOOM,e)}setMinZoom(e){this.set(Ue.MIN_ZOOM,e)}setOpacity(e){Xe(typeof e=="number","Layer opacity must be a number"),this.set(Ue.OPACITY,e)}setVisible(e){this.set(Ue.VISIBLE,e)}setZIndex(e){this.set(Ue.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const gt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},Yt={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function wl(r,e,t){return function(i,n,s,o,a){if(!i)return;if(!n&&!e)return i;const l=e?0:s[0]*n,h=e?0:s[1]*n,c=a?a[0]:0,u=a?a[1]:0;let d=r[0]+l/2+c,f=r[2]-l/2+c,g=r[1]+h/2+u,_=r[3]-h/2+u;d>f&&(d=(f+d)/2,f=d),g>_&&(g=(_+g)/2,_=g);let m=Je(i[0],d,f),y=Je(i[1],g,_);if(o&&t&&n){const p=30*n;m+=-p*Math.log(1+Math.max(0,d-i[0])/p)+p*Math.log(1+Math.max(0,i[0]-f)/p),y+=-p*Math.log(1+Math.max(0,g-i[1])/p)+p*Math.log(1+Math.max(0,i[1]-_)/p)}return[m,y]}}function R2(r){return r}function Ta(r,e,t,i){const n=Ye(e)/t[0],s=Bt(e)/t[1];return i?Math.min(r,Math.max(n,s)):Math.min(r,Math.min(n,s))}function xa(r,e,t){let i=Math.min(r,e);const n=50;return i*=Math.log(1+n*Math.max(0,r/e-1))/n+1,t&&(i=Math.max(i,t),i/=Math.log(1+n*Math.max(0,t/r-1))/n+1),Je(i,t/2,e*2)}function b2(r,e,t,i){return e=e!==void 0?e:!0,function(n,s,o,a){if(n!==void 0){const l=r[0],h=r[r.length-1],c=t?Ta(l,t,o,i):l;if(a)return e?xa(n,c,h):Je(n,h,c);const u=Math.min(c,n),d=Math.floor(ko(r,u,s));return r[d]>c&&d<r.length-1?r[d+1]:r[d]}}}function I2(r,e,t,i,n,s){return i=i!==void 0?i:!0,t=t!==void 0?t:0,function(o,a,l,h){if(o!==void 0){const c=n?Ta(e,n,l,s):e;if(h)return i?xa(o,c,t):Je(o,t,c);const u=1e-9,d=Math.ceil(Math.log(e/c)/Math.log(r)-u),f=-a*(.5-u)+.5,g=Math.min(c,o),_=Math.floor(Math.log(e/g)/Math.log(r)+f),m=Math.max(d,_),y=e/Math.pow(r,m);return Je(y,t,c)}}}function Cl(r,e,t,i,n){return t=t!==void 0?t:!0,function(s,o,a,l){if(s!==void 0){const h=i?Ta(r,i,a,n):r;return!t||!l?Je(s,e,h):xa(s,h,e)}}}function va(r){if(r!==void 0)return 0}function Rl(r){if(r!==void 0)return r}function S2(r){const e=2*Math.PI/r;return function(t,i){if(i)return t;if(t!==void 0)return t=Math.floor(t/e+.5)*e,t}}function A2(r){const e=Qr(5);return function(t,i){return i||t===void 0?t:Math.abs(t)<=e?0:t}}const qs=0;class ni extends ci{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Vo(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Ru(),e.center&&(e.center=mi(e.center,this.projection_)),e.extent&&(e.extent=en(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const t=Object.assign({},e);for(const a in Yt)delete t[a];this.setProperties(t,!0);const i=D2(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const n=L2(e),s=i.constraint,o=M2(e);this.constraints_={center:n,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let t=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const n=e||[0,0,0,0];t=t||[0,0,0,0];const s=this.getResolution(),o=s/2*(n[3]-t[3]+t[1]-n[1]),a=s/2*(n[0]-t[0]+t[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const t=this.getProperties();return t.resolution!==void 0?t.resolution=this.getResolution():t.zoom=this.getZoom(),t.center=this.getCenterInternal(),t.rotation=this.getRotation(),Object.assign({},t,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const t=new Array(arguments.length);for(let i=0;i<t.length;++i){let n=arguments[i];n.center&&(n=Object.assign({},n),n.center=mi(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=mi(n.anchor,this.getProjection())),t[i]=n}this.animateInternal.apply(this,t)}animateInternal(e){let t=arguments.length,i;t>1&&typeof arguments[t-1]=="function"&&(i=arguments[t-1],--t);let n=0;for(;n<t&&!this.isDef();++n){const c=arguments[n];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(n===t){i&&Yr(i,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;n<t;++n){const c=arguments[n],u={start:s,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||$1,callback:i};if(c.center&&(u.sourceCenter=o,u.targetCenter=c.center.slice(),o=u.targetCenter),c.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(c.zoom),a=u.targetResolution):c.resolution&&(u.sourceResolution=a,u.targetResolution=c.resolution,a=u.targetResolution),c.rotation!==void 0){u.sourceRotation=l;const d=Ln(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}P2(u)?u.complete=!0:s+=u.duration,h.push(u)}this.animations_.push(h),this.setHint(vt.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[vt.ANIMATING]>0}getInteracting(){return this.hints_[vt.INTERACTING]>0}cancelAnimations(){this.setHint(vt.ANIMATING,-this.hints_[vt.ANIMATING]);let e;for(let t=0,i=this.animations_.length;t<i;++t){const n=this.animations_[t];if(n[0].callback&&Yr(n[0].callback,!1),!e)for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let t=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let s=!0;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(l.complete)continue;const h=e-l.start;let c=l.duration>0?h/l.duration:1;c>=1?(l.complete=!0,c=1):s=!1;const u=l.easing(c);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],g=l.targetCenter[0],_=l.targetCenter[1];this.nextCenter_=l.targetCenter;const m=d+u*(g-d),y=f+u*(_-f);this.targetCenter_=[m,y]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?Ln(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),t=!0,!l.complete)break}if(s){this.animations_[i]=null,this.setHint(vt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=n[0].callback;o&&Yr(o,!0)}}this.animations_=this.animations_.filter(Boolean),t&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,t){let i;const n=this.getCenterInternal();return n!==void 0&&(i=[n[0]-t[0],n[1]-t[1]],Bo(i,e-this.getRotation()),xu(i,t)),i}calculateCenterZoom(e,t){let i;const n=this.getCenterInternal(),s=this.getResolution();if(n!==void 0&&s!==void 0){const o=t[0]-e*(t[0]-n[0])/s,a=t[1]-e*(t[1]-n[1])/s;i=[o,a]}return i}getViewportSize_(e){const t=this.viewportSize_;if(e){const i=t[0],n=t[1];return[Math.abs(i*Math.cos(e))+Math.abs(n*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(n*Math.cos(e))]}return t}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&ls(e,this.getProjection())}getCenterInternal(){return this.get(Yt.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const t=this.calculateExtentInternal(e);return Wo(t,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const t=this.getCenterInternal();Xe(t,"The view center is not defined");const i=this.getResolution();Xe(i!==void 0,"The view resolution is not defined");const n=this.getRotation();return Xe(n!==void 0,"The view rotation is not defined"),_o(t,i,n,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(Yt.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,t){return this.getResolutionForExtentInternal(en(e,this.getProjection()),t)}getResolutionForExtentInternal(e,t){t=t||this.getViewportSizeMinusPadding_();const i=Ye(e)/t[0],n=Bt(e)/t[1];return Math.max(i,n)}getResolutionForValueFunction(e){e=e||2;const t=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(t/i)/Math.log(e);return function(s){return t/Math.pow(e,s*n)}}getRotation(){return this.get(Yt.ROTATION)}getValueForResolutionFunction(e){const t=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/t;return function(o){return Math.log(i/o)/t/s}}getViewportSizeMinusPadding_(e){let t=this.getViewportSize_(e);const i=this.padding_;return i&&(t=[t[0]-i[1]-i[3],t[1]-i[0]-i[2]]),t}getState(){const e=this.getProjection(),t=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();n=$s(n,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],t,i)}return{center:n.slice(0),projection:e!==void 0?e:null,resolution:t,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const t=this.getResolution();return t!==void 0&&(e=this.getZoomForResolution(t)),e}getZoomForResolution(e){let t=this.minZoom_||0,i,n;if(this.resolutions_){const s=ko(this.resolutions_,e,1);t=s,i=this.resolutions_[s],s==this.resolutions_.length-1?n=2:n=i/this.resolutions_[s+1]}else i=this.maxResolution_,n=this.zoomFactor_;return t+Math.log(i/e)/Math.log(n)}getResolutionForZoom(e){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const t=Je(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[t]/this.resolutions_[t+1];return this.resolutions_[t]/Math.pow(i,Je(e-t,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,t){let i;if(Xe(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Xe(!Ir(e),"Cannot fit empty extent provided as `geometry`");const n=en(e,this.getProjection());i=ml(n)}else if(e.getType()==="Circle"){const n=en(e.getExtent(),this.getProjection());i=ml(n),i.rotate(this.getRotation(),ln(n))}else i=e;this.fitInternal(i,t)}rotatedExtentForGeometry(e){const t=this.getRotation(),i=Math.cos(t),n=Math.sin(-t),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,h=-1/0,c=-1/0;for(let u=0,d=s.length;u<d;u+=o){const f=s[u]*i-s[u+1]*n,g=s[u]*n+s[u+1]*i;a=Math.min(a,f),l=Math.min(l,g),h=Math.max(h,f),c=Math.max(c,g)}return[a,l,h,c]}fitInternal(e,t){t=t||{};let i=t.size;i||(i=this.getViewportSizeMinusPadding_());const n=t.padding!==void 0?t.padding:[0,0,0,0],s=t.nearest!==void 0?t.nearest:!1;let o;t.minResolution!==void 0?o=t.minResolution:t.maxZoom!==void 0?o=this.getResolutionForZoom(t.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const h=this.getRotation(),c=Math.sin(h),u=Math.cos(h),d=ln(a);d[0]+=(n[1]-n[3])/2*l,d[1]+=(n[0]-n[2])/2*l;const f=d[0]*u-d[1]*c,g=d[1]*u+d[0]*c,_=this.getConstrainedCenter([f,g],l),m=t.callback?t.callback:is;t.duration!==void 0?this.animateInternal({resolution:l,center:_,duration:t.duration,easing:t.easing},m):(this.targetResolution_=l,this.targetCenter_=_,this.applyTargetState_(!1,!0),Yr(m,!0))}centerOn(e,t,i){this.centerOnInternal(mi(e,this.getProjection()),t,i)}centerOnInternal(e,t,i){this.setCenterInternal($s(e,t,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,t,i,n){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=$s(e,n,[a[0]/2+o[3],a[1]/2+o[0]],t,i);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const t=ls(this.targetCenter_,this.getProjection());this.setCenter([t[0]+e[0],t[1]+e[1]])}adjustCenterInternal(e){const t=this.targetCenter_;this.setCenterInternal([t[0]+e[0],t[1]+e[1]])}adjustResolution(e,t){t=t&&mi(t,this.getProjection()),this.adjustResolutionInternal(e,t)}adjustResolutionInternal(e,t){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,n,i);t&&(this.targetCenter_=this.calculateCenterZoom(s,t)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,t){this.adjustResolution(Math.pow(this.zoomFactor_,-e),t)}adjustRotation(e,t){t&&(t=mi(t,this.getProjection())),this.adjustRotationInternal(e,t)}adjustRotationInternal(e,t){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+e,i);t&&(this.targetCenter_=this.calculateCenterRotate(n,t)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&mi(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,t){return this.hints_[e]+=t,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,t){const i=this.getAnimating()||this.getInteracting()||t,n=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,s,i),a=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,n,s));this.get(Yt.ROTATION)!==n&&this.set(Yt.ROTATION,n),this.get(Yt.RESOLUTION)!==o&&(this.set(Yt.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Yt.CENTER)||!os(this.get(Yt.CENTER),a))&&this.set(Yt.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,t,i){e=e!==void 0?e:200;const n=t||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,n,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!os(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:Vn,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(vt.INTERACTING,1)}endInteraction(e,t,i){i=i&&mi(i,this.getProjection()),this.endInteractionInternal(e,t,i)}endInteractionInternal(e,t,i){this.getInteracting()&&(this.setHint(vt.INTERACTING,-1),this.resolveConstraints(e,t,i))}getConstrainedCenter(e,t){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,t||this.getResolution(),i)}getConstrainedZoom(e,t){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,t))}getConstrainedResolution(e,t){t=t||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,t,i)}}function Yr(r,e){setTimeout(function(){r(e)},0)}function L2(r){if(r.extent!==void 0){const t=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return wl(r.extent,r.constrainOnlyCenter,t)}const e=Vo(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,wl(t,!1,!1)}return R2}function D2(r){let e,t,i,o=r.minZoom!==void 0?r.minZoom:qs,a=r.maxZoom!==void 0?r.maxZoom:28;const l=r.zoomFactor!==void 0?r.zoomFactor:2,h=r.multiWorld!==void 0?r.multiWorld:!1,c=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,u=r.showFullExtent!==void 0?r.showFullExtent:!1,d=Vo(r.projection,"EPSG:3857"),f=d.getExtent();let g=r.constrainOnlyCenter,_=r.extent;if(!h&&!_&&d.isGlobal()&&(g=!1,_=f),r.resolutions!==void 0){const m=r.resolutions;t=m[o],i=m[a]!==void 0?m[a]:m[m.length-1],r.constrainResolution?e=b2(m,c,!g&&_,u):e=Cl(t,i,c,!g&&_,u)}else{const y=(f?Math.max(Ye(f),Bt(f)):360*Uo.degrees/d.getMetersPerUnit())/Ho/Math.pow(2,qs),p=y/Math.pow(2,28-qs);t=r.maxResolution,t!==void 0?o=0:t=y/Math.pow(l,o),i=r.minResolution,i===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?i=t/Math.pow(l,a):i=y/Math.pow(l,a):i=p),a=o+Math.floor(Math.log(t/i)/Math.log(l)),i=t/Math.pow(l,a-o),r.constrainResolution?e=I2(l,t,i,c,!g&&_,u):e=Cl(t,i,c,!g&&_,u)}return{constraint:e,maxResolution:t,minResolution:i,minZoom:o,zoomFactor:l}}function M2(r){if(r.enableRotation!==void 0?r.enableRotation:!0){const t=r.constrainRotation;return t===void 0||t===!0?A2():t===!1?Rl:typeof t=="number"?S2(t):Rl}return va}function P2(r){return!(r.sourceCenter&&r.targetCenter&&!os(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function $s(r,e,t,i,n){const s=Math.cos(-n);let o=Math.sin(-n),a=r[0]*s-r[1]*o,l=r[1]*s+r[0]*o;a+=(e[0]/2-t[0])*i,l+=(t[1]-e[1]/2)*i,o=-o;const h=a*s-l*o,c=l*s+a*o;return[h,c]}class Ds extends Wc{constructor(e){const t=Object.assign({},e);delete t.source,super(t),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Ue.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Ue.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(He(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=ze(e,de.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let t;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof ni?t={viewState:e.getState(),extent:e.calculateExtent()}:t=e,!t.layerStatesArray&&i&&(t.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let n;t.layerStatesArray?n=t.layerStatesArray.find(o=>o.layer===this):n=this.getLayerState();const s=this.getExtent();return wa(n,t.viewState)&&(!s||zt(s,t.extent))}getAttributions(e){if(!this.isVisible(e))return[];let t;const i=this.getSource();if(i&&(t=i.getAttributions()),!t)return[];const n=e instanceof ni?e.getViewStateAndExtent():e;let s=t(n);return Array.isArray(s)||(s=[s]),s}render(e,t){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,t)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,t){}renderDeferred(e){const t=this.getRenderer();t&&t.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Ue.MAP,e)}getMapInternal(){return this.get(Ue.MAP)}setMap(e){this.mapPrecomposeKey_&&(He(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(He(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=ze(e,gt.PRECOMPOSE,function(t){const n=t.frameState.layerStatesArray,s=this.getLayerState(!1);Xe(!n.some(function(o){return o.layer===s.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(s)},this),this.mapRenderKey_=ze(this,de.CHANGE,e.render,e),this.changed())}setSource(e){this.set(Ue.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function wa(r,e){if(!r.visible)return!1;const t=e.resolution;if(t<r.minResolution||t>=r.maxResolution)return!1;const i=e.zoom;return i>r.minZoom&&i<=r.maxZoom}class Yc extends Dr{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.declutterExecutorGroup=null}getFeatures(e){return Oe()}getData(e){return null}prepareFrame(e){return Oe()}renderFrame(e,t){return Oe()}loadedTileCallback(e,t,i){e[t]||(e[t]={}),e[t][i.tileCoord.toString()]=i}createLoadedTileFinder(e,t,i){return(n,s)=>{const o=this.loadedTileCallback.bind(this,i,n);return e.forEachLoadedTile(t,n,s,o)}}forEachFeatureAtCoordinate(e,t,i,n,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const t=e.target;(t.getState()===be.LOADED||t.getState()===be.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let t=e.getState();return t!=be.LOADED&&t!=be.ERROR&&e.addEventListener(de.CHANGE,this.boundHandleImageChange_),t==be.IDLE&&(e.load(),t=e.getState()),t==be.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class lr extends wi{constructor(e,t,i,n){super(e),this.inversePixelTransform=t,this.frameState=i,this.context=n}}class Kc{constructor(){Xa(this,"pushMethodArgs_",(...e)=>(this.instructions_[this.zIndex+this.offset_].push(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(CanvasRenderingContext2D.prototype,{get:(e,t)=>{if(typeof po()[t]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t),this.pushMethodArgs_},set:(e,t,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(t,i),!0)})}getContext(){return this.context_}draw(e){this.instructions_.forEach(t=>{for(let i=0,n=t.length;i<n;i+=2){const s=t[i],o=t[i+1];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}var pr={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},Rt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};Rt.max=Rt.whitepoint[2].D65;Rt.rgb=function(r,e){e=e||Rt.whitepoint[2].E;var t=r[0]/e[0],i=r[1]/e[1],n=r[2]/e[2],s,o,a;return s=t*3.240969941904521+i*-1.537383177570093+n*-.498610760293,o=t*-.96924363628087+i*1.87596750150772+n*.041555057407175,a=t*.055630079696993+i*-.20397695888897+n*1.056971514242878,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:s=s*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[s*255,o*255,a*255]};pr.xyz=function(r,e){var t=r[0]/255,i=r[1]/255,n=r[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var s=t*.41239079926595+i*.35758433938387+n*.18048078840183,o=t*.21263900587151+i*.71516867876775+n*.072192315360733,a=t*.019330818715591+i*.11919477979462+n*.95053215224966;return e=e||Rt.whitepoint[2].E,[s*e[0],o*e[1],a*e[2]]};var Ca={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(r,e,t){var i,n,s,o,a,l,h,c,u,d,f,g,_;if(s=r[0],o=r[1],a=r[2],s===0)return[0,0,0];var m=.0011070564598794539;return e=e||"D65",t=t||2,u=Rt.whitepoint[t][e][0],d=Rt.whitepoint[t][e][1],f=Rt.whitepoint[t][e][2],g=4*u/(u+15*d+3*f),_=9*d/(u+15*d+3*f),i=o/(13*s)+g||0,n=a/(13*s)+_||0,h=s>8?d*Math.pow((s+16)/116,3):d*s*m,l=h*9*i/(4*n)||0,c=h*(12-3*i-20*n)/(4*n)||0,[l,h,c]}};Rt.luv=function(r,e,t){var i,n,s,o,a,l,h,c,u,d,f,g,_,m=.008856451679035631,y=903.2962962962961;e=e||"D65",t=t||2,u=Rt.whitepoint[t][e][0],d=Rt.whitepoint[t][e][1],f=Rt.whitepoint[t][e][2],g=4*u/(u+15*d+3*f),_=9*d/(u+15*d+3*f),l=r[0],h=r[1],c=r[2],i=4*l/(l+15*h+3*c)||0,n=9*h/(l+15*h+3*c)||0;var p=h/d;return s=p<=m?y*p:116*Math.pow(p,1/3)-16,o=13*s*(i-g),a=13*s*(n-_),[s,o,a]};var Hc={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(r){var e=r[0],t=r[1],i=r[2],n,s,o;return o=i/360*2*Math.PI,n=t*Math.cos(o),s=t*Math.sin(o),[e,n,s]},xyz:function(r){return Ca.xyz(Hc.luv(r))}};Ca.lchuv=function(r){var e=r[0],t=r[1],i=r[2],n=Math.sqrt(t*t+i*i),s=Math.atan2(i,t),o=s*360/2/Math.PI;return o<0&&(o+=360),[e,n,o]};Rt.lchuv=function(r){return Ca.lchuv(Rt.luv(r))};const bl={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var Il={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function O2(r){var c,u;var e,t=[],i=1,n;if(typeof r=="number")return{space:"rgb",values:[r>>>16,(r&65280)>>>8,r&255],alpha:1};if(typeof r=="number")return{space:"rgb",values:[r>>>16,(r&65280)>>>8,r&255],alpha:1};if(r=String(r).toLowerCase(),bl[r])t=bl[r].slice(),n="rgb";else if(r==="transparent")i=0,n="rgb",t=[0,0,0];else if(r[0]==="#"){var s=r.slice(1),o=s.length,a=o<=4;i=1,a?(t=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],o===4&&(i=parseInt(s[3]+s[3],16)/255)):(t=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],o===8&&(i=parseInt(s[6]+s[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),n="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(r)){var l=e[1];n=l.replace(/a$/,"");var h=n==="cmyk"?4:n==="gray"?1:3;t=e[2].trim().split(/\s*[,\/]\s*|\s+/),n==="color"&&(n=t.shift()),t=t.map(function(d,f){if(d[d.length-1]==="%")return d=parseFloat(d)/100,f===3?d:n==="rgb"?d*255:n[0]==="h"||n[0]==="l"&&!f?d*100:n==="lab"?d*125:n==="lch"?f<2?d*150:d*360:n[0]==="o"&&!f?d:n==="oklab"?d*.4:n==="oklch"?f<2?d*.4:d*360:d;if(n[f]==="h"||f===2&&n[n.length-1]==="h"){if(Il[d]!==void 0)return Il[d];if(d.endsWith("deg"))return parseFloat(d);if(d.endsWith("turn"))return parseFloat(d)*360;if(d.endsWith("grad"))return parseFloat(d)*360/400;if(d.endsWith("rad"))return parseFloat(d)*180/Math.PI}return d==="none"?0:parseFloat(d)}),i=t.length>h?t.pop():1}else/[0-9](?:\s|\/|,)/.test(r)&&(t=r.match(/([0-9]+)/g).map(function(d){return parseFloat(d)}),n=((u=(c=r.match(/([a-z])/ig))==null?void 0:c.join(""))==null?void 0:u.toLowerCase())||"rgb");return{space:n,values:t,alpha:i}}var Js={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(r){var e=r[0]/360,t=r[1]/100,i=r[2]/100,n,s,o,a,l,h=0;if(t===0)return l=i*255,[l,l,l];for(s=i<.5?i*(1+t):i+t-i*t,n=2*i-s,a=[0,0,0];h<3;)o=e+1/3*-(h-1),o<0?o++:o>1&&o--,l=6*o<1?n+(s-n)*6*o:2*o<1?s:3*o<2?n+(s-n)*(2/3-o)*6:n,a[h++]=l*255;return a}};pr.hsl=function(r){var e=r[0]/255,t=r[1]/255,i=r[2]/255,n=Math.min(e,t,i),s=Math.max(e,t,i),o=s-n,a,l,h;return s===n?a=0:e===s?a=(t-i)/o:t===s?a=2+(i-e)/o:i===s&&(a=4+(e-t)/o),a=Math.min(a*60,360),a<0&&(a+=360),h=(n+s)/2,s===n?l=0:h<=.5?l=o/(s+n):l=o/(2-s-n),[a,l*100,h*100]};function k2(r){Array.isArray(r)&&r.raw&&(r=String.raw(...arguments)),r instanceof Number&&(r=+r);var e,t=O2(r);if(!t.space)return[];const i=t.space[0]==="h"?Js.min:pr.min,n=t.space[0]==="h"?Js.max:pr.max;return e=Array(3),e[0]=Math.min(Math.max(t.values[0],i[0]),n[0]),e[1]=Math.min(Math.max(t.values[1],i[1]),n[1]),e[2]=Math.min(Math.max(t.values[2],i[2]),n[2]),t.space[0]==="h"&&(e=Js.rgb(e)),e.push(Math.min(Math.max(t.alpha,0),1)),e}function F2(r){return typeof r=="string"?r:ba(r)}const N2=1024,$n={};let Qs=0;function G2(r){if(r.length===4)return r;const e=r.slice();return e[3]=1,e}function Sl(r){const e=Rt.lchuv(pr.xyz(r));return e[3]=r[3],e}function U2(r){const e=Rt.rgb(Hc.xyz(r));return e[3]=r[3],e}function Ra(r){if($n.hasOwnProperty(r))return $n[r];if(Qs>=N2){let t=0;for(const i in $n)t++&3||(delete $n[i],--Qs)}const e=k2(r);if(e.length!==4)throw new Error('Failed to parse "'+r+'" as color');for(const t of e)if(isNaN(t))throw new Error('Failed to parse "'+r+'" as color');return Zc(e),$n[r]=e,++Qs,e}function hn(r){return Array.isArray(r)?r:Ra(r)}function Zc(r){return r[0]=Je(r[0]+.5|0,0,255),r[1]=Je(r[1]+.5|0,0,255),r[2]=Je(r[2]+.5|0,0,255),r[3]=Je(r[3],0,1),r}function ba(r){let e=r[0];e!=(e|0)&&(e=e+.5|0);let t=r[1];t!=(t|0)&&(t=t+.5|0);let i=r[2];i!=(i|0)&&(i=i+.5|0);const n=r[3]===void 0?1:Math.round(r[3]*1e3)/1e3;return"rgba("+e+","+t+","+i+","+n+")"}function z2(r){try{return Ra(r),!0}catch{return!1}}const Al=[];let xn=null;function B2(){xn=ht(1,1,void 0,{willReadFrequently:!0})}class X2 extends Yc{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Gt(),this.pixelTransform=Gt(),this.inversePixelTransform=Gt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(e,t,i){xn||B2(),xn.clearRect(0,0,1,1);let n;try{xn.drawImage(e,t,i,1,1,0,0,1,1),n=xn.getImageData(0,0,1,1).data}catch{return xn=null,null}return n}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,t,i){const n=this.getLayer().getClassName();let s,o;if(e&&e.className===n&&(!i||e&&e.style.backgroundColor&&Hi(hn(e.style.backgroundColor),hn(i)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===t?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=document.createElement("div"),s.className=n;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=ht();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,t,i){const n=Xn(i),s=Rs(i),o=Cs(i),a=ws(i);yt(t.coordinateToPixelTransform,n),yt(t.coordinateToPixelTransform,s),yt(t.coordinateToPixelTransform,o),yt(t.coordinateToPixelTransform,a);const l=this.inversePixelTransform;yt(l,n),yt(l,s),yt(l,o),yt(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(n[0]),Math.round(n[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}dispatchRenderEvent_(e,t,i){const n=this.getLayer();if(n.hasListener(e)){const s=new lr(e,this.inversePixelTransform,i,t);n.dispatchEvent(s)}}preRender(e,t){this.frameState=t,!t.declutter&&this.dispatchRenderEvent_(gt.PRERENDER,e,t)}postRender(e,t){t.declutter||this.dispatchRenderEvent_(gt.POSTRENDER,e,t)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new Kc),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(gt.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(gt.POSTRENDER,this.context,e))}getRenderTransform(e,t,i,n,s,o,a){const l=s/2,h=o/2,c=n/t,u=-c,d=-e[0]+a,f=-e[1];return Ci(this.tempTransform,l,h,c,u,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const Kr={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class V2 extends Ds{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getPreload(){return this.get(Kr.PRELOAD)}setPreload(e){this.set(Kr.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(Kr.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(Kr.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}const fs=1/0;class j2{constructor(e,t){this.priorityFunction_=e,this.keyFunction_=t,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,cn(this.queuedElements_)}dequeue(){const e=this.elements_,t=this.priorities_,i=e[0];e.length==1?(e.length=0,t.length=0):(e[0]=e.pop(),t[0]=t.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(e){Xe(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const t=this.priorityFunction_(e);return t!=fs?(this.elements_.push(e),this.priorities_.push(t),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const t=this.elements_,i=this.priorities_,n=t.length,s=t[e],o=i[e],a=e;for(;e<n>>1;){const l=this.getLeftChildIndex_(e),h=this.getRightChildIndex_(e),c=h<n&&i[h]<i[l]?h:l;t[e]=t[c],i[e]=i[c],e=c}t[e]=s,i[e]=o,this.siftDown_(a,e)}siftDown_(e,t){const i=this.elements_,n=this.priorities_,s=i[t],o=n[t];for(;t>e;){const a=this.getParentIndex_(t);if(n[a]>o)i[t]=i[a],n[t]=n[a],t=a;else break}i[t]=s,n[t]=o}reprioritize(){const e=this.priorityFunction_,t=this.elements_,i=this.priorities_;let n=0;const s=t.length;let o,a,l;for(a=0;a<s;++a)o=t[a],l=e(o),l==fs?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=l,t[n++]=o);t.length=n,i.length=n,this.heapify_()}}class W2 extends j2{constructor(e,t){super(function(i){return e.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const t=super.enqueue(e);return t&&e[0].addEventListener(de.CHANGE,this.boundHandleTileChange_),t}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const t=e.target,i=t.getState();if(i===H.LOADED||i===H.ERROR||i===H.EMPTY){i!==H.ERROR&&t.removeEventListener(de.CHANGE,this.boundHandleTileChange_);const n=t.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,t){let i=0,n,s,o;for(;this.tilesLoading_<e&&i<t&&this.getCount()>0;)s=this.dequeue()[0],o=s.getKey(),n=s.getState(),n===H.IDLE&&!(o in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[o]=!0,++this.tilesLoading_,++i,s.load())}}function Y2(r,e,t,i,n){if(!r||!(t in r.wantedTiles)||!r.wantedTiles[t][e.getKey()])return fs;const s=r.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}class Ms{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=_t(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Ms({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Oe()}getImage(e){return Oe()}getHitDetectionImage(){return Oe()}getPixelRatio(e){return 1}getImageState(){return Oe()}getImageSize(){return Oe()}getOrigin(){return Oe()}getSize(){return Oe()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=_t(e)}listenImageChange(e){Oe()}load(){Oe()}unlistenImageChange(e){Oe()}ready(){return Promise.resolve()}}class K2{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const t in this.cache_){const i=this.cache_[t];!(e++&3)&&!i.hasListener()&&(delete this.cache_[t],delete this.patternCache_[t],--this.cacheSize_)}}}get(e,t,i){const n=eo(e,t,i);return n in this.cache_?this.cache_[n]:null}getPattern(e,t,i){const n=eo(e,t,i);return n in this.patternCache_?this.patternCache_[n]:null}set(e,t,i,n,s){const o=eo(e,t,i),a=o in this.cache_;this.cache_[o]=n,s&&(n.getImageState()===be.IDLE&&n.load(),n.getImageState()===be.LOADING?n.ready().then(()=>{this.patternCache_[o]=po().createPattern(n.getImage(1),"repeat")}):this.patternCache_[o]=po().createPattern(n.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function eo(r,e,t){const i=t?hn(t):"null";return e+":"+r+":"+i}const oi=new K2;let Jn=null;class H2 extends Ar{constructor(e,t,i,n,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=s,this.imageState_=n===void 0?be.IDLE:n,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=t,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===be.LOADED){Jn||(Jn=ht(1,1,void 0,{willReadFrequently:!0})),Jn.drawImage(this.image_,0,0);try{Jn.getImageData(0,0,1,1),this.tainted_=!1}catch{Jn=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(de.CHANGE)}handleImageError_(){this.imageState_=be.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=be.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],t=this.size_[1],i=ht(e,t);i.fillRect(0,0,e,t),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===be.IDLE){this.image_||this.initializeImage_(),this.imageState_=be.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&au(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==be.LOADED)return;const t=this.image_,i=document.createElement("canvas");i.width=Math.ceil(t.width*e),i.height=Math.ceil(t.height*e);const n=i.getContext("2d");n.scale(e,e),n.drawImage(t,0,0),n.globalCompositeOperation="multiply",n.fillStyle=F2(this.color_),n.fillRect(0,0,i.width/e,i.height/e),n.globalCompositeOperation="destination-in",n.drawImage(t,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{this.imageState_===be.LOADED||this.imageState_===be.ERROR?e():this.addEventListener(de.CHANGE,function t(){(this.imageState_===be.LOADED||this.imageState_===be.ERROR)&&(this.removeEventListener(de.CHANGE,t),e())})})),this.ready_}}function Ia(r,e,t,i,n,s){let o=e===void 0?void 0:oi.get(e,t,n);return o||(o=new H2(r,r instanceof HTMLImageElement?r.src||void 0:e,t,i,n),oi.set(e,t,n,o,s)),s&&o&&!oi.getPattern(e,t,n)&&oi.set(e,t,n,o,s),o}function ai(r){return r?Array.isArray(r)?ba(r):typeof r=="object"&&"src"in r?Z2(r):r:null}function Z2(r){if(!r.offset||!r.size)return oi.getPattern(r.src,"anonymous",r.color);const e=r.src+":"+r.offset,t=oi.getPattern(e,void 0,r.color);if(t)return t;const i=oi.get(r.src,"anonymous",null);if(i.getImageState()!==be.LOADED)return null;const n=ht(r.size[0],r.size[1]);return n.drawImage(i.getImage(1),r.offset[0],r.offset[1],r.size[0],r.size[1],0,0,r.size[0],r.size[1]),Ia(n.canvas,e,void 0,be.LOADED,r.color,!0),oi.getPattern(e,void 0,r.color)}const Hr="ol-hidden",Ps="ol-unselectable",Sa="ol-control",Ll="ol-collapsed",q2=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Dl=["style","variant","weight","size","lineHeight","family"],qc=function(r){const e=r.match(q2);if(!e)return null;const t={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,n=Dl.length;i<n;++i){const s=e[i+1];s!==void 0&&(t[Dl[i]]=s)}return t.families=t.family.split(/,\s?/),t},$c="10px sans-serif",Ot="#000",zn="round",Ti=[],xi=0,Bn="round",yr=10,Er="#000",Tr="center",gs="middle",nn=[0,0,0,0],xr=1,pi=new ci;let vn=null,bo;const Io={},$2=function(){const e="32px ",t=["monospace","serif"],i=t.length,n="wmytzilWMYTZIL@#/&?$%10";let s,o;function a(h,c,u){let d=!0;for(let f=0;f<i;++f){const g=t[f];if(o=_s(h+" "+c+" "+e+g,n),u!=g){const _=_s(h+" "+c+" "+e+u+","+g,n);d=d&&_!=o}}return!!d}function l(){let h=!0;const c=pi.getKeys();for(let u=0,d=c.length;u<d;++u){const f=c[u];pi.get(f)<100&&(a.apply(this,f.split(`
`))?(cn(Io),vn=null,bo=void 0,pi.set(f,100)):(pi.set(f,pi.get(f)+1,!0),h=!1))}h&&(clearInterval(s),s=void 0)}return function(h){const c=qc(h);if(!c)return;const u=c.families;for(let d=0,f=u.length;d<f;++d){const g=u[d],_=c.style+`
`+c.weight+`
`+g;pi.get(_)===void 0&&(pi.set(_,100,!0),a(c.style,c.weight,g)||(pi.set(_,0,!0),s===void 0&&(s=setInterval(l,32))))}}}(),J2=function(){let r;return function(e){let t=Io[e];if(t==null){if($h){const i=qc(e),n=Jc(e,"Žg");t=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else r||(r=document.createElement("div"),r.innerHTML="M",r.style.minHeight="0",r.style.maxHeight="none",r.style.height="auto",r.style.padding="0",r.style.border="none",r.style.position="absolute",r.style.display="block",r.style.left="-99999px"),r.style.font=e,document.body.appendChild(r),t=r.offsetHeight,document.body.removeChild(r);Io[e]=t}return t}}();function Jc(r,e){return vn||(vn=ht(1,1)),r!=bo&&(vn.font=r,bo=vn.font),vn.measureText(e)}function _s(r,e){return Jc(r,e).width}function Ml(r,e,t){if(e in t)return t[e];const i=e.split(`
`).reduce((n,s)=>Math.max(n,_s(r,s)),0);return t[e]=i,i}function Q2(r,e){const t=[],i=[],n=[];let s=0,o=0,a=0,l=0;for(let h=0,c=e.length;h<=c;h+=2){const u=e[h];if(u===`
`||h===c){s=Math.max(s,o),n.push(o),o=0,a+=l;continue}const d=e[h+1]||r.font,f=_s(d,u);t.push(f),o+=f;const g=J2(d);i.push(g),l=Math.max(l,g)}return{width:s,height:a,widths:t,heights:i,lineWidths:n}}function e0(r,e,t,i,n,s,o,a,l,h,c){r.save(),t!==1&&(r.globalAlpha===void 0?r.globalAlpha=u=>u.globalAlpha*=t:r.globalAlpha*=t),e&&r.transform.apply(r,e),i.contextInstructions?(r.translate(l,h),r.scale(c[0],c[1]),t0(i,r)):c[0]<0||c[1]<0?(r.translate(l,h),r.scale(c[0],c[1]),r.drawImage(i,n,s,o,a,0,0,o,a)):r.drawImage(i,n,s,o,a,l,h,o*c[0],a*c[1]),r.restore()}function t0(r,e){const t=r.contextInstructions;for(let i=0,n=t.length;i<n;i+=2)Array.isArray(t[i+1])?e[t[i]].apply(e,t[i+1]):e[t[i]]=t[i+1]}class Os extends Ms{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius_=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?be.LOADING:be.LOADED,this.imageState_===be.LOADING&&this.ready().then(()=>this.imageState_=be.LOADED),this.render()}clone(){const e=this.getScale(),t=new Os({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}getAnchor(){const e=this.size_,t=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-t[0]/i[0],e[1]/2+t[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){let t=this.canvases_[e];if(!t){const i=this.renderOptions_,n=ht(i.size*e,i.size*e);this.draw_(i,n,e),t=n.canvas,this.canvases_[e]=t}return t}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,t,i){if(t===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return t;let n=this.radius_,s=this.radius2_===void 0?n:this.radius2_;if(n<s){const v=n;n=s,s=v}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),h=Math.sqrt(s*s-l*l),c=n-h,u=Math.sqrt(l*l+c*c),d=u/l;if(e==="miter"&&d<=i)return d*t;const f=t/2/d,g=t/2*(c/u),m=Math.sqrt((n+f)*(n+f)+g*g)-n;if(this.radius2_===void 0||e==="bevel")return m*2;const y=n*Math.sin(a),p=Math.sqrt(n*n-y*y),T=s-p,x=Math.sqrt(y*y+T*T)/y;if(x<=i){const v=x*t/2-s-n;return 2*Math.max(m,v)}return m*2}createRenderOptions(){let e=zn,t=Bn,i=0,n=null,s=0,o,a=0;this.stroke_&&(o=ai(this.stroke_.getColor()??Er),a=this.stroke_.getWidth()??xr,n=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,t=this.stroke_.getLineJoin()??Bn,e=this.stroke_.getLineCap()??zn,i=this.stroke_.getMiterLimit()??yr);const l=this.calculateLineJoinSize_(t,a,i),h=Math.max(this.radius_,this.radius2_||0),c=Math.ceil(2*h+l);return{strokeStyle:o,strokeWidth:a,size:c,lineCap:e,lineDash:n,lineDashOffset:s,lineJoin:t,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,t,i){if(t.scale(i,i),t.translate(e.size/2,e.size/2),this.createPath_(t),this.fill_){let n=this.fill_.getColor();n===null&&(n=Ot),t.fillStyle=ai(n),t.fill()}e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}createHitDetectionCanvas_(e){let t;if(this.fill_){let i=this.fill_.getColor(),n=0;typeof i=="string"&&(i=hn(i)),i===null?n=1:Array.isArray(i)&&(n=i.length===4?i[3]:1),n===0&&(t=ht(e.size,e.size),this.drawHitDetectionCanvas_(e,t))}return t?t.canvas:this.getImage(1)}createPath_(e){let t=this.points_;const i=this.radius_;if(t===1/0)e.arc(0,0,i,0,2*Math.PI);else{const n=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(t*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/t;for(let a=0;a<t;a++){const l=s+a*o,h=a%2===0?i:n;e.lineTo(h*Math.cos(l),h*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,t){t.translate(e.size/2,e.size/2),this.createPath_(t),t.fillStyle=Ot,t.fill(),e.strokeStyle&&(t.strokeStyle=e.strokeStyle,t.lineWidth=e.strokeWidth,e.lineDash&&(t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset),t.lineJoin=e.lineJoin,t.miterLimit=e.miterLimit,t.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Pr extends Os{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),t=new Pr({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return t.setOpacity(this.getOpacity()),t}setRadius(e){this.radius_=e,this.render()}}class Wi{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Wi({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const t=Ia(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));t.ready().then(()=>{this.patternImage_=null}),t.getImageState()===be.IDLE&&t.load(),t.getImageState()===be.LOADING&&(this.patternImage_=t)}this.color_=e}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class Xi{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Xi({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class Wt{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=Pl,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Wt({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(t){return t.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=Pl,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function i0(r){let e;if(typeof r=="function")e=r;else{let t;Array.isArray(r)?t=r:(Xe(typeof r.getZIndex=="function","Expected an `Style` or an array of `Style`"),t=[r]),e=function(){return t}}return e}let to=null;function n0(r,e){if(!to){const t=new Wi({color:"rgba(255,255,255,0.4)"}),i=new Xi({color:"#3399CC",width:1.25});to=[new Wt({image:new Pr({fill:t,stroke:i,radius:5}),fill:t,stroke:i})]}return to}function r0(){const r={},e=[255,255,255,1],t=[0,153,255,1],i=3;return r.Polygon=[new Wt({fill:new Wi({color:[255,255,255,.5]})})],r.MultiPolygon=r.Polygon,r.LineString=[new Wt({stroke:new Xi({color:e,width:i+2})}),new Wt({stroke:new Xi({color:t,width:i})})],r.MultiLineString=r.LineString,r.Circle=r.Polygon.concat(r.LineString),r.Point=[new Wt({image:new Pr({radius:i*2,fill:new Wi({color:t}),stroke:new Xi({color:e,width:i/2})}),zIndex:1/0})],r.MultiPoint=r.Point,r.GeometryCollection=r.Polygon.concat(r.LineString,r.Point),r}function Pl(r){return r.getGeometry()}function Ol(r,e,t,i){return t!==void 0&&i!==void 0?[t/r,i/e]:t!==void 0?t/r:i!==void 0?i/e:1}class ks extends Ms{constructor(e){e=e||{};const t=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,n=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:t,rotation:i,scale:n,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;Xe(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||Ne(o)),Xe(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Xe(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=be.IDLE:o!==void 0&&(o instanceof HTMLImageElement?o.complete?l=o.src?be.LOADED:be.IDLE:l=be.LOADING:l=be.LOADED),this.color_=e.color!==void 0?hn(e.color):null,this.iconImage_=Ia(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,e.width!==void 0||e.height!==void 0){let h,c;if(e.size)[h,c]=e.size;else{const u=this.getImage(1);if(u.width&&u.height)h=u.width,c=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(Ol(f[0],f[1],e.width,e.height))};this.listenImageChange(d);return}}h!==void 0&&this.setScale(Ol(h,c,e.width,e.height))}}clone(){let e,t,i;return this.initialOptions_?(t=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new ks({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:t,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const n=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!n)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=n[0]),this.anchorYUnits_=="fraction"&&(e[1]*=n[1])}if(this.anchorOrigin_!="top-left"){if(!n)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+n[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+n[1])}this.normalizedAnchor_=e}const t=this.getDisplacement(),i=this.getScaleArray();return[e[0]-t[0]/i[0],e[1]+t[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const t=this.getSize(),i=this.iconImage_.getSize();if(!t||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-t[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-t[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==be.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==be.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(de.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(de.CHANGE,e)}ready(){return this.iconImage_.ready()}}const s0="#333";class Aa{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=_t(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Wi({color:s0}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Aa({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=_t(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}let Yn=0;const un=0,qe=1<<Yn++,se=1<<Yn++,Dt=1<<Yn++,lt=1<<Yn++,hi=1<<Yn++,Tt=Math.pow(2,Yn)-1,Qc={[qe]:"boolean",[se]:"number",[Dt]:"string",[lt]:"color",[hi]:"number[]"},o0=Object.keys(Qc).map(Number).sort(In);function ct(r){const e=[];for(const t of o0)a0(r,t)&&e.push(Qc[t]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function a0(r,e){return(r&e)===e}function Zt(r,e){return!!(r&e)}function Or(r,e){return r===e}class Fi{constructor(e,t){this.type=e,this.value=t}}class e1{constructor(e,t,...i){this.type=e,this.operator=t,this.args=i}}function La(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function l0(r){switch(r){case"string":return Dt;case"color":return lt;case"number":return se;case"boolean":return qe;case"number[]":return hi;default:throw new Error(`Unrecognized type hint: ${r}`)}}function Be(r,e,t){switch(typeof r){case"boolean":return new Fi(qe,r);case"number":return new Fi(se,r);case"string":{let n=Dt;return z2(r)&&(n|=lt),Or(n&t,un)||(n&=t),new Fi(n,r)}}if(!Array.isArray(r))throw new Error("Expression must be an array or a primitive value");if(r.length===0)throw new Error("Empty expression");if(typeof r[0]=="string")return T0(r,e,t);for(const n of r)if(typeof n!="number")throw new Error("Expected an array of numbers");let i=hi;return(r.length===3||r.length===4)&&(i|=lt),t&&(i&=t),new Fi(i,r)}const A={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},h0={[A.Get]:_e(([r,e])=>e!==void 0?l0(e.value):Tt,Ce(1,2),c0),[A.Var]:_e(([r])=>r.type,Ce(1,1),u0),[A.Id]:_e(se|Dt,Qn,d0),[A.Concat]:_e(Dt,Ce(2,1/0),ke(Tt)),[A.GeometryType]:_e(Dt,Qn,f0),[A.Resolution]:_e(se,Qn),[A.Zoom]:_e(se,Qn),[A.Time]:_e(se,Qn),[A.Any]:_e(qe,Ce(2,1/0),ke(qe)),[A.All]:_e(qe,Ce(2,1/0),ke(qe)),[A.Not]:_e(qe,Ce(1,1),ke(qe)),[A.Equal]:_e(qe,Ce(2,2),ke(Tt),Si),[A.NotEqual]:_e(qe,Ce(2,2),ke(Tt),Si),[A.GreaterThan]:_e(qe,Ce(2,2),ke(Tt),Si),[A.GreaterThanOrEqualTo]:_e(qe,Ce(2,2),ke(Tt),Si),[A.LessThan]:_e(qe,Ce(2,2),ke(Tt),Si),[A.LessThanOrEqualTo]:_e(qe,Ce(2,2),ke(Tt),Si),[A.Multiply]:_e(r=>{let e=se|lt;for(let t=0;t<r.length;t++)e&=r[t].type;return e},Ce(2,1/0),ke(se|lt),Si),[A.Coalesce]:_e(r=>{let e=Tt;for(let t=1;t<r.length;t+=2)e&=r[t].type;return e&=r[r.length-1].type,e},Ce(2,1/0),ke(Tt),Si),[A.Divide]:_e(se,Ce(2,2),ke(se)),[A.Add]:_e(se,Ce(2,1/0),ke(se)),[A.Subtract]:_e(se,Ce(2,2),ke(se)),[A.Clamp]:_e(se,Ce(3,3),ke(se)),[A.Mod]:_e(se,Ce(2,2),ke(se)),[A.Pow]:_e(se,Ce(2,2),ke(se)),[A.Abs]:_e(se,Ce(1,1),ke(se)),[A.Floor]:_e(se,Ce(1,1),ke(se)),[A.Ceil]:_e(se,Ce(1,1),ke(se)),[A.Round]:_e(se,Ce(1,1),ke(se)),[A.Sin]:_e(se,Ce(1,1),ke(se)),[A.Cos]:_e(se,Ce(1,1),ke(se)),[A.Atan]:_e(se,Ce(1,2),ke(se)),[A.Sqrt]:_e(se,Ce(1,1),ke(se)),[A.Match]:_e(r=>{let e=Tt;for(let t=2;t<r.length;t+=2)e&=r[t].type;return e&=r[r.length-1].type,e},Ce(4,1/0),kl,_0),[A.Between]:_e(qe,Ce(3,3),ke(se)),[A.Interpolate]:_e(r=>{let e=lt|se;for(let t=3;t<r.length;t+=2)e&=r[t].type;return e},Ce(6,1/0),kl,m0),[A.Case]:_e(r=>{let e=Tt;for(let t=1;t<r.length;t+=2)e&=r[t].type;return e&=r[r.length-1].type,e},Ce(3,1/0),g0,p0),[A.In]:_e(qe,Ce(2,2),y0),[A.Number]:_e(se,Ce(1,1/0),ke(Tt)),[A.String]:_e(Dt,Ce(1,1/0),ke(Tt)),[A.Array]:_e(r=>r.length===3||r.length===4?hi|lt:hi,Ce(1,1/0),ke(se)),[A.Color]:_e(lt,Ce(1,4),ke(se)),[A.Band]:_e(se,Ce(1,3),ke(se)),[A.Palette]:_e(lt,Ce(2,2),E0),[A.ToString]:_e(Dt,Ce(1,1),ke(qe|se|Dt|lt))};function c0(r,e){const t=Be(r[1],e);if(!(t instanceof Fi))throw new Error("Expected a literal argument for get operation");if(typeof t.value!="string")throw new Error("Expected a string argument for get operation");if(e.properties.add(t.value),r.length===3){const i=Be(r[2],e);return[t,i]}return[t]}function u0(r,e,t,i){const n=r[1];if(typeof n!="string")throw new Error("Expected a string argument for var operation");if(e.variables.add(n),!("variables"in e.style)||e.style.variables[n]===void 0)return[new Fi(Tt,n)];const s=e.style.variables[n],o=Be(s,e);if(o.value=n,i&&!Zt(i,o.type))throw new Error(`The variable ${n} has type ${ct(o.type)} but the following type was expected: ${ct(i)}`);return[o]}function d0(r,e){e.featureId=!0}function f0(r,e){e.geometryType=!0}function Qn(r,e){const t=r[0];if(r.length!==1)throw new Error(`Expected no arguments for ${t} operation`);return[]}function Ce(r,e){return function(t,i){const n=t[0],s=t.length-1;if(r===e){if(s!==r){const o=r===1?"":"s";throw new Error(`Expected ${r} argument${o} for ${n}, got ${s}`)}}else if(s<r||s>e){const o=e===1/0?`${r} or more`:`${r} to ${e}`;throw new Error(`Expected ${o} arguments for ${n}, got ${s}`)}}}function ke(r){return function(e,t){const i=e[0],n=e.length-1,s=new Array(n);for(let o=0;o<n;++o){const a=Be(e[o+1],t);if(!Zt(r,a.type)){const l=ct(r),h=ct(a.type);throw new Error(`Unexpected type for argument ${o} of ${i} operation, got ${l} but expected ${h}`)}a.type&=r,s[o]=a}return s}}function Si(r,e,t){const i=r[0],n=r.length-1;let s=Tt;for(let a=0;a<t.length;++a)s&=t[a].type;if(s===un)throw new Error(`No common type could be found for arguments of ${i} operation`);const o=new Array(n);for(let a=0;a<n;++a)o[a]=Be(r[a+1],e,s);return o}function g0(r,e){const t=r[0],i=r.length-1;if(i%2===0)throw new Error(`An odd amount of arguments was expected for operation ${t}, got ${JSON.stringify(i)} instead`)}function kl(r,e){const t=r[0],i=r.length-1;if(i%2===1)throw new Error(`An even amount of arguments was expected for operation ${t}, got ${JSON.stringify(i)} instead`)}function _0(r,e,t,i){const n=r.length-1;let o=Be(r[1],e).type;const a=Be(r[r.length-1],e);let l=i!==void 0?i&a.type:a.type;const h=new Array(n-2);for(let u=0;u<n-2;u+=2){const d=Be(r[u+2],e),f=Be(r[u+3],e);o&=d.type,l&=f.type,h[u]=d,h[u+1]=f}const c=Dt|se|qe;if(!Zt(c,o))throw new Error(`Expected an input of type ${ct(c)} for the interpolate operation, got ${ct(o)} instead`);if(Or(l,un))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(r));for(let u=0;u<n-2;u+=2){const d=Be(r[u+2],e,o),f=Be(r[u+3],e,l);h[u]=d,h[u+1]=f}return[Be(r[1],e,o),...h,Be(r[r.length-1],e,l)]}function m0(r,e,t,i){const n=r[1];let s;switch(n[0]){case"linear":s=1;break;case"exponential":if(s=n[1],typeof s!="number")throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(s)} instead`);break;default:s=null}if(!s)throw new Error(`Invalid interpolation type: ${JSON.stringify(n)}`);s=Be(s,e);let o=Be(r[2],e);if(!Zt(se,o.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${ct(o.type)} instead`);o=Be(r[2],e,se);const a=new Array(r.length-3);for(let l=0;l<a.length;l+=2){let h=Be(r[l+3],e);if(!Zt(se,h.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${ct(h.type)} at position ${l+2} instead`);let c=Be(r[l+4],e);if(!Zt(se|lt,c.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${ct(c.type)} at position ${l+3} instead`);h=Be(r[l+3],e,se),c=Be(r[l+4],e,se|lt),a[l]=h,a[l+1]=c}return[s,o,...a]}function p0(r,e,t,i){const n=Be(r[r.length-1],e);let s=i!==void 0?i&n.type:n.type;const o=new Array(r.length-1);for(let a=0;a<o.length-1;a+=2){const l=Be(r[a+1],e),h=Be(r[a+2],e);if(!Zt(qe,l.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${ct(l.type)} at position ${a} instead`);s&=h.type,o[a]=l,o[a+1]=h}if(Or(s,un))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(r));for(let a=0;a<o.length-1;a+=2)o[a+1]=Be(r[a+2],e,s);return o[o.length-1]=Be(r[r.length-1],e,s),o}function y0(r,e){let t=r[2];if(!Array.isArray(t))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if(typeof t[0]=="string"){if(t[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(t[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');t=t[1]}let i=Dt|se;const n=new Array(t.length);for(let o=0;o<n.length;o++){const a=Be(t[o],e);i&=a.type,n[o]=a}if(Or(i,un))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(r));return[Be(r[1],e,i),...n]}function E0(r,e){const t=Be(r[1],e,se);if(t.type!==se)throw new Error(`The first argument of palette must be an number, got ${ct(t.type)} instead`);const i=r[2];if(!Array.isArray(i))throw new Error("The second argument of palette must be an array");const n=new Array(i.length);for(let s=0;s<n.length;s++){const o=Be(i[s],e,lt);if(!(o instanceof Fi))throw new Error(`The palette color at index ${s} must be a literal value`);if(!Zt(o.type,lt))throw new Error(`The palette color at index ${s} should be of type color, got ${ct(o.type)} instead`);n[s]=o}return[t,...n]}function _e(r,...e){return function(t,i,n){const s=t[0];let o=[];for(let l=0;l<e.length;l++)o=e[l](t,i,o,n)||o;let a=typeof r=="function"?r(o):r;if(n!==void 0){if(!Zt(a,n))throw new Error(`The following expression was expected to return ${ct(n)}, but returns ${ct(a)} instead: ${JSON.stringify(t)}`);a&=n}if(a===un)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(t)}`);return new e1(a,s,...o)}}function T0(r,e,t){const i=r[0],n=h0[i];if(!n)throw new Error(`Unknown operator: ${i}`);return n(r,e,t)}function Da(r){if(!r)return"";const e=r.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Da(r.getGeometries()[0]);default:return""}}function t1(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ri(r,e,t){const i=Be(r,t);if(!Zt(e,i.type)){const n=ct(e),s=ct(i.type);throw new Error(`Expected expression to be of type ${n}, got ${s}`)}return qt(i)}function qt(r,e){if(r instanceof Fi){if(r.type===lt&&typeof r.value=="string"){const i=Ra(r.value);return function(){return i}}return function(){return r.value}}const t=r.operator;switch(t){case A.Number:case A.String:case A.Coalesce:return x0(r);case A.Get:case A.Var:return v0(r);case A.Id:return i=>i.featureId;case A.GeometryType:return i=>i.geometryType;case A.Concat:{const i=r.args.map(n=>qt(n));return n=>"".concat(...i.map(s=>s(n).toString()))}case A.Resolution:return i=>i.resolution;case A.Any:case A.All:case A.Between:case A.In:case A.Not:return C0(r);case A.Equal:case A.NotEqual:case A.LessThan:case A.LessThanOrEqualTo:case A.GreaterThan:case A.GreaterThanOrEqualTo:return w0(r);case A.Multiply:case A.Divide:case A.Add:case A.Subtract:case A.Clamp:case A.Mod:case A.Pow:case A.Abs:case A.Floor:case A.Ceil:case A.Round:case A.Sin:case A.Cos:case A.Atan:case A.Sqrt:return R0(r);case A.Case:return b0(r);case A.Match:return I0(r);case A.Interpolate:return S0(r);case A.ToString:return A0(r);default:throw new Error(`Unsupported operator ${t}`)}}function x0(r,e){const t=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=qt(r.args[s]);switch(t){case A.Coalesce:return s=>{for(let o=0;o<i;++o){const a=n[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case A.Number:case A.String:return s=>{for(let o=0;o<i;++o){const a=n[o](s);if(typeof a===t)return a}throw new Error(`Expected one of the values to be a ${t}`)};default:throw new Error(`Unsupported assertion operator ${t}`)}}function v0(r,e){const i=r.args[0].value;switch(r.operator){case A.Get:return n=>n.properties[i];case A.Var:return n=>n.variables[i];default:throw new Error(`Unsupported accessor operator ${r.operator}`)}}function w0(r,e){const t=r.operator,i=qt(r.args[0]),n=qt(r.args[1]);switch(t){case A.Equal:return s=>i(s)===n(s);case A.NotEqual:return s=>i(s)!==n(s);case A.LessThan:return s=>i(s)<n(s);case A.LessThanOrEqualTo:return s=>i(s)<=n(s);case A.GreaterThan:return s=>i(s)>n(s);case A.GreaterThanOrEqualTo:return s=>i(s)>=n(s);default:throw new Error(`Unsupported comparison operator ${t}`)}}function C0(r,e){const t=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=qt(r.args[s]);switch(t){case A.Any:return s=>{for(let o=0;o<i;++o)if(n[o](s))return!0;return!1};case A.All:return s=>{for(let o=0;o<i;++o)if(!n[o](s))return!1;return!0};case A.Between:return s=>{const o=n[0](s),a=n[1](s),l=n[2](s);return o>=a&&o<=l};case A.In:return s=>{const o=n[0](s);for(let a=1;a<i;++a)if(o===n[a](s))return!0;return!1};case A.Not:return s=>!n[0](s);default:throw new Error(`Unsupported logical operator ${t}`)}}function R0(r,e){const t=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=qt(r.args[s]);switch(t){case A.Multiply:return s=>{let o=1;for(let a=0;a<i;++a)o*=n[a](s);return o};case A.Divide:return s=>n[0](s)/n[1](s);case A.Add:return s=>{let o=0;for(let a=0;a<i;++a)o+=n[a](s);return o};case A.Subtract:return s=>n[0](s)-n[1](s);case A.Clamp:return s=>{const o=n[0](s),a=n[1](s);if(o<a)return a;const l=n[2](s);return o>l?l:o};case A.Mod:return s=>n[0](s)%n[1](s);case A.Pow:return s=>Math.pow(n[0](s),n[1](s));case A.Abs:return s=>Math.abs(n[0](s));case A.Floor:return s=>Math.floor(n[0](s));case A.Ceil:return s=>Math.ceil(n[0](s));case A.Round:return s=>Math.round(n[0](s));case A.Sin:return s=>Math.sin(n[0](s));case A.Cos:return s=>Math.cos(n[0](s));case A.Atan:return i===2?s=>Math.atan2(n[0](s),n[1](s)):s=>Math.atan(n[0](s));case A.Sqrt:return s=>Math.sqrt(n[0](s));default:throw new Error(`Unsupported numeric operator ${t}`)}}function b0(r,e){const t=r.args.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=qt(r.args[n]);return n=>{for(let s=0;s<t-1;s+=2)if(i[s](n))return i[s+1](n);return i[t-1](n)}}function I0(r,e){const t=r.args.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=qt(r.args[n]);return n=>{const s=i[0](n);for(let o=1;o<t;o+=2)if(s===i[o](n))return i[o+1](n);return i[t-1](n)}}function S0(r,e){const t=r.args.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=qt(r.args[n]);return n=>{const s=i[0](n),o=i[1](n);let a,l;for(let h=2;h<t;h+=2){const c=i[h](n);let u=i[h+1](n);const d=Array.isArray(u);if(d&&(u=G2(u)),c>=o)return h===2?u:d?L0(s,o,a,l,c,u):rr(s,o,a,l,c,u);a=c,l=u}return l}}function A0(r,e){const t=r.operator,i=r.args.length,n=new Array(i);for(let s=0;s<i;++s)n[s]=qt(r.args[s]);switch(t){case A.ToString:return s=>{const o=n[0](s);return r.args[0].type===lt?ba(o):o.toString()};default:throw new Error(`Unsupported convert operator ${t}`)}}function rr(r,e,t,i,n,s){const o=n-t;if(o===0)return i;const a=e-t,l=r===1?a/o:(Math.pow(r,a)-1)/(Math.pow(r,o)-1);return i+l*(s-i)}function L0(r,e,t,i,n,s){if(n-t===0)return i;const a=Sl(i),l=Sl(s);let h=l[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const c=[rr(r,e,t,a[0],n,l[0]),rr(r,e,t,a[1],n,l[1]),a[2]+rr(r,e,t,0,n,h),rr(r,e,t,i[3],n,s[3])];return Zc(U2(c))}function D0(r){return!0}function M0(r){const e=La(),t=P0(r,e),i=t1();return function(n,s){if(i.properties=n.getPropertiesInternal(),i.resolution=s,e.featureId){const o=n.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Da(n.getGeometry())),t(i)}}function Fl(r){const e=La(),t=r.length,i=new Array(t);for(let o=0;o<t;++o)i[o]=So(r[o],e);const n=t1(),s=new Array(t);return function(o,a){if(n.properties=o.getPropertiesInternal(),n.resolution=a,e.featureId){const h=o.getId();h!==void 0?n.featureId=h:n.featureId=null}let l=0;for(let h=0;h<t;++h){const c=i[h](n);c&&(s[l]=c,l+=1)}return s.length=l,s}}function P0(r,e){const t=r.length,i=new Array(t);for(let n=0;n<t;++n){const s=r[n],o="filter"in s?Ri(s.filter,qe,e):D0;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let h=0;h<l;++h)a[h]=So(s.style[h],e)}else a=[So(s.style,e)];i[n]={filter:o,styles:a}}return function(n){const s=[];let o=!1;for(let a=0;a<t;++a){const l=i[a].filter;if(l(n)&&!(r[a].else&&o)){o=!0;for(const h of i[a].styles){const c=h(n);c&&s.push(c)}}}return s}}function So(r,e){const t=vr(r,"",e),i=wr(r,"",e),n=O0(r,e),s=k0(r,e),o=kt(r,"z-index",e);if(!t&&!i&&!n&&!s&&!Fo(r))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(r));const a=new Wt;return function(l){let h=!0;if(t){const c=t(l);c&&(h=!1),a.setFill(c)}if(i){const c=i(l);c&&(h=!1),a.setStroke(c)}if(n){const c=n(l);c&&(h=!1),a.setText(c)}if(s){const c=s(l);c&&(h=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),h?null:a}}function vr(r,e,t){let i;if(e+"fill-pattern-src"in r?i=U0(r,e+"fill-",t):i=Ma(r,e+"fill-color",t),!i)return null;const n=new Wi;return function(s){const o=i(s);return o==="none"?null:(n.setColor(o),n)}}function wr(r,e,t){const i=kt(r,e+"stroke-width",t),n=Ma(r,e+"stroke-color",t);if(!i&&!n)return null;const s=yi(r,e+"stroke-line-cap",t),o=yi(r,e+"stroke-line-join",t),a=i1(r,e+"stroke-line-dash",t),l=kt(r,e+"stroke-line-dash-offset",t),h=kt(r,e+"stroke-miter-limit",t),c=new Xi;return function(u){if(n){const d=n(u);if(d==="none")return null;c.setColor(d)}if(i&&c.setWidth(i(u)),s){const d=s(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(d)}return a&&c.setLineDash(a(u)),l&&c.setLineDashOffset(l(u)),h&&c.setMiterLimit(h(u)),c}}function O0(r,e){const t="text-",i=yi(r,t+"value",e);if(!i)return null;const n=vr(r,t,e),s=vr(r,t+"background-",e),o=wr(r,t,e),a=wr(r,t+"background-",e),l=yi(r,t+"font",e),h=kt(r,t+"max-angle",e),c=kt(r,t+"offset-x",e),u=kt(r,t+"offset-y",e),d=Cr(r,t+"overflow",e),f=yi(r,t+"placement",e),g=kt(r,t+"repeat",e),_=Fs(r,t+"scale",e),m=Cr(r,t+"rotate-with-view",e),y=kt(r,t+"rotation",e),p=yi(r,t+"align",e),T=yi(r,t+"justify",e),E=yi(r,t+"baseline",e),x=i1(r,t+"padding",e),v=Ns(r,t+"declutter-mode"),C=new Aa({declutterMode:v});return function(R){if(C.setText(i(R)),n&&C.setFill(n(R)),s&&C.setBackgroundFill(s(R)),o&&C.setStroke(o(R)),a&&C.setBackgroundStroke(a(R)),l&&C.setFont(l(R)),h&&C.setMaxAngle(h(R)),c&&C.setOffsetX(c(R)),u&&C.setOffsetY(u(R)),d&&C.setOverflow(d(R)),f){const S=f(R);if(S!=="point"&&S!=="line")throw new Error("Expected point or line for text-placement");C.setPlacement(S)}if(g&&C.setRepeat(g(R)),_&&C.setScale(_(R)),m&&C.setRotateWithView(m(R)),y&&C.setRotation(y(R)),p){const S=p(R);if(S!=="left"&&S!=="center"&&S!=="right"&&S!=="end"&&S!=="start")throw new Error("Expected left, right, center, start, or end for text-align");C.setTextAlign(S)}if(T){const S=T(R);if(S!=="left"&&S!=="right"&&S!=="center")throw new Error("Expected left, right, or center for text-justify");C.setJustify(S)}if(E){const S=E(R);if(S!=="bottom"&&S!=="top"&&S!=="middle"&&S!=="alphabetic"&&S!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");C.setTextBaseline(S)}return x&&C.setPadding(x(R)),C}}function k0(r,e){return"icon-src"in r?F0(r,e):"shape-points"in r?N0(r,e):"circle-radius"in r?G0(r,e):null}function F0(r,e){const t="icon-",i=t+"src",n=n1(r[i],i),s=ms(r,t+"anchor",e),o=Fs(r,t+"scale",e),a=kt(r,t+"opacity",e),l=ms(r,t+"displacement",e),h=kt(r,t+"rotation",e),c=Cr(r,t+"rotate-with-view",e),u=Gl(r,t+"anchor-origin"),d=Ul(r,t+"anchor-x-units"),f=Ul(r,t+"anchor-y-units"),g=V0(r,t+"color"),_=B0(r,t+"cross-origin"),m=X0(r,t+"offset"),y=Gl(r,t+"offset-origin"),p=ps(r,t+"width"),T=ps(r,t+"height"),E=z0(r,t+"size"),x=Ns(r,t+"declutter-mode"),v=new ks({src:n,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:_,offset:m,offsetOrigin:y,height:T,width:p,size:E,declutterMode:x});return function(C){return a&&v.setOpacity(a(C)),l&&v.setDisplacement(l(C)),h&&v.setRotation(h(C)),c&&v.setRotateWithView(c(C)),o&&v.setScale(o(C)),s&&v.setAnchor(s(C)),v}}function N0(r,e){const t="shape-",i=t+"points",n=t+"radius",s=Ao(r[i],i),o=Ao(r[n],n),a=vr(r,t,e),l=wr(r,t,e),h=Fs(r,t+"scale",e),c=ms(r,t+"displacement",e),u=kt(r,t+"rotation",e),d=Cr(r,t+"rotate-with-view",e),f=ps(r,t+"radius2"),g=ps(r,t+"angle"),_=Ns(r,t+"declutter-mode"),m=new Os({points:s,radius:o,radius2:f,angle:g,declutterMode:_});return function(y){return a&&m.setFill(a(y)),l&&m.setStroke(l(y)),c&&m.setDisplacement(c(y)),u&&m.setRotation(u(y)),d&&m.setRotateWithView(d(y)),h&&m.setScale(h(y)),m}}function G0(r,e){const t="circle-",i=vr(r,t,e),n=wr(r,t,e),s=kt(r,t+"radius",e),o=Fs(r,t+"scale",e),a=ms(r,t+"displacement",e),l=kt(r,t+"rotation",e),h=Cr(r,t+"rotate-with-view",e),c=Ns(r,t+"declutter-mode"),u=new Pr({radius:5,declutterMode:c});return function(d){return s&&u.setRadius(s(d)),i&&u.setFill(i(d)),n&&u.setStroke(n(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),h&&u.setRotateWithView(h(d)),o&&u.setScale(o(d)),u}}function kt(r,e,t){if(!(e in r))return;const i=Ri(r[e],se,t);return function(n){return Ao(i(n),e)}}function yi(r,e,t){if(!(e in r))return null;const i=Ri(r[e],Dt,t);return function(n){return n1(i(n),e)}}function U0(r,e,t){const i=yi(r,e+"pattern-src",t),n=Nl(r,e+"pattern-offset",t),s=Nl(r,e+"pattern-size",t),o=Ma(r,e+"color",t);return function(a){return{src:i(a),offset:n&&n(a),size:s&&s(a),color:o&&o(a)}}}function Cr(r,e,t){if(!(e in r))return null;const i=Ri(r[e],qe,t);return function(n){const s=i(n);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function Ma(r,e,t){if(!(e in r))return null;const i=Ri(r[e],lt|Dt,t);return function(n){return r1(i(n),e)}}function i1(r,e,t){if(!(e in r))return null;const i=Ri(r[e],hi,t);return function(n){return kr(i(n),e)}}function ms(r,e,t){if(!(e in r))return null;const i=Ri(r[e],hi,t);return function(n){const s=kr(i(n),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function Nl(r,e,t){if(!(e in r))return null;const i=Ri(r[e],hi,t);return function(n){return s1(i(n),e)}}function Fs(r,e,t){if(!(e in r))return null;const i=Ri(r[e],hi|se,t);return function(n){return j0(i(n),e)}}function ps(r,e){const t=r[e];if(t!==void 0){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}}function z0(r,e){const t=r[e];if(t!==void 0){if(typeof t=="number")return _t(t);if(!Array.isArray(t))throw new Error(`Expected a number or size array for ${e}`);if(t.length!==2||typeof t[0]!="number"||typeof t[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return t}}function B0(r,e){const t=r[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}}function Gl(r,e){const t=r[e];if(t!==void 0){if(t!=="bottom-left"&&t!=="bottom-right"&&t!=="top-left"&&t!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return t}}function Ul(r,e){const t=r[e];if(t!==void 0){if(t!=="pixels"&&t!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return t}}function X0(r,e){const t=r[e];if(t!==void 0)return kr(t,e)}function Ns(r,e){const t=r[e];if(t!==void 0){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);if(t!=="declutter"&&t!=="obstacle"&&t!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return t}}function V0(r,e){const t=r[e];if(t!==void 0)return r1(t,e)}function kr(r,e){if(!Array.isArray(r))throw new Error(`Expected an array for ${e}`);const t=r.length;for(let i=0;i<t;++i)if(typeof r[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return r}function n1(r,e){if(typeof r!="string")throw new Error(`Expected a string for ${e}`);return r}function Ao(r,e){if(typeof r!="number")throw new Error(`Expected a number for ${e}`);return r}function r1(r,e){if(typeof r=="string")return r;const t=kr(r,e),i=t.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return t}function s1(r,e){const t=kr(r,e);if(t.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return t}function j0(r,e){return typeof r=="number"?r:s1(r,e)}const zl={RENDER_ORDER:"renderOrder"};class o1 extends Ds{constructor(e){e=e||{};const t=Object.assign({},e);delete t.style,delete t.renderBuffer,delete t.updateWhileAnimating,delete t.updateWhileInteracting,super(t),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(zl.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,t){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new _d(9)),this.getRenderer().renderDeclutter(e,t)}setRenderOrder(e){this.set(zl.RENDER_ORDER,e)}setStyle(e){this.style_=W0(e),this.styleFunction_=e===null?void 0:i0(this.style_),this.changed()}}function W0(r){if(r===void 0)return n0;if(!r)return null;if(typeof r=="function"||r instanceof Wt)return r;if(!Array.isArray(r))return Fl([r]);if(r.length===0)return[];const e=r.length,t=r[0];if(t instanceof Wt){const n=new Array(e);for(let s=0;s<e;++s){const o=r[s];if(!(o instanceof Wt))throw new Error("Expected a list of style instances");n[s]=o}return n}if("style"in t){const n=new Array(e);for(let s=0;s<e;++s){const o=r[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");n[s]=o}return M0(n)}return Fl(r)}class Y0 extends bs{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,t){Oe()}calculateMatrices2D(e){const t=e.viewState,i=e.coordinateToPixelTransform,n=e.pixelToCoordinateTransform;Ci(i,e.size[0]/2,e.size[1]/2,1/t.resolution,-1/t.resolution,-t.rotation,-t.center[0],-t.center[1]),gc(n,i)}forEachFeatureAtCoordinate(e,t,i,n,s,o,a,l){let h;const c=t.viewState;function u(E,x,v,C){return s.call(o,x,E?v:null,C)}const d=c.projection,f=tc(e.slice(),d),g=[[0,0]];if(d.canWrapX()&&n){const E=d.getExtent(),x=Ye(E);g.push([-x,0],[x,0])}const _=t.layerStatesArray,m=_.length,y=[],p=[];for(let E=0;E<g.length;E++)for(let x=m-1;x>=0;--x){const v=_[x],C=v.layer;if(C.hasRenderer()&&wa(v,c)&&a.call(l,C)){const R=C.getRenderer(),S=C.getSource();if(R&&S){const P=S.getWrapX()?f:e,O=u.bind(null,v.managed);p[0]=P[0]+g[E][0],p[1]=P[1]+g[E][1],h=R.forEachFeatureAtCoordinate(p,t,i,O,y)}if(h)return h}}if(y.length===0)return;const T=1/y.length;return y.forEach((E,x)=>E.distanceSq+=x*T),y.sort((E,x)=>E.distanceSq-x.distanceSq),y.some(E=>h=E.callback(E.feature,E.layer,E.geometry)),h}hasFeatureAtCoordinate(e,t,i,n,s,o){return this.forEachFeatureAtCoordinate(e,t,i,n,kn,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){Oe()}scheduleExpireIconCache(e){oi.canExpireCache()&&e.postRenderFunctions.push(K0)}}function K0(r,e){oi.expire()}class H0 extends Y0{constructor(e){super(e),this.fontChangeListenerKey_=ze(pi,fr.PROPERTYCHANGE,e.redrawText.bind(e)),this.element_=document.createElement("div");const t=this.element_.style;t.position="absolute",t.width="100%",t.height="100%",t.zIndex="0",this.element_.className=Ps+" ol-layers";const i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,t){const i=this.getMap();if(i.hasListener(e)){const n=new lr(e,void 0,t);i.dispatchEvent(n)}}disposeInternal(){He(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(gt.PRECOMPOSE,e);const t=e.layerStatesArray.sort(function(a,l){return a.zIndex-l.zIndex});t.some(a=>a.layer instanceof o1&&a.layer.getDeclutter())&&(e.declutter={});const n=e.viewState;this.children_.length=0;const s=[];let o=null;for(let a=0,l=t.length;a<l;++a){const h=t[a];e.layerIndex=a;const c=h.layer,u=c.getSourceState();if(!wa(h,n)||u!="ready"&&u!="undefined"){c.unrender();continue}const d=c.render(e,o);d&&(d!==o&&(this.children_.push(d),o=d),s.push(h))}this.declutter(e,s),ru(this.element_,this.children_),this.dispatchRenderEvent(gt.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,t){for(let i=t.length-1;i>=0;--i){const n=t[i],s=n.layer;s.getDeclutter()&&s.renderDeclutter(e,n)}t.forEach(i=>i.layer.renderDeferred(e))}}class Oi extends wi{constructor(e,t){super(e),this.layer=t}}const io={LAYERS:"layers"};class Kn extends Wc{constructor(e){e=e||{};const t=Object.assign({},e);delete t.layers;let i=e.layers;super(t),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(io.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new si(i.slice(),{unique:!0}):Xe(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new si(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(He),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(ze(e,wt.ADD,this.handleLayersAdd_,this),ze(e,wt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(He);cn(this.listenerKeys_);const t=e.getArray();for(let i=0,n=t.length;i<n;i++){const s=t[i];this.registerLayerListeners_(s),this.dispatchEvent(new Oi("addlayer",s))}this.changed()}registerLayerListeners_(e){const t=[ze(e,fr.PROPERTYCHANGE,this.handleLayerChange_,this),ze(e,de.CHANGE,this.handleLayerChange_,this)];e instanceof Kn&&t.push(ze(e,"addlayer",this.handleLayerGroupAdd_,this),ze(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Ne(e)]=t}handleLayerGroupAdd_(e){this.dispatchEvent(new Oi("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Oi("removelayer",e.layer))}handleLayersAdd_(e){const t=e.element;this.registerLayerListeners_(t),this.dispatchEvent(new Oi("addlayer",t)),this.changed()}handleLayersRemove_(e){const t=e.element,i=Ne(t);this.listenerKeys_[i].forEach(He),delete this.listenerKeys_[i],this.dispatchEvent(new Oi("removelayer",t)),this.changed()}getLayers(){return this.get(io.LAYERS)}setLayers(e){const t=this.getLayers();if(t){const i=t.getArray();for(let n=0,s=i.length;n<s;++n)this.dispatchEvent(new Oi("removelayer",i[n]))}this.set(io.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(e){const t=e!==void 0?e:[],i=t.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(t)});const n=this.getLayerState();let s=n.zIndex;!e&&n.zIndex===void 0&&(s=0);for(let o=i,a=t.length;o<a;o++){const l=t[o];l.opacity*=n.opacity,l.visible=l.visible&&n.visible,l.maxResolution=Math.min(l.maxResolution,n.maxResolution),l.minResolution=Math.max(l.minResolution,n.minResolution),l.minZoom=Math.max(l.minZoom,n.minZoom),l.maxZoom=Math.min(l.maxZoom,n.maxZoom),n.extent!==void 0&&(l.extent!==void 0?l.extent=Ht(l.extent,n.extent):l.extent=n.extent),l.zIndex===void 0&&(l.zIndex=s)}return t}getSourceState(){return"ready"}}class wn extends wi{constructor(e,t,i){super(e),this.map=t,this.frameState=i!==void 0?i:null}}class Mi extends wn{constructor(e,t,i,n,s,o){super(e,t,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=n!==void 0?n:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const $e={SINGLECLICK:"singleclick",CLICK:de.CLICK,DBLCLICK:de.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Lo={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class Z0 extends Ar{constructor(e,t){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=t===void 0?1:t,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=ze(i,Lo.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=ze(i,Lo.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(de.TOUCHMOVE,this.boundHandleTouchMove_,Qh?{passive:!1}:!1)}emulateClick_(e){let t=new Mi($e.CLICK,this.map_,e);this.dispatchEvent(t),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new Mi($e.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new Mi($e.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const t=e,i=t.pointerId;if(t.type==$e.POINTERUP||t.type==$e.POINTERCANCEL){delete this.trackedTouches_[i];for(const n in this.trackedTouches_)if(this.trackedTouches_[n].target!==t.target){delete this.trackedTouches_[n];break}}else(t.type==$e.POINTERDOWN||t.type==$e.POINTERMOVE)&&(this.trackedTouches_[i]=t);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const t=new Mi($e.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(t),this.emulateClicks_&&!t.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(He),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const t=new Mi($e.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(t),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(ze(i,$e.POINTERMOVE,this.handlePointerMove_,this),ze(i,$e.POINTERUP,this.handlePointerUp_,this),ze(this.element_,$e.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(ze(this.element_.getRootNode(),$e.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const t=new Mi($e.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(t)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const t=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new Mi($e.POINTERMOVE,this.map_,e,t))}handleTouchMove_(e){const t=this.originalPointerMoveEvent_;(!t||t.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(He(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(de.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(He(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(He),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Pi={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},xt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};class Pa extends ci{constructor(e){super();const t=e.element;t&&!e.target&&!t.style.pointerEvents&&(t.style.pointerEvents="auto"),this.element=t||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){yo(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&yo(this.element);for(let t=0,i=this.listenerKeys.length;t<i;++t)He(this.listenerKeys[t]);this.listenerKeys.length=0,this.map_=e,e&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==is&&this.listenerKeys.push(ze(e,Pi.POSTRENDER,this.render,this)),e.render())}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class q0 extends Pa{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const t=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",n=e.expandClassName!==void 0?e.expandClassName:t+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"›",o=e.collapseClassName!==void 0?e.collapseClassName:t+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=n):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(de.CLICK,this.handleClick_.bind(this),!1);const h=t+" "+Ps+" "+Sa+(this.collapsed_&&this.collapsible_?" "+Ll:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=h,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const t=Array.from(new Set(this.getMap().getAllLayers().flatMap(n=>n.getAttributions(e)))),i=!this.getMap().getAllLayers().some(n=>n.getSource()&&n.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(i),t}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const t=await Promise.all(this.collectSourceAttributions_(e).map(n=>Kh(()=>n))),i=t.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!Hi(t,this.renderedAttributions_)){nu(this.ulElement_);for(let n=0,s=t.length;n<s;++n){const o=document.createElement("li");o.innerHTML=t[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=t}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Ll),this.collapsed_?Ya(this.collapseLabel_,this.label_):Ya(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class $0 extends Pa{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const t=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"⇧",n=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=t+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(de.CLICK,this.handleClick_.bind(this),!1);const a=t+" "+Ps+" "+Sa,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Hr)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const i=t.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?t.animate({rotation:0,duration:this.duration_,easing:Vn}):t.setRotation(0))}render(e){const t=e.frameState;if(!t)return;const i=t.viewState.rotation;if(i!=this.rotation_){const n="rotate("+i+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Hr);!s&&i===0?this.element.classList.add(Hr):s&&i!==0&&this.element.classList.remove(Hr)}this.label_.style.transform=n}this.rotation_=i}}class J0 extends Pa{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const t=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,n=e.zoomInClassName!==void 0?e.zoomInClassName:t+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:t+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"–",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",h=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=n,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener(de.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=s,u.setAttribute("type","button"),u.title=h,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(de.CLICK,this.handleClick_.bind(this,-i),!1);const d=t+" "+Ps+" "+Sa,f=this.element;f.className=d,f.appendChild(c),f.appendChild(u),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,t){t.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const n=i.getZoom();if(n!==void 0){const s=i.getConstrainedZoom(n+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:s,duration:this.duration_,easing:Vn})):i.setZoom(s)}}}function Q0(r){r=r||{};const e=new si;return(r.zoom!==void 0?r.zoom:!0)&&e.push(new J0(r.zoomOptions)),(r.rotate!==void 0?r.rotate:!0)&&e.push(new $0(r.rotateOptions)),(r.attribution!==void 0?r.attribution:!0)&&e.push(new q0(r.attributionOptions)),e}const Bl={ACTIVE:"active"};class Hn extends ci{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Bl.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Bl.ACTIVE,e)}setMap(e){this.map_=e}}function eg(r,e,t){const i=r.getCenterInternal();if(i){const n=[i[0]+e[0],i[1]+e[1]];r.animateInternal({duration:t!==void 0?t:250,easing:J1,center:r.getConstrainedCenter(n)})}}function Oa(r,e,t,i){const n=r.getZoom();if(n===void 0)return;const s=r.getConstrainedZoom(n+e),o=r.getResolutionForZoom(s);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:o,anchor:t,duration:i!==void 0?i:250,easing:Vn})}class tg extends Hn{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let t=!1;if(e.type==$e.DBLCLICK){const i=e.originalEvent,n=e.map,s=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=n.getView();Oa(a,o,s,this.duration_),i.preventDefault(),t=!0}return!t}}class Fr extends Hn{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==$e.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==$e.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==$e.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,t=this.stopDown(i)}else e.type==$e.POINTERMOVE&&this.handleMoveEvent(e);return!t}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function ka(r){const e=r.length;let t=0,i=0;for(let n=0;n<e;n++)t+=r[n].clientX,i+=r[n].clientY;return{clientX:t/e,clientY:i/e}}function Do(r){const e=arguments;return function(t){let i=!0;for(let n=0,s=e.length;n<s&&(i=i&&e[n](t),!!i);++n);return i}}const ig=function(r){const e=r.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ng=function(r){const e=r.map.getTargetElement(),t=r.map.getOwnerDocument().activeElement;return e.contains(t)},a1=function(r){return r.map.getTargetElement().hasAttribute("tabindex")?ng(r):!0},rg=kn,l1=function(r){const e=r.originalEvent;return e.button==0&&!(iu&&Zh&&e.ctrlKey)},Xl=Sr,sg=function(r){return r.type==$e.SINGLECLICK},h1=function(r){const e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},og=function(r){const e=r.originalEvent;return Zh?e.metaKey:e.ctrlKey},c1=function(r){const e=r.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},u1=function(r){const e=r.originalEvent,t=e.target.tagName;return t!=="INPUT"&&t!=="SELECT"&&t!=="TEXTAREA"&&!e.target.isContentEditable},no=function(r){const e=r.originalEvent;return Xe(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.pointerType=="mouse"},ag=function(r){const e=r.originalEvent;return Xe(e!==void 0,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&e.button===0};class lg extends Fr{constructor(e){super({stopDown:Sr}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const t=e.condition?e.condition:Do(h1,ag);this.condition_=e.onFocusOnly?Do(a1,t):t,this.noKinetic_=!1}handleDragEvent(e){const t=e.map;this.panning_||(this.panning_=!0,t.getView().beginInteraction());const i=this.targetPointers,n=t.getEventPixel(ka(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const s=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],a=e.map.getView();vu(s,a.getResolution()),Bo(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const t=e.map,i=t.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const n=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=t.getPixelFromCoordinateInternal(o),l=t.getCoordinateFromPixelInternal([a[0]-n*Math.cos(s),a[1]-n*Math.sin(s)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Vn})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class hg extends Fr{constructor(e){e=e||{},super({stopDown:Sr}),this.condition_=e.condition?e.condition:ig,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!no(e))return;const t=e.map,i=t.getView();if(i.getConstraints().rotation===va)return;const n=t.getSize(),s=e.pixel,o=Math.atan2(n[1]/2-s[1],s[0]-n[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return no(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return no(e)&&l1(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class cg extends bs{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,t=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(e[0],t[0])+i,n.top=Math.min(e[1],t[1])+i,n.width=Math.abs(t[0]-e[0])+i,n.height=Math.abs(t[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,t){this.startPixel_=e,this.endPixel_=t,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const e=this.startPixel_,t=this.endPixel_,n=[e,[e[0],t[1]],t,[t[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new _r([n])}getGeometry(){return this.geometry_}}const Zr={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ro extends wi{constructor(e,t,i){super(e),this.coordinate=t,this.mapBrowserEvent=i}}class ug extends Fr{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.box_=new cg(e.className||"ol-dragbox"),this.minArea_=e.minArea!==void 0?e.minArea:64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition?e.condition:l1,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(e,t,i){const n=i[0]-t[0],s=i[1]-t[1];return n*n+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new ro(Zr.BOXDRAG,e.coordinate,e))}handleUpEvent(e){this.box_.setMap(null);const t=this.boxEndCondition_(e,this.startPixel_,e.pixel);return t&&this.onBoxEnd(e),this.dispatchEvent(new ro(t?Zr.BOXEND:Zr.BOXCANCEL,e.coordinate,e)),!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ro(Zr.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}}class dg extends ug{constructor(e){e=e||{};const t=e.condition?e.condition:c1;super({condition:t,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let n=this.getGeometry();if(this.out_){const s=i.rotatedExtentForGeometry(n),o=i.getResolutionForExtentInternal(s),a=i.getResolution()/o;n=n.clone(),n.scale(a*a)}i.fitInternal(n,{duration:this.duration_,easing:Vn})}}const $i={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class fg extends Hn{constructor(e){super(),e=e||{},this.defaultCondition_=function(t){return h1(t)&&u1(t)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let t=!1;if(e.type==de.KEYDOWN){const i=e.originalEvent,n=i.key;if(this.condition_(e)&&(n==$i.DOWN||n==$i.LEFT||n==$i.RIGHT||n==$i.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,h=0;n==$i.DOWN?h=-a:n==$i.LEFT?l=-a:n==$i.RIGHT?l=a:h=a;const c=[l,h];Bo(c,o.getRotation()),eg(o,c,this.duration_),i.preventDefault(),t=!0}}return!t}}class gg extends Hn{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(t){return!og(t)&&u1(t)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let t=!1;if(e.type==de.KEYDOWN||e.type==de.KEYPRESS){const i=e.originalEvent,n=i.key;if(this.condition_(e)&&(n==="+"||n==="-")){const s=e.map,o=n==="+"?this.delta_:-this.delta_,a=s.getView();Oa(a,o,void 0,this.duration_),i.preventDefault(),t=!0}}return!t}}class _g{constructor(e,t,i){this.decay_=e,this.minVelocity_=t,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,t){this.points_.push(e,t,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,t=this.points_.length-3;if(this.points_[t+2]<e)return!1;let i=t-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const n=this.points_[t+2]-this.points_[i+2];if(n<1e3/60)return!1;const s=this.points_[t]-this.points_[i],o=this.points_[t+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class mg extends Hn{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const t=e.condition?e.condition:rg;this.condition_=e.onFocusOnly?Do(a1,t):t,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(e){if(!this.condition_(e)||e.type!==de.WHEEL)return!0;const i=e.map,n=e.originalEvent;n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.coordinate);let s;if(e.type==de.WHEEL&&(s=n.deltaY,Q1&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=qh),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(s*=40)),s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const t=e.getView();t.getAnimating()&&t.cancelAnimations();let i=-Je(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),Oa(t,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class pg extends Fr{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Sr),super(t),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let t=0;const i=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),t=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==va&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(ka(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(t,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}class yg extends Fr{constructor(e){e=e||{};const t=e;t.stopDown||(t.stopDown=Sr),super(t),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let t=1;const i=this.targetPointers[0],n=this.targetPointers[1],s=i.clientX-n.clientX,o=i.clientY-n.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(t=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,h=l.getView();t!=1&&(this.lastScaleDelta_=t),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(ka(this.targetPointers))),l.render(),h.adjustResolutionInternal(t,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),n=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0}return!1}}function Eg(r){r=r||{};const e=new si,t=new _g(-.005,.05,100);return(r.altShiftDragRotate!==void 0?r.altShiftDragRotate:!0)&&e.push(new hg),(r.doubleClickZoom!==void 0?r.doubleClickZoom:!0)&&e.push(new tg({delta:r.zoomDelta,duration:r.zoomDuration})),(r.dragPan!==void 0?r.dragPan:!0)&&e.push(new lg({onFocusOnly:r.onFocusOnly,kinetic:t})),(r.pinchRotate!==void 0?r.pinchRotate:!0)&&e.push(new pg),(r.pinchZoom!==void 0?r.pinchZoom:!0)&&e.push(new yg({duration:r.zoomDuration})),(r.keyboard!==void 0?r.keyboard:!0)&&(e.push(new fg),e.push(new gg({delta:r.zoomDelta,duration:r.zoomDuration}))),(r.mouseWheelZoom!==void 0?r.mouseWheelZoom:!0)&&e.push(new mg({onFocusOnly:r.onFocusOnly,duration:r.zoomDuration})),(r.shiftDragZoom!==void 0?r.shiftDragZoom:!0)&&e.push(new dg({duration:r.zoomDuration})),e}function d1(r){if(r instanceof Ds){r.setMapInternal(null);return}r instanceof Kn&&r.getLayers().forEach(d1)}function f1(r,e){if(r instanceof Ds){r.setMapInternal(e);return}if(r instanceof Kn){const t=r.getLayers().getArray();for(let i=0,n=t.length;i<n;++i)f1(t[i],e)}}let Tg=class extends ci{constructor(e){super(),e=e||{},this.on,this.once,this.un;const t=xg(e);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:qh,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Gt(),this.pixelToCoordinateTransform_=Gt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=t.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=t.controls||Q0(),this.interactions=t.interactions||Eg({onFocusOnly:!0}),this.overlays_=t.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new W2(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(xt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(xt.VIEW,this.handleViewChanged_),this.addChangeListener(xt.SIZE,this.handleSizeChanged_),this.addChangeListener(xt.TARGET,this.handleTargetChanged_),this.setProperties(t.values);const i=this;e.view&&!(e.view instanceof ni)&&e.view.then(function(n){i.setView(new ni(n))}),this.controls.addEventListener(wt.ADD,n=>{n.element.setMap(this)}),this.controls.addEventListener(wt.REMOVE,n=>{n.element.setMap(null)}),this.interactions.addEventListener(wt.ADD,n=>{n.element.setMap(this)}),this.interactions.addEventListener(wt.REMOVE,n=>{n.element.setMap(null)}),this.overlays_.addEventListener(wt.ADD,n=>{this.addOverlayInternal_(n.element)}),this.overlays_.addEventListener(wt.REMOVE,n=>{const s=n.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],n.element.setMap(null)}),this.controls.forEach(n=>{n.setMap(this)}),this.interactions.forEach(n=>{n.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){f1(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const t=e.getId();t!==void 0&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,t,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const s=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:kn,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,s,a,t,null,o,null)}getFeaturesAtPixel(e,t){const i=[];return this.forEachFeatureAtPixel(e,function(n){i.push(n)},t),i}getAllLayers(){const e=[];function t(i){i.forEach(function(n){n instanceof Kn?t(n.getLayers()):e.push(n)})}return t(this.getLayers()),e}hasFeatureAtPixel(e,t){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);t=t!==void 0?t:{};const n=t.layerFilter!==void 0?t.layerFilter:kn,s=t.hitTolerance!==void 0?t.hitTolerance:0,o=t.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,n,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),n=this.getSize(),s=i.width/n[0],o=i.height/n[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/s,(a.clientY-i.top)/o]}getTarget(){return this.get(xt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return ls(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const t=this.frameState_;return t?yt(t.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const t=this.overlayIdIndex_[e.toString()];return t!==void 0?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(xt.LAYERGROUP)}setLayers(e){const t=this.getLayerGroup();if(e instanceof si){t.setLayers(e);return}const i=t.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const n=e[t];if(!n.visible)continue;const s=n.layer.getRenderer();if(s&&!s.ready)return!0;const o=n.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const t=mi(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(e){const t=this.frameState_;return t?yt(t.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(xt.SIZE)}getView(){return this.get(xt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,t,i,n){return Y2(this.frameState_,e,t,i,n)}handleBrowserEvent(e,t){t=t||e.type;const i=new Mi(t,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const t=e.originalEvent,i=t.type;if(i===Lo.POINTERDOWN||i===de.WHEEL||i===de.KEYDOWN){const n=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():n,o=t.target;if(this.overlayContainerStopEvent_.contains(o)||!(s===n?n.documentElement:s).contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const n=this.getInteractions().getArray().slice();for(let s=n.length-1;s>=0;s--){const o=n[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){let n=this.maxTilesLoading_,s=n;if(e){const o=e.viewHints;if(o[vt.ANIMATING]||o[vt.INTERACTING]){const a=Date.now()-e.time>8;n=a?0:8,s=a?0:2}}t.getTilesLoading()<n&&(t.reprioritize(),t.loadMoreTiles(n,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_===!0?(this.hasListener(gt.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(gt.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new wn(Pi.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new wn(Pi.LOADSTART,this,e))));const i=this.postRenderFunctions_;for(let n=0,s=i.length;n<s;++n)i[n](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,n=this.targetChangeHandlerKeys_.length;i<n;++i)He(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(de.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(de.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,yo(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),t=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=t,!t)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new H0(this)),this.mapBrowserEventHandler_=new Z0(this,this.moveTolerance_);for(const s in $e)this.mapBrowserEventHandler_.addEventListener($e[s],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(de.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(de.WHEEL,this.boundHandleBrowserEvent_,Qh?{passive:!1}:!1);const i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.targetChangeHandlerKeys_=[ze(i,de.KEYDOWN,this.handleBrowserEvent,this),ze(i,de.KEYPRESS,this.handleBrowserEvent,this)];const n=t.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(t)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(He(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(He(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=ze(e,fr.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=ze(e,de.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(He),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Oi("addlayer",e)),this.layerGroupPropertyListenerKeys_=[ze(e,fr.PROPERTYCHANGE,this.render,this),ze(e,de.CHANGE,this.render,this),ze(e,"addlayer",this.handleLayerAdd_,this),ze(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const e=this.getLayerGroup().getLayerStatesArray();for(let t=0,i=e.length;t<i;++t){const n=e[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){d1(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const t=this.getSize(),i=this.getView(),n=this.frameState_;let s=null;if(t!==void 0&&ol(t)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:_o(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:Ne(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=_o(a.nextCenter,a.nextResolution,l,t)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),n&&(!this.previousExtent_||!Ir(this.previousExtent_)&&!Wa(s.extent,this.previousExtent_))&&(this.dispatchEvent(new wn(Pi.MOVESTART,this,n)),this.previousExtent_=vs(this.previousExtent_)),this.previousExtent_&&!s.viewHints[vt.ANIMATING]&&!s.viewHints[vt.INTERACTING]&&!Wa(s.extent,this.previousExtent_)&&(this.dispatchEvent(new wn(Pi.MOVEEND,this,s)),Xh(s.extent,this.previousExtent_))),this.dispatchEvent(new wn(Pi.POSTRENDER,this,s)),this.renderComplete_=this.hasListener(Pi.LOADSTART)||this.hasListener(Pi.LOADEND)||this.hasListener(gt.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const t=this.getLayerGroup();t&&this.handleLayerRemove_(new Oi("removelayer",t)),this.set(xt.LAYERGROUP,e)}setSize(e){this.set(xt.SIZE,e)}setTarget(e){this.set(xt.TARGET,e)}setView(e){if(!e||e instanceof ni){this.set(xt.VIEW,e);return}this.set(xt.VIEW,new ni);const t=this;e.then(function(i){t.setView(new ni(i))})}updateSize(){const e=this.getTargetElement();let t;if(e){const n=getComputedStyle(e),s=e.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),o=e.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(s)&&!isNaN(o)&&(t=[s,o],!ol(t)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&ic("No map visible because the map container's width or height are 0."))}const i=this.getSize();t&&(!i||!Hi(t,i))&&(this.setSize(t),this.updateViewportSize_(t))}updateViewportSize_(e){const t=this.getView();t&&t.setViewportSize(e)}};function xg(r){let e=null;r.keyboardEventTarget!==void 0&&(e=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);const t={},i=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new Kn({layers:r.layers});t[xt.LAYERGROUP]=i,t[xt.TARGET]=r.target,t[xt.VIEW]=r.view instanceof ni?r.view:new ni;let n;r.controls!==void 0&&(Array.isArray(r.controls)?n=new si(r.controls.slice()):(Xe(typeof r.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),n=r.controls));let s;r.interactions!==void 0&&(Array.isArray(r.interactions)?s=new si(r.interactions.slice()):(Xe(typeof r.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=r.interactions));let o;return r.overlays!==void 0?Array.isArray(r.overlays)?o=new si(r.overlays.slice()):(Xe(typeof r.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=r.overlays):o=new si,{controls:n,interactions:s,keyboardEventTarget:e,overlays:o,values:t}}class vg extends Ar{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter_=e.gutter||0,this.helper_=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(de.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===H.LOADED,this.loaded)this.uploadTile();else{if(e instanceof Go){const t=e.getImage();t instanceof Image&&!t.crossOrigin&&(t.crossOrigin="anonymous")}e.addEventListener(de.CHANGE,this.handleTileChange_)}}uploadTile(){Oe()}setReady(){this.ready=!0,this.dispatchEvent(de.CHANGE)}handleTileChange_(){this.tile.getState()===H.LOADED&&(this.loaded=!0,this.uploadTile())}disposeInternal(){this.tile.removeEventListener(de.CHANGE,this.handleTileChange_)}}const Fa=34962,Na=34963,wg=35040,Ga=35044,Cg=35048,Rg=5121,bg=5123,Ig=5125,g1=5126,Vl=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function Sg(r,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!tu},e);const t=Vl.length;for(let i=0;i<t;++i)try{const n=r.getContext(Vl[i],e);if(n)return n}catch{}return null}const Ag={STATIC_DRAW:Ga,STREAM_DRAW:wg,DYNAMIC_DRAW:Cg};class _1{constructor(e,t){this.array_=null,this.type_=e,Xe(e===Fa||e===Na,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=t!==void 0?t:Ag.STATIC_DRAW}ofSize(e){return this.array_=new(so(this.type_))(e),this}fromArray(e){return this.array_=so(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(so(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function so(r){switch(r){case Fa:return Float32Array;case Na:return Uint32Array;default:return Float32Array}}function m1(r,e,t){const i=t?r.LINEAR:r.NEAREST;r.bindTexture(r.TEXTURE_2D,e),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,i)}function Lg(r,e,t,i){m1(r,e,i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)}function jl(r,e,t,i,n,s){const o=r.getGL();let a,l;t instanceof Float32Array?(a=o.FLOAT,r.getExtension("OES_texture_float"),l=r.getExtension("OES_texture_float_linear")!==null):(a=o.UNSIGNED_BYTE,l=!0),m1(o,e,s&&l);const h=t.byteLength/i[1];let c=1;h%8===0?c=8:h%4===0?c=4:h%2===0&&(c=2);let u;switch(n){case 1:{u=o.LUMINANCE;break}case 2:{u=o.LUMINANCE_ALPHA;break}case 3:{u=o.RGB;break}case 4:{u=o.RGBA;break}default:throw new Error(`Unsupported number of bands: ${n}`)}const d=o.getParameter(o.UNPACK_ALIGNMENT);o.pixelStorei(o.UNPACK_ALIGNMENT,c),o.texImage2D(o.TEXTURE_2D,0,u,i[0],i[1],0,u,a,t),o.pixelStorei(o.UNPACK_ALIGNMENT,d)}let Cn=null;function Dg(){Cn=ht(1,1,void 0,{willReadFrequently:!0})}class Mg extends vg{constructor(e){super(e),this.textures=[],this.renderSize_=_t(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;const t=new _1(Fa,Ga);t.fromArray([0,1,1,1,1,0,0,0]),this.helper_.flushBufferData(t),this.coords=t,this.setTile(e.tile)}uploadTile(){const e=this.helper_,t=e.getGL(),i=this.tile;this.textures.length=0;let n;i instanceof Go||i instanceof Is?n=i.getImage():n=i.getData();const s=ds(n);if(s){const p=t.createTexture();this.textures.push(p),this.bandCount=4,Lg(t,p,s,i.interpolate),this.setReady();return}n=xo(n);const o=i.getSize(),a=[o[0]+2*this.gutter_,o[1]+2*this.gutter_],l=n instanceof Float32Array,h=a[0]*a[1],c=l?Float32Array:Uint8Array,u=c.BYTES_PER_ELEMENT,d=n.byteLength/a[1];this.bandCount=Math.floor(d/u/a[0]);const f=Math.ceil(this.bandCount/4);if(f===1){const p=t.createTexture();this.textures.push(p),jl(e,p,n,a,this.bandCount,i.interpolate),this.setReady();return}const g=new Array(f);for(let p=0;p<f;++p){const T=t.createTexture();this.textures.push(T);const E=p<f-1?4:(this.bandCount-1)%4+1;g[p]=new c(h*E)}let _=0,m=0;const y=a[0]*this.bandCount;for(let p=0;p<a[1];++p){for(let T=0;T<y;++T){const E=n[m+T],x=Math.floor(_/this.bandCount),v=T%this.bandCount,C=Math.floor(v/4),R=g[C],S=R.length/h,P=v%4;R[x*S+P]=E,++_}m+=d/u}for(let p=0;p<f;++p){const T=this.textures[p],E=g[p],x=E.length/h;jl(e,T,E,a,x,i.interpolate)}this.setReady()}disposeInternal(){const e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(let t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t]);this.tile.removeEventListener(de.CHANGE,this.handleTileChange_)}getImagePixelData_(e,t,i){const n=this.gutter_,s=this.renderSize_[0],o=this.renderSize_[1];Cn||Dg(),Cn.clearRect(0,0,1,1);const a=e.width,l=e.height,h=a-2*n,c=l-2*n,u=n+Math.floor(h*(t/s)),d=n+Math.floor(c*(i/o));let f;try{Cn.drawImage(e,u,d,1,1,0,0,1,1),f=Cn.getImageData(0,0,1,1).data}catch{return Cn=null,null}return f}getArrayPixelData_(e,t,i,n){const s=this.gutter_,o=this.renderSize_[0],a=this.renderSize_[1],l=t[0],h=t[1],c=l+2*s,u=h+2*s,d=s+Math.floor(l*(i/o)),f=s+Math.floor(h*(n/a));if(e instanceof DataView){const _=e.byteLength/(c*u),m=_*(f*c+d),y=e.buffer.slice(m,m+_);return new DataView(y)}const g=this.bandCount*(f*c+d);return e.slice(g,g+this.bandCount)}getPixelData(e,t){if(!this.loaded)return null;if(this.tile instanceof ia){const i=this.tile.getData(),n=xo(i);if(n){const s=this.tile.getSize();return this.getArrayPixelData_(n,s,e,t)}return this.getImagePixelData_(ds(i),e,t)}return this.getImagePixelData_(this.tile.getImage(),e,t)}}const qr={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},Pg=`
  precision mediump float;
  
  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;
  
  uniform vec2 u_screenSize;
   
  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,Og=`
  precision mediump float;
   
  uniform sampler2D u_image;
  uniform float u_opacity;
   
  varying vec2 v_texCoord;
   
  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class Wl{constructor(e){this.gl_=e.webGlContext;const t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer(),this.depthBuffer_=t.createRenderbuffer();const i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,e.vertexShader||Pg),t.compileShader(i);const n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(n,e.fragmentShader||Og),t.compileShader(n),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,i),t.attachShader(this.renderTargetProgram_,n),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array(s),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:t.getUniformLocation(this.renderTargetProgram_,o)})})}getGL(){return this.gl_}init(e){const t=this.getGL(),i=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.bindRenderbuffer(t.RENDERBUFFER,this.getDepthBuffer()),t.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const n=0,s=t.RGBA,o=0,a=t.RGBA,l=t.UNSIGNED_BYTE,h=null;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,n,s,i[0],i[1],o,a,l,h),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i[0],i[1]),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer_)}}apply(e,t,i,n){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,t?t.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!t){const l=Ne(s.canvas);if(!e.renderTargets[l]){const h=s.getContextAttributes();h&&h.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),i&&i(s,e),s.drawArrays(s.TRIANGLES,0,6),n&&n(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const t=this.getGL();let i,n=1;this.uniforms_.forEach(function(s){if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof ImageData)s.texture||(s.texture=t.createTexture()),t.activeTexture(t[`TEXTURE${n}`]),t.bindTexture(t.TEXTURE_2D,s.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,i.width,i.height,0,t.UNSIGNED_BYTE,new Uint8Array(i.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.uniform1i(s.location,n++);else if(Array.isArray(i))switch(i.length){case 2:t.uniform2f(s.location,i[0],i[1]);return;case 3:t.uniform3f(s.location,i[0],i[1],i[2]);return;case 4:t.uniform4f(s.location,i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&t.uniform1f(s.location,i)})}}function p1(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function y1(r,e){return r[0]=e[0],r[1]=e[1],r[4]=e[2],r[5]=e[3],r[12]=e[4],r[13]=e[5],r}const Ai={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},sr={UNSIGNED_BYTE:Rg,UNSIGNED_SHORT:bg,UNSIGNED_INT:Ig,FLOAT:g1},ys={};function Yl(r){return"shared/"+r}let Kl=0;function kg(){const r="unique/"+Kl;return Kl+=1,r}function Fg(r){let e=ys[r];if(!e){const t=document.createElement("canvas");t.width=1,t.height=1,t.style.position="absolute",t.style.left="0",e={users:0,context:Sg(t)},ys[r]=e}return e.users+=1,e.context}function Ng(r){const e=ys[r];if(!e||(e.users-=1,e.users>0))return;const t=e.context,i=t.getExtension("WEBGL_lose_context");i&&i.loseContext();const n=t.canvas;n.width=1,n.height=1,delete ys[r]}class Gg extends bs{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?Yl(e.canvasCacheKey):kg(),this.gl_=Fg(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const t=this.gl_.canvas;t.addEventListener(qr.LOST,this.boundHandleWebGLContextLost_),t.addEventListener(qr.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Gt(),this.offsetScaleMatrix_=Gt(),this.tmpMat4_=p1(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(i=>new Wl({webGlContext:this.gl_,scaleRatio:i.scaleRatio,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:i.uniforms})):[new Wl({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now()}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const t in e)this.uniforms_.push({name:t,value:e[t]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===Yl(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t}bindBuffer(e){const t=this.gl_,i=Ne(e);let n=this.bufferCache_[i];if(!n){const s=t.createBuffer();n={buffer:e,webGlBuffer:s},this.bufferCache_[i]=n}t.bindBuffer(e.getType(),n.webGlBuffer)}flushBufferData(e){const t=this.gl_;this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const t=this.gl_,i=Ne(e),n=this.bufferCache_[i];n&&!t.isContextLost()&&t.deleteBuffer(n.webGlBuffer),delete this.bufferCache_[i]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(qr.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(qr.RESTORED,this.boundHandleWebGLContextRestored_),Ng(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,t,i){const n=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);n.bindTexture(n.TEXTURE_2D,null),n.clearColor(0,0,0,0),n.depthRange(0,1),n.clearDepth(1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,t?n.ZERO:n.ONE_MINUS_SRC_ALPHA),i?(n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL)):n.disable(n.DEPTH_TEST)}bindTexture(e,t,i){const n=this.gl_;n.activeTexture(n.TEXTURE0+t),n.bindTexture(n.TEXTURE_2D,e),n.uniform1i(this.getUniformLocation(i),t)}prepareDrawToRenderTarget(e,t,i,n){const s=this.gl_,o=t.getSize();s.bindFramebuffer(s.FRAMEBUFFER,t.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,t.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,t.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,i?s.ZERO:s.ONE_MINUS_SRC_ALPHA),n?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,t){const i=this.gl_;this.getExtension("OES_element_index_uint");const n=i.UNSIGNED_INT,s=4,o=t-e,a=e*s;i.drawElements(i.TRIANGLES,o,n,a)}finalizeDraw(e,t,i){for(let n=0,s=this.postProcessPasses_.length;n<s;n++)n===s-1?this.postProcessPasses_[n].apply(e,null,t,i):this.postProcessPasses_[n].apply(e,this.postProcessPasses_[n+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const t=e.size,i=e.viewState.rotation,n=e.pixelRatio;this.setUniformFloatValue(Ai.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(Ai.ZOOM,e.viewState.zoom),this.setUniformFloatValue(Ai.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(Ai.PIXEL_RATIO,n),this.setUniformFloatVec2(Ai.VIEWPORT_SIZE_PX,[t[0],t[1]]),this.setUniformFloatValue(Ai.ROTATION,i)}applyHitDetectionUniform(e){const t=this.getUniformLocation(Ai.HIT_DETECTION);this.getGL().uniform1i(t,e?1:0),e&&this.setUniformFloatValue(Ai.PIXEL_RATIO,.5)}applyUniforms(e){const t=this.gl_;let i,n=0;this.uniforms_.forEach(s=>{if(i=typeof s.value=="function"?s.value(e):s.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData||i instanceof WebGLTexture){i instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=i):s.texture||(s.prevValue=void 0,s.texture=t.createTexture()),this.bindTexture(s.texture,n,s.name),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE);const o=!(i instanceof HTMLImageElement)||i.complete;!(i instanceof WebGLTexture)&&o&&s.prevValue!==i&&(s.prevValue=i,t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)),n++}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(s.name,y1(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:t.uniform2f(this.getUniformLocation(s.name),i[0],i[1]);return;case 3:t.uniform3f(this.getUniformLocation(s.name),i[0],i[1],i[2]);return;case 4:t.uniform4f(this.getUniformLocation(s.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&t.uniform1f(this.getUniformLocation(s.name),i)})}useProgram(e,t){this.gl_.useProgram(e),this.currentProgram_=e,this.applyFrameState(t),this.applyUniforms(t)}compileShader(e,t){const i=this.gl_,n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}getProgram(e,t){const i=this.gl_,n=this.compileShader(e,i.FRAGMENT_SHADER),s=this.compileShader(t,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,n),i.attachShader(o,s),i.linkProgram(o),!i.getShaderParameter(n,i.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${i.getShaderInfoLog(n)}`;throw new Error(a)}if(i.deleteShader(n),!i.getShaderParameter(s,i.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}if(i.deleteShader(s),!i.getProgramParameter(o,i.LINK_STATUS)){const a=`GL program linking failed: ${i.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const t=Ne(this.currentProgram_);return this.uniformLocationsByProgram_[t]===void 0&&(this.uniformLocationsByProgram_[t]={}),this.uniformLocationsByProgram_[t][e]===void 0&&(this.uniformLocationsByProgram_[t][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[t][e]}getAttributeLocation(e){const t=Ne(this.currentProgram_);return this.attribLocationsByProgram_[t]===void 0&&(this.attribLocationsByProgram_[t]={}),this.attribLocationsByProgram_[t][e]===void 0&&(this.attribLocationsByProgram_[t][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[t][e]}makeProjectionTransform(e,t){const i=e.size,n=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return Ci(t,0,0,2/(s*i[0]),2/(s*i[1]),-n,-o[0],-o[1]),t}setUniformFloatValue(e,t){this.gl_.uniform1f(this.getUniformLocation(e),t)}setUniformFloatVec2(e,t){this.gl_.uniform2fv(this.getUniformLocation(e),t)}setUniformFloatVec4(e,t){this.gl_.uniform4fv(this.getUniformLocation(e),t)}setUniformMatrixValue(e,t){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}enableAttributeArray_(e,t,i,n,s){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,t,i,!1,n,s))}enableAttributes(e){const t=Ug(e);let i=0;for(let n=0;n<e.length;n++){const s=e[n];this.enableAttributeArray_(s.name,s.size,s.type||g1,t,i),i+=s.size*E1(s.type)}}handleWebGLContextLost(e){cn(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,t,i){const n=this.gl_;i=i||n.createTexture();const s=0,o=n.RGBA,a=0,l=n.RGBA,h=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,i),t?n.texImage2D(n.TEXTURE_2D,s,o,l,h,t):n.texImage2D(n.TEXTURE_2D,s,o,e[0],e[1],a,l,h,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i}}function Ug(r){let e=0;for(let t=0;t<r.length;t++){const i=r[t];e+=i.size*E1(i.type)}return e}function E1(r){switch(r){case sr.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case sr.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case sr.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case sr.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class Ua extends Yc{constructor(e,t){super(e),t=t||{},this.inversePixelTransform_=Gt(),this.pixelContext_=null,this.postProcesses_=t.postProcesses,this.uniforms_=t.uniforms,this.helper,e.addChangeListener(Ue.MAP,this.removeHelper.bind(this)),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,t){const i=this.getLayer();if(i.hasListener(gt.PRECOMPOSE)){const n=new lr(gt.PRECOMPOSE,void 0,t,e);i.dispatchEvent(n)}}dispatchPostComposeEvent(e,t){const i=this.getLayer();if(i.hasListener(gt.POSTCOMPOSE)){const n=new lr(gt.POSTCOMPOSE,void 0,t,e);i.dispatchEvent(n)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let t=!0,i=-1,n;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,h=l.getRenderer();if(!(h instanceof Ua)){t=!0;continue}const c=l.getClassName();if((t||c!==n)&&(i+=1,t=!1),n=c,h===this)break}const s="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new Gg({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),n&&(this.helper.getCanvas().className=n),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}disposeInternal(){this.removeHelper(),super.disposeInternal()}dispatchRenderEvent_(e,t,i){const n=this.getLayer();if(n.hasListener(e)){Ci(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const s=new lr(e,this.inversePixelTransform_,i,t);n.dispatchEvent(s)}}preRender(e,t){this.dispatchRenderEvent_(gt.PRERENDER,e,t)}postRender(e,t){this.dispatchRenderEvent_(gt.POSTRENDER,e,t)}}const zg={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"},Bg={};function Hl(r){return 1/(r+2)}function Xg(){return{tileIds:new Set,representationsByZ:{}}}function Zl(r,e){return r.tileIds.has(Ne(e))}function ql(r,e,t){const i=r.representationsByZ;t in i||(i[t]=new Set),i[t].add(e),r.tileIds.add(Ne(e.tile))}function oo(r,e){const t=r.layerStatesArray[r.layerIndex];t.extent&&(e=Ht(e,en(t.extent,r.viewState.projection)));const i=t.layer.getRenderSource();if(!i.getWrapX()){const n=i.getTileGridForProjection(r.viewState.projection).getExtent();n&&(e=Ht(e,n))}return e}function Mo(r,e){return`${r.getKey()},${ki(e)}`}class Vg extends Ua{constructor(e,t){super(e,{uniforms:t.uniforms,postProcesses:t.postProcesses}),this.renderComplete=!1,this.tileTransform_=Gt(),this.tempMat4=p1(),this.tempTileRange_=new Ko(0,0,0,0),this.tempTileCoord_=hs(0,0,0),this.tempSize_=[0,0];const i=t.cacheSize!==void 0?t.cacheSize:512;this.tileRepresentationCache=new Bh(i),this.frameState=null,this.projection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}isDrawableTile_(e){const t=this.getLayer(),i=e.getState(),n=t.getUseInterimTilesOnError();return i==H.LOADED||i==H.EMPTY||i==H.ERROR&&!n}prepareFrameInternal(e){this.projection_?e.viewState.projection!==this.projection_&&(this.clearCache(),this.projection_=e.viewState.projection):this.projection_=e.viewState.projection;const i=this.getLayer().getRenderSource();return!i||Ir(oo(e,e.extent))?!1:i.getState()==="ready"}createTileRepresentation(e){return Oe()}enqueueTiles(e,t,i,n,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),h=l.getTileGridForProjection(o.projection),c=l.getGutterForProjection(o.projection),u=Ne(l);u in e.wantedTiles||(e.wantedTiles[u]={});const d=e.wantedTiles[u],f=this.tileRepresentationCache,g=a.getMapInternal(),_=Math.max(i-s,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),g?g.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),l.zDirection));for(let m=i;m>=_;--m){const y=h.getTileRangeForExtentAndZ(t,m,this.tempTileRange_),p=h.getResolution(m);for(let T=y.minX;T<=y.maxX;++T)for(let E=y.minY;E<=y.maxY;++E){const x=hs(m,T,E,this.tempTileCoord_),v=Mo(l,x);let C,R;if(f.containsKey(v)&&(C=f.get(v),R=C.tile),(!C||C.tile.key!==l.getKey())&&(R=l.getTile(m,T,E,e.pixelRatio,o.projection)),Zl(n,R))continue;if(!C)C=this.createTileRepresentation({tile:R,grid:h,helper:this.helper,gutter:c}),f.set(v,C);else if(this.isDrawableTile_(R))C.setTile(R);else{const P=R.getInterimTile();C.setTile(P)}ql(n,C,m);const S=R.getKey();d[S]=!0,R.getState()===H.IDLE&&(e.tileQueue.isKeyQueued(S)||e.tileQueue.enqueue([R,u,h.getTileCoordCenter(x),p]))}}}beforeTilesRender(e,t){this.helper.prepareDraw(this.frameState,!t,!0)}beforeTilesMaskRender(e){return!1}renderTile(e,t,i,n,s,o,a,l,h,c,u){}renderTileMask(e,t,i,n){}drawTile_(e,t,i,n,s,o,a){if(!t.ready)return;const h=t.tile.tileCoord,c=ki(h),u=c in o?o[c]:1,d=a.getResolution(i),f=_t(a.getTileSize(i),this.tempSize_),g=a.getOrigin(i),_=a.getTileCoordExtent(h),m=u<1?-1:Hl(i);u<1&&(e.animate=!0);const y=e.viewState,p=y.center[0],T=y.center[1],E=f[0]+2*n,x=f[1]+2*n,v=E/x,C=(p-g[0])/(f[0]*d),R=(g[1]-T)/(f[1]*d),S=y.resolution/d,P=h[1],O=h[2];ed(this.tileTransform_),al(this.tileTransform_,2/(e.size[0]*S/E),-2/(e.size[1]*S/E)),id(this.tileTransform_,y.rotation),al(this.tileTransform_,1,1/v),nd(this.tileTransform_,(f[0]*(P-C)-n)/E,(f[1]*(O-R)-n)/x),this.renderTile(t,this.tileTransform_,e,s,d,f,g,_,m,n,u)}renderFrame(e){this.frameState=e,this.renderComplete=!0;const t=this.helper.getGL();this.preRender(t,e);const i=e.viewState,n=this.getLayer(),s=n.getRenderSource(),o=s.getTileGridForProjection(i.projection),a=s.getGutterForProjection(i.projection),l=oo(e,e.extent),h=o.getZForResolution(i.resolution,s.zDirection),c=Xg(),u=n.getPreload();if(e.nextExtent){const v=o.getZForResolution(i.nextResolution,s.zDirection),C=oo(e,e.nextExtent);this.enqueueTiles(e,C,v,c,u)}this.enqueueTiles(e,l,h,c,0),u>0&&setTimeout(()=>{this.enqueueTiles(e,l,h-1,c,u-1)},0);const d={},f=Ne(this),g=e.time;let _=!1;for(const v of c.representationsByZ[h]){const C=v.tile;if((C instanceof Is||C instanceof na)&&C.getState()===H.EMPTY)continue;const R=C.tileCoord;if(v.ready){const O=C.getAlpha(f,g);if(O===1){C.endTransition(f);continue}_=!0;const N=ki(R);d[N]=O}if(this.renderComplete=!1,this.findAltTiles_(o,R,h+1,c))continue;const P=o.getMinZoom();for(let O=h-1;O>=P&&!this.findAltTiles_(o,R,O,c);--O);}const m=c.representationsByZ,y=Object.keys(m).map(Number).sort(Y1);if(this.beforeTilesMaskRender(e))for(let v=0,C=y.length;v<C;++v){const R=y[v];for(const S of m[R]){const P=S.tile.tileCoord;if(ki(P)in d)continue;const N=o.getTileCoordExtent(P);this.renderTileMask(S,R,N,Hl(R))}}this.beforeTilesRender(e,_);for(let v=0,C=y.length;v<C;++v){const R=y[v];for(const S of m[R]){const P=S.tile.tileCoord;ki(P)in d||this.drawTile_(e,S,R,a,l,d,o)}}for(const v of m[h]){const C=v.tile.tileCoord;ki(C)in d&&this.drawTile_(e,v,h,a,l,d,o)}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const T=this.helper.getCanvas(),E=this.tileRepresentationCache;for(;E.canExpireCache();)E.pop().dispose();const x=function(v,C){s.updateCacheSize(.1,C.viewState.projection),s.expireCache(C.viewState.projection,Bg)};return e.postRenderFunctions.push(x),this.postRender(t,e),T}findAltTiles_(e,t,i,n){const s=e.getTileRangeForTileCoordAndZ(t,i,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileRepresentationCache,l=this.getLayer().getRenderSource();for(let h=s.minX;h<=s.maxX;++h)for(let c=s.minY;c<=s.maxY;++c){const u=Mo(l,[i,h,c]);let d=!1;if(a.containsKey(u)){const f=a.get(u);f.ready&&!Zl(n,f.tile)&&(ql(n,f,i),d=!0)}d||(o=!1)}return o}clearCache(){const e=this.tileRepresentationCache;e.forEach(t=>t.dispose()),e.clear()}removeHelper(){this.helper&&this.clearCache(),super.removeHelper()}disposeInternal(){super.disposeInternal(),delete this.frameState}}const ye={...zg,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},es={TEXTURE_COORD:"a_textureCoord"},jg=[{name:es.TEXTURE_COORD,size:2,type:sr.FLOAT}];class Wg extends Vg{constructor(e,t){super(e,t),this.program_,this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.indices_=new _1(Na,Ga),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=t.paletteTextures||[]}reset(e){super.reset(e),this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))}afterHelperCreated(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}createTileRepresentation(e){return new Mg(e)}beforeTilesRender(e,t){super.beforeTilesRender(e,t),this.helper.useProgram(this.program_,e)}renderTile(e,t,i,n,s,o,a,l,h,c,u){const d=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(jg);let f=0;for(;f<e.textures.length;){const v=`${ye.TILE_TEXTURE_ARRAY}[${f}]`;this.helper.bindTexture(e.textures[f],f,v),++f}for(let v=0;v<this.paletteTextures_.length;++v){const C=this.paletteTextures_[v],R=C.getTexture(d);this.helper.bindTexture(R,f,C.name),++f}const g=i.viewState,_=o[0]+2*c,m=o[1]+2*c,p=e.tile.tileCoord,T=p[1],E=p[2];this.helper.setUniformMatrixValue(ye.TILE_TRANSFORM,y1(this.tempMat4,t)),this.helper.setUniformFloatValue(ye.TRANSITION_ALPHA,u),this.helper.setUniformFloatValue(ye.DEPTH,h);let x=n;c>0&&(x=l,Ht(x,n,x)),this.helper.setUniformFloatVec4(ye.RENDER_EXTENT,x),this.helper.setUniformFloatValue(ye.RESOLUTION,g.resolution),this.helper.setUniformFloatValue(ye.ZOOM,g.zoom),this.helper.setUniformFloatValue(ye.TEXTURE_PIXEL_WIDTH,_),this.helper.setUniformFloatValue(ye.TEXTURE_PIXEL_HEIGHT,m),this.helper.setUniformFloatValue(ye.TEXTURE_RESOLUTION,s),this.helper.setUniformFloatValue(ye.TEXTURE_ORIGIN_X,a[0]+T*o[0]*s-c*s),this.helper.setUniformFloatValue(ye.TEXTURE_ORIGIN_Y,a[1]-E*o[1]*s+c*s),this.helper.drawElements(0,this.indices_.getSize())}getData(e){if(!this.helper.getGL())return null;const i=this.frameState;if(!i)return null;const n=this.getLayer(),s=yt(i.pixelToCoordinateTransform,e.slice()),o=i.viewState,a=n.getExtent();if(a&&!on(en(a,o.projection),s))return null;const l=n.getSources(fo([s]),o.resolution);let h,c,u;for(h=l.length-1;h>=0;--h)if(c=l[h],c.getState()==="ready"){if(u=c.getTileGridForProjection(o.projection),c.getWrapX())break;const f=u.getExtent();if(!f||on(f,s))break}if(h<0)return null;const d=this.tileRepresentationCache;for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const g=u.getTileCoordForCoordAndZ(s,f),_=Mo(c,g);if(!d.containsKey(_))continue;const m=d.get(_),y=m.tile;if((y instanceof Is||y instanceof na)&&y.getState()===H.EMPTY)return null;if(!m.loaded)continue;const p=u.getOrigin(f),T=_t(u.getTileSize(f)),E=u.getResolution(f),x=(s[0]-p[0])/E-g[1]*T[0],v=(p[1]-s[1])/E-g[2]*T[1];return m.getPixelData(x,v)}return null}disposeInternal(){const e=this.helper;e&&(e.getGL().deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)),super.disposeInternal(),delete this.indices_}}class Yg{constructor(e,t){this.name=e,this.data=t,this.texture_=null}getTexture(e){if(!this.texture_){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_}}function Kg(r,e){return`operator_${r}_${Object.keys(e.functions).length}`}function Gs(r){const e=r.toString();return e.includes(".")?e:e+".0"}function T1(r){if(r.length<2||r.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${r.length}(${r.map(Gs).join(", ")})`}function Hg(r){const e=hn(r),t=e.length>3?e[3]:1;return T1([e[0]/255*t,e[1]/255*t,e[2]/255*t,t])}const ao={};let Zg=0;function x1(r){return r in ao||(ao[r]=Zg++),ao[r]}function qg(r){return Gs(x1(r))}function v1(r){return"u_var_"+r}function $g(){return{inFragmentShader:!1,variables:{},properties:{},functions:{},bandCount:0,style:{}}}const lo="getBandValue",w1="u_paletteTextures";function Jg(r,e,t,i){const n=Be(r,t,e);if(Or(n.type,un))throw new Error("No matching type was found");if(!Zt(e,n.type)){const s=ct(e),o=ct(n.type);throw new Error(`Expected expression to be of type ${s}, got ${o}`)}return za(n,e,i)}function Fe(r){return(e,t,i)=>{const n=t.args.length,s=new Array(n);for(let o=0;o<n;++o)s[o]=za(t.args[o],i,e);return r(s,e)}}const Qg={[A.Get]:(r,e)=>{const i=e.args[0].value;return i in r.properties||(r.properties[i]={name:i,type:e.type}),(r.inFragmentShader?"v_prop_":"a_prop_")+i},[A.GeometryType]:(r,e,t)=>{const i="geometryType";return i in r.properties||(r.properties[i]={name:i,type:Dt,evaluator:o=>Da(o.getGeometry())}),(r.inFragmentShader?"v_prop_":"a_prop_")+i},[A.Var]:(r,e)=>{const i=e.args[0].value;return i in r.variables||(r.variables[i]={name:i,type:e.type}),v1(i)},[A.Resolution]:()=>"u_resolution",[A.Zoom]:()=>"u_zoom",[A.Time]:()=>"u_time",[A.Any]:Fe(r=>`(${r.join(" || ")})`),[A.All]:Fe(r=>`(${r.join(" && ")})`),[A.Not]:Fe(([r])=>`(!${r})`),[A.Equal]:Fe(([r,e])=>`(${r} == ${e})`),[A.NotEqual]:Fe(([r,e])=>`(${r} != ${e})`),[A.GreaterThan]:Fe(([r,e])=>`(${r} > ${e})`),[A.GreaterThanOrEqualTo]:Fe(([r,e])=>`(${r} >= ${e})`),[A.LessThan]:Fe(([r,e])=>`(${r} < ${e})`),[A.LessThanOrEqualTo]:Fe(([r,e])=>`(${r} <= ${e})`),[A.Multiply]:Fe(r=>`(${r.join(" * ")})`),[A.Divide]:Fe(([r,e])=>`(${r} / ${e})`),[A.Add]:Fe(r=>`(${r.join(" + ")})`),[A.Subtract]:Fe(([r,e])=>`(${r} - ${e})`),[A.Clamp]:Fe(([r,e,t])=>`clamp(${r}, ${e}, ${t})`),[A.Mod]:Fe(([r,e])=>`mod(${r}, ${e})`),[A.Pow]:Fe(([r,e])=>`pow(${r}, ${e})`),[A.Abs]:Fe(([r])=>`abs(${r})`),[A.Floor]:Fe(([r])=>`floor(${r})`),[A.Ceil]:Fe(([r])=>`ceil(${r})`),[A.Round]:Fe(([r])=>`floor(${r} + 0.5)`),[A.Sin]:Fe(([r])=>`sin(${r})`),[A.Cos]:Fe(([r])=>`cos(${r})`),[A.Atan]:Fe(([r,e])=>e!==void 0?`atan(${r}, ${e})`:`atan(${r})`),[A.Sqrt]:Fe(([r])=>`sqrt(${r})`),[A.Match]:Fe(r=>{const e=r[0],t=r[r.length-1];let i=null;for(let n=r.length-3;n>=1;n-=2){const s=r[n],o=r[n+1];i=`(${e} == ${s} ? ${o} : ${i||t})`}return i}),[A.Between]:Fe(([r,e,t])=>`(${r} >= ${e} && ${r} <= ${t})`),[A.Interpolate]:Fe(([r,e,...t])=>{let i="";for(let n=0;n<t.length-2;n+=2){const s=t[n],o=i||t[n+1],a=t[n+2],l=t[n+3];let h;r===Gs(1)?h=`(${e} - ${s}) / (${a} - ${s})`:h=`(pow(${r}, (${e} - ${s})) - 1.0) / (pow(${r}, (${a} - ${s})) - 1.0)`,i=`mix(${o}, ${l}, clamp(${h}, 0.0, 1.0))`}return i}),[A.Case]:Fe(r=>{const e=r[r.length-1];let t=null;for(let i=r.length-3;i>=0;i-=2){const n=r[i],s=r[i+1];t=`(${n} ? ${s} : ${t||e})`}return t}),[A.In]:Fe(([r,...e],t)=>{const i=Kg("in",t),n=[];for(let s=0;s<e.length;s+=1)n.push(`  if (inputValue == ${e[s]}) { return true; }`);return t.functions[i]=`bool ${i}(float inputValue) {
${n.join(`
`)}
  return false;
}`,`${i}(${r})`}),[A.Array]:Fe(r=>`vec${r.length}(${r.join(", ")})`),[A.Color]:Fe(r=>{if(r.length===1)return`vec4(vec3(${r[0]} / 255.0), 1.0)`;if(r.length===2)return`(${r[1]} * vec4(vec3(${r[0]} / 255.0), 1.0))`;const e=r.slice(0,3).map(i=>`${i} / 255.0`);return r.length===3?`vec4(${e.join(", ")}, 1.0)`:`(${r[3]} * vec4(${e.join(", ")}, 1.0))`}),[A.Band]:Fe(([r,e,t],i)=>{if(!(lo in i.functions)){let n="";const s=i.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const h=`${ye.TILE_TEXTURE_ARRAY}[${a}]`;n+=`  if (band == ${o+1}.0) {
    return texture2D(${h}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}i.functions[lo]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${ye.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${ye.TEXTURE_PIXEL_HEIGHT};
${n}
}`}return`${lo}(${r}, ${e??"0.0"}, ${t??"0.0"})`}),[A.Palette]:(r,e)=>{const[t,...i]=e.args,n=i.length,s=new Uint8Array(n*4);for(let h=0;h<i.length;h++){const c=i[h].value,u=hn(c),d=h*4;s[d]=u[0],s[d+1]=u[1],s[d+2]=u[2],s[d+3]=u[3]*255}r.paletteTextures||(r.paletteTextures=[]);const o=`${w1}[${r.paletteTextures.length}]`,a=new Yg(o,s);r.paletteTextures.push(a);const l=za(t,se,r);return`texture2D(${o}, vec2((${l} + 0.5) / ${n}.0, 0.5))`}};function za(r,e,t){if(r instanceof e1){const i=Qg[r.operator];if(i===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(r.operator)}`);return i(t,r,e)}if((r.type&se)>0)return Gs(r.value);if((r.type&qe)>0)return r.value.toString();if((r.type&Dt)>0)return qg(r.value.toString());if((r.type&lt)>0)return Hg(r.value);if((r.type&hi)>0)return T1(r.value);throw new Error(`Unexpected expression ${r.value} (expected type ${ct(e)})`)}function yn(r,e,t){const i=La();return i.style=r.style,Jg(e,t,i,r)}function $l(r,e){const t=`
    attribute vec2 ${es.TEXTURE_COORD};
    uniform mat4 ${ye.TILE_TRANSFORM};
    uniform float ${ye.TEXTURE_PIXEL_WIDTH};
    uniform float ${ye.TEXTURE_PIXEL_HEIGHT};
    uniform float ${ye.TEXTURE_RESOLUTION};
    uniform float ${ye.TEXTURE_ORIGIN_X};
    uniform float ${ye.TEXTURE_ORIGIN_Y};
    uniform float ${ye.DEPTH};

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = ${es.TEXTURE_COORD};
      v_mapCoord = vec2(
        ${ye.TEXTURE_ORIGIN_X} + ${ye.TEXTURE_RESOLUTION} * ${ye.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],
        ${ye.TEXTURE_ORIGIN_Y} - ${ye.TEXTURE_RESOLUTION} * ${ye.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]
      );
      gl_Position = ${ye.TILE_TRANSFORM} * vec4(${es.TEXTURE_COORD}, ${ye.DEPTH}, 1.0);
    }
  `,i={...$g(),inFragmentShader:!0,bandCount:e,style:r},n=[];if(r.color!==void 0){const u=yn(i,r.color,lt);n.push(`color = ${u};`)}if(r.contrast!==void 0){const u=yn(i,r.contrast,se);n.push(`color.rgb = clamp((${u} + 1.0) * color.rgb - (${u} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(r.exposure!==void 0){const u=yn(i,r.exposure,se);n.push(`color.rgb = clamp((${u} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(r.saturation!==void 0){const u=yn(i,r.saturation,se);n.push(`
      float saturation = ${u} + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `)}if(r.gamma!==void 0){const u=yn(i,r.gamma,se);n.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${u}));`)}if(r.brightness!==void 0){const u=yn(i,r.brightness,se);n.push(`color.rgb = clamp(color.rgb + ${u}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const s={},o=Object.keys(i.variables).length;if(o>1&&!r.variables)throw new Error(`Missing variables in style (expected ${i.variables})`);for(let u=0;u<o;++u){const d=i.variables[Object.keys(i.variables)[u]];if(!(d.name in r.variables))throw new Error(`Missing '${d.name}' in style variables`);const f=v1(d.name);s[f]=function(){let g=r.variables[d.name];return typeof g=="string"&&(g=x1(g)),g!==void 0?g:-9999999}}const a=Object.keys(s).map(function(u){return`uniform float ${u};`}),l=Math.ceil(e/4);a.push(`uniform sampler2D ${ye.TILE_TEXTURE_ARRAY}[${l}];`),i.paletteTextures&&a.push(`uniform sampler2D ${w1}[${i.paletteTextures.length}];`);const h=Object.keys(i.functions).map(function(u){return i.functions[u]}),c=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 ${ye.RENDER_EXTENT};
    uniform float ${ye.TRANSITION_ALPHA};
    uniform float ${ye.TEXTURE_PIXEL_WIDTH};
    uniform float ${ye.TEXTURE_PIXEL_HEIGHT};
    uniform float ${ye.RESOLUTION};
    uniform float ${ye.ZOOM};

    ${a.join(`
`)}

    ${h.join(`
`)}

    void main() {
      if (
        v_mapCoord[0] < ${ye.RENDER_EXTENT}[0] ||
        v_mapCoord[1] < ${ye.RENDER_EXTENT}[1] ||
        v_mapCoord[0] > ${ye.RENDER_EXTENT}[2] ||
        v_mapCoord[1] > ${ye.RENDER_EXTENT}[3]
      ) {
        discard;
      }

      vec4 color = texture2D(${ye.TILE_TEXTURE_ARRAY}[0],  v_textureCoord);

      ${n.join(`
`)}

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= ${ye.TRANSITION_ALPHA};
    }`;return{vertexShader:t,fragmentShader:c,uniforms:s,paletteTextures:i.paletteTextures}}class Po extends V2{constructor(e){e=e?Object.assign({},e):{};const t=e.style||{};delete e.style;const i=e.cacheSize;delete e.cacheSize,super(e),this.sources_=e.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=t,this.cacheSize_=i,this.styleVariables_=this.style_.variables||{},this.addChangeListener(Ue.SOURCE,this.handleSourceUpdate_)}getSources(e,t){const i=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(e,t):this.sources_:i?[i]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const e=this.getRenderSource();return e?e.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache(),this.getSource()&&this.setStyle(this.style_)}getSourceBandCount_(){const e=Number.MAX_SAFE_INTEGER,t=this.getSources([-e,-e,e,e],e);return t&&t.length&&"bandCount"in t[0]?t[0].bandCount:4}createRenderer(){const e=$l(this.style_,this.getSourceBandCount_());return new Wg(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})}renderSources(e,t){const i=this.getRenderer();let n;for(let s=0,o=t.length;s<o;++s)this.renderedSource_=t[s],i.prepareFrame(e)&&(n=i.renderFrame(e));return n}render(e,t){this.rendered=!0;const i=e.viewState,n=this.getSources(e.extent,i.resolution);let s=!0;for(let a=0,l=n.length;a<l;++a){const h=n[a],c=h.getState();if(c=="loading"){const u=()=>{h.getState()=="ready"&&(h.removeEventListener("change",u),this.changed())};h.addEventListener("change",u)}s=s&&c=="ready"}const o=this.renderSources(e,n);if(this.getRenderer().renderComplete&&s)return this.renderedResolution_=i.resolution,o;if(this.renderedResolution_>.5*i.resolution){const a=this.getSources(e.extent,this.renderedResolution_).filter(l=>!n.includes(l));if(a.length>0)return this.renderSources(e,a)}return o}setStyle(e){this.styleVariables_=e.variables||{},this.style_=e;const t=$l(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,paletteTextures:t.paletteTextures}),this.changed()}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}Po.prototype.dispose;let e_=[[84,48,5],[86,49,5],[88,51,6],[90,52,7],[92,54,8],[94,55,8],[96,57,9],[98,59,10],[100,60,11],[102,62,12],[104,63,12],[107,65,13],[109,67,14],[111,68,15],[113,70,15],[115,71,16],[117,73,17],[119,74,18],[121,76,19],[123,78,19],[125,79,20],[128,81,21],[130,82,22],[132,84,23],[134,86,23],[136,87,24],[138,89,25],[140,90,26],[142,92,26],[144,94,27],[146,95,28],[149,97,29],[151,98,30],[153,100,30],[155,101,31],[157,103,32],[159,105,33],[161,106,34],[163,108,34],[165,109,35],[167,111,36],[170,113,37],[172,114,37],[174,116,38],[176,117,39],[178,119,40],[180,121,41],[182,122,41],[184,124,42],[186,125,43],[188,127,44],[191,129,44],[191,130,47],[192,132,50],[193,133,53],[194,135,55],[194,136,58],[195,138,60],[196,139,63],[197,141,66],[197,143,69],[198,144,71],[199,146,74],[200,147,77],[200,149,79],[201,150,82],[202,152,84],[203,154,87],[203,155,90],[204,157,93],[205,158,95],[206,160,98],[206,161,101],[207,163,103],[208,165,106],[209,166,109],[209,168,111],[210,169,114],[211,171,117],[212,172,119],[212,174,122],[213,176,125],[214,177,127],[215,179,130],[216,180,133],[216,182,135],[217,183,138],[218,185,140],[219,187,143],[219,188,146],[220,190,148],[221,191,151],[222,193,154],[222,194,157],[223,196,159],[224,198,162],[225,199,165],[225,201,167],[226,202,170],[227,204,173],[228,205,175],[228,207,178],[229,209,180],[230,210,183],[231,212,186],[231,213,189],[232,215,191],[233,216,194],[234,218,197],[234,219,199],[235,221,202],[236,223,205],[237,224,207],[238,226,210],[238,227,212],[239,229,215],[240,230,218],[241,232,221],[241,234,223],[242,235,226],[243,237,229],[244,238,231],[244,240,234],[245,241,236],[246,243,239],[247,245,242],[247,246,244],[248,248,247],[247,248,248],[245,247,246],[242,245,245],[240,244,244],[237,243,242],[234,241,241],[232,240,239],[229,239,238],[227,238,237],[224,236,235],[222,235,234],[219,234,233],[216,232,231],[214,231,230],[211,230,228],[209,229,227],[206,227,226],[204,226,224],[201,225,223],[199,224,221],[196,222,220],[193,221,219],[191,220,217],[188,218,216],[186,217,215],[183,216,213],[181,215,212],[178,213,210],[175,212,209],[173,211,208],[170,209,206],[168,208,205],[165,207,203],[163,206,202],[160,204,201],[158,203,199],[155,202,198],[152,200,197],[150,199,195],[147,198,194],[145,197,192],[142,195,191],[140,194,190],[137,193,188],[134,191,187],[132,190,185],[129,189,184],[127,188,183],[124,186,181],[122,185,180],[119,184,179],[117,183,177],[114,181,176],[111,180,174],[109,179,173],[106,177,172],[104,176,170],[101,175,169],[99,174,167],[96,172,166],[93,171,165],[91,170,163],[88,168,162],[86,167,161],[83,166,159],[81,165,158],[78,163,156],[76,162,155],[73,161,154],[70,159,152],[68,158,151],[65,157,149],[63,156,148],[60,154,147],[58,153,145],[55,152,144],[53,151,143],[51,149,141],[50,147,139],[49,145,137],[48,143,135],[47,142,133],[46,140,131],[45,138,129],[44,136,128],[43,134,126],[42,133,124],[41,131,122],[40,129,120],[39,127,118],[38,126,116],[37,124,115],[36,122,113],[35,120,111],[34,118,109],[33,117,107],[32,115,105],[31,113,103],[30,111,102],[29,109,100],[28,108,98],[27,106,96],[25,104,94],[24,102,92],[23,101,90],[22,99,88],[21,97,87],[20,95,85],[19,93,83],[18,92,81],[17,90,79],[16,88,77],[15,86,75],[14,84,74],[13,83,72],[12,81,70],[11,79,68],[10,77,66],[9,76,64],[8,74,62],[7,72,61],[6,70,59],[5,68,57],[4,67,55],[3,65,53],[2,63,51],[1,61,49],[0,60,48]],t_=[[0,68,57],[1,70,57],[3,72,58],[5,74,59],[7,76,60],[8,78,60],[10,80,61],[12,82,62],[14,84,63],[15,86,64],[17,88,64],[19,90,65],[21,92,66],[22,95,67],[24,97,67],[26,99,68],[28,101,69],[30,103,70],[31,105,71],[33,107,71],[35,109,72],[37,111,73],[38,113,74],[40,115,75],[42,117,75],[44,119,76],[45,122,77],[47,124,78],[49,126,78],[51,128,79],[52,130,80],[54,132,81],[56,134,82],[58,136,82],[60,138,83],[61,140,84],[63,142,85],[65,144,86],[67,146,86],[68,149,87],[70,151,88],[72,153,89],[74,155,89],[75,157,90],[77,159,91],[79,161,92],[81,163,93],[82,165,93],[84,167,94],[86,169,95],[88,171,96],[90,174,97],[92,174,98],[94,175,100],[96,176,102],[98,177,104],[100,178,106],[102,179,108],[104,180,110],[106,181,112],[108,182,114],[110,183,116],[112,184,118],[114,185,120],[117,186,122],[119,187,124],[121,188,126],[123,189,128],[125,190,130],[127,191,132],[129,192,134],[131,193,136],[133,194,138],[135,195,140],[137,196,142],[139,197,144],[141,198,146],[144,199,148],[146,200,150],[148,201,152],[150,202,154],[152,203,156],[154,204,158],[156,205,160],[158,206,162],[160,207,164],[162,208,166],[164,209,168],[166,210,170],[168,211,172],[171,212,174],[173,213,176],[175,214,178],[177,215,180],[179,216,182],[181,217,184],[183,218,186],[185,219,188],[187,220,190],[189,221,192],[191,222,194],[193,223,196],[195,224,198],[198,224,200],[200,225,202],[202,226,204],[204,227,206],[206,228,208],[208,229,210],[210,230,212],[212,231,214],[214,232,216],[216,233,218],[218,234,220],[220,235,222],[223,236,224],[225,237,226],[227,238,228],[229,239,230],[231,240,232],[233,241,234],[235,242,236],[237,243,238],[239,244,240],[241,245,242],[243,246,244],[245,247,246],[247,248,248],[248,248,248],[247,246,247],[245,244,246],[244,242,245],[243,240,244],[242,239,243],[240,237,242],[239,235,241],[238,233,240],[237,231,239],[235,230,238],[234,228,237],[233,226,236],[232,224,235],[230,223,234],[229,221,233],[228,219,232],[227,217,231],[225,215,230],[224,214,229],[223,212,228],[222,210,227],[220,208,226],[219,206,225],[218,205,224],[217,203,223],[215,201,221],[214,199,220],[213,197,219],[211,196,218],[210,194,217],[209,192,216],[208,190,215],[206,189,214],[205,187,213],[204,185,212],[203,183,211],[201,181,210],[200,180,209],[199,178,208],[198,176,207],[196,174,206],[195,172,205],[194,171,204],[193,169,203],[191,167,202],[190,165,201],[189,163,200],[188,162,199],[186,160,198],[185,158,197],[184,156,196],[183,154,195],[181,153,194],[180,151,193],[179,149,192],[178,147,191],[176,146,190],[175,144,189],[174,142,188],[173,140,187],[171,138,186],[170,137,185],[169,135,184],[168,133,183],[166,131,182],[165,129,181],[164,128,180],[163,126,179],[161,124,178],[160,122,177],[159,120,176],[158,119,175],[156,117,174],[155,115,173],[154,113,172],[153,112,171],[151,109,169],[149,107,167],[147,105,165],[146,103,163],[144,101,161],[142,98,159],[140,96,157],[139,94,155],[137,92,154],[135,90,152],[133,87,150],[132,85,148],[130,83,146],[128,81,144],[126,79,142],[125,76,140],[123,74,139],[121,72,137],[119,70,135],[118,68,133],[116,65,131],[114,63,129],[112,61,127],[111,59,125],[109,57,123],[107,54,122],[105,52,120],[104,50,118],[102,48,116],[100,46,114],[98,43,112],[97,41,110],[95,39,108],[93,37,107],[91,35,105],[90,32,103],[88,30,101],[86,28,99],[84,26,97],[83,24,95],[81,21,93],[79,19,91],[77,17,90],[76,15,88],[74,13,86],[72,10,84],[70,8,82],[69,6,80],[67,4,78],[65,2,76],[64,0,75]],i_=[[38,38,0],[39,39,2],[41,41,3],[42,42,5],[44,44,6],[45,46,8],[47,47,9],[48,49,11],[50,50,12],[52,52,13],[53,54,14],[55,55,16],[57,57,17],[58,58,18],[60,60,19],[62,62,20],[63,64,22],[65,65,23],[67,67,24],[69,69,26],[70,70,27],[72,72,29],[74,74,30],[76,76,31],[78,78,33],[79,79,34],[81,81,36],[83,83,37],[85,85,39],[87,87,40],[89,89,42],[90,90,43],[92,92,45],[94,94,46],[96,96,48],[98,98,50],[100,100,51],[102,102,53],[104,104,54],[105,105,56],[107,107,57],[109,109,59],[111,111,61],[113,113,62],[115,115,64],[117,117,65],[119,119,67],[121,121,69],[123,123,70],[125,125,72],[127,127,74],[129,129,75],[131,131,77],[133,133,79],[135,135,80],[137,137,82],[139,139,84],[141,141,85],[143,143,87],[145,145,89],[147,147,90],[149,149,92],[151,151,94],[153,153,95],[155,155,97],[157,157,99],[159,159,101],[161,161,103],[163,163,105],[165,165,106],[167,167,108],[169,169,110],[171,171,112],[173,173,114],[175,175,117],[177,177,119],[179,179,121],[181,181,123],[183,183,125],[185,185,128],[187,187,130],[189,189,133],[191,191,135],[193,193,137],[195,194,140],[196,196,142],[198,198,145],[199,199,147],[201,201,150],[202,202,152],[204,204,155],[205,205,157],[207,206,159],[208,208,162],[209,209,164],[210,210,167],[212,212,169],[213,213,171],[214,214,174],[215,215,176],[217,216,179],[218,218,181],[219,219,183],[220,220,186],[221,221,188],[223,222,190],[224,224,193],[225,225,195],[226,226,198],[227,227,200],[228,228,202],[229,229,205],[231,230,207],[232,232,209],[233,233,212],[234,234,214],[234,235,216],[235,235,218],[236,236,221],[236,237,223],[237,238,225],[237,238,227],[237,239,228],[237,239,230],[237,239,232],[237,239,233],[236,238,234],[235,238,235],[234,237,236],[232,237,236],[231,236,236],[229,234,237],[227,233,236],[225,232,236],[223,230,236],[221,229,235],[219,227,234],[217,226,233],[214,224,233],[212,222,232],[210,220,231],[207,219,229],[205,217,228],[203,215,227],[200,213,226],[198,212,225],[195,210,223],[193,208,222],[191,206,221],[188,204,220],[186,202,218],[183,201,217],[181,199,216],[179,197,215],[176,195,213],[174,193,212],[171,192,211],[169,190,210],[167,188,208],[164,186,207],[162,184,206],[160,183,205],[157,181,203],[155,179,202],[152,177,201],[150,175,200],[148,174,199],[145,172,197],[143,170,196],[141,168,195],[138,166,194],[136,165,192],[134,163,191],[131,161,190],[129,159,189],[127,158,187],[124,156,186],[122,154,185],[120,152,184],[117,150,183],[115,149,181],[113,147,180],[111,145,179],[108,143,178],[106,142,177],[104,140,175],[101,138,174],[99,136,173],[97,135,172],[95,133,170],[92,131,169],[90,130,168],[88,128,167],[86,126,166],[84,124,164],[81,123,163],[79,121,162],[77,119,161],[75,117,160],[73,116,158],[71,114,157],[68,112,156],[66,110,155],[64,109,153],[62,107,152],[60,105,151],[58,104,150],[57,102,148],[55,100,147],[53,98,146],[52,97,144],[50,95,143],[49,93,141],[47,91,140],[46,90,138],[45,88,137],[44,86,135],[43,84,134],[42,83,132],[42,81,131],[41,79,129],[41,78,128],[40,76,126],[40,74,125],[40,73,123],[40,71,122],[40,69,120],[40,68,118],[40,66,117],[40,64,115],[40,63,114],[40,61,112],[40,60,111],[40,58,109],[40,57,107],[41,55,106],[41,54,104],[41,52,103],[41,50,101],[41,49,100],[41,47,98],[42,46,97],[42,44,95],[42,43,94],[42,42,92],[42,40,91],[42,39,89],[42,37,88],[43,36,86],[43,34,85],[43,33,83],[43,31,82],[43,30,80],[43,28,79],[43,27,77],[43,25,76]],n_=[[8,29,88],[9,30,91],[11,31,95],[13,33,99],[15,34,103],[17,36,106],[18,37,110],[20,39,114],[22,40,118],[24,42,121],[26,43,125],[28,44,129],[29,46,133],[31,47,137],[33,49,140],[35,50,144],[36,52,148],[36,54,149],[36,57,150],[36,60,151],[36,62,153],[36,65,154],[35,68,155],[35,70,156],[35,73,158],[35,76,159],[35,78,160],[34,81,161],[34,83,163],[34,86,164],[34,89,165],[34,91,166],[33,94,168],[33,97,169],[33,101,171],[32,104,172],[32,107,174],[32,110,175],[32,113,177],[31,117,178],[31,120,180],[31,123,181],[30,126,183],[30,129,184],[30,133,186],[29,136,187],[29,139,189],[29,142,190],[29,145,192],[31,147,192],[34,150,192],[36,152,192],[38,154,193],[40,157,193],[43,159,193],[45,161,193],[47,164,194],[50,166,194],[52,168,194],[54,171,194],[56,173,195],[59,175,195],[61,178,195],[63,180,195],[66,182,195],[70,183,195],[74,185,194],[78,186,194],[82,188,193],[85,189,192],[89,191,192],[93,192,191],[97,194,191],[101,195,190],[105,197,190],[109,198,189],[113,199,188],[117,201,188],[121,202,187],[124,204,187],[129,205,186],[133,207,186],[138,209,185],[142,211,185],[147,212,185],[151,214,184],[156,216,184],[160,218,183],[165,219,183],[169,221,182],[174,223,182],[178,225,181],[183,226,181],[187,228,181],[192,230,180],[197,232,180],[200,233,179],[202,234,179],[205,235,179],[207,236,179],[209,237,179],[212,238,178],[214,239,178],[217,240,178],[219,241,178],[221,242,178],[224,242,178],[226,243,177],[227,244,179],[227,245,182],[228,246,184],[229,247,186],[230,249,189],[230,250,191],[231,251,193],[232,252,195],[232,253,198],[233,254,200],[235,254,206],[237,254,211],[240,254,217],[242,254,222],[244,255,228],[246,255,233],[248,255,239],[251,255,244],[253,255,250],[255,255,255],[255,254,247],[255,253,240],[255,252,232],[255,251,224],[255,250,217],[255,248,209],[255,247,201],[255,246,193],[255,245,186],[255,244,178],[255,243,175],[255,242,172],[255,241,170],[255,240,167],[255,238,164],[255,237,161],[254,236,159],[254,235,156],[254,234,153],[254,232,151],[254,231,148],[254,230,145],[254,229,143],[254,227,140],[254,226,137],[254,225,135],[254,223,132],[254,222,130],[254,221,127],[254,220,124],[254,218,122],[254,217,119],[254,215,116],[254,213,114],[254,211,111],[254,208,108],[254,206,106],[254,203,103],[254,201,101],[254,198,98],[254,196,95],[254,193,93],[254,191,90],[254,188,87],[254,186,85],[254,184,82],[254,181,79],[254,179,77],[253,176,75],[253,174,74],[253,172,73],[253,169,72],[253,167,71],[253,165,70],[253,162,69],[253,160,68],[253,158,67],[253,155,66],[253,153,65],[253,151,64],[253,148,63],[253,146,62],[253,144,61],[253,141,60],[252,138,59],[252,134,58],[252,130,57],[252,126,55],[252,122,54],[252,118,53],[252,114,52],[252,110,51],[252,106,50],[252,102,49],[252,98,47],[252,94,46],[252,90,45],[252,87,44],[252,83,43],[252,79,42],[250,75,41],[249,72,40],[247,69,39],[246,65,38],[244,62,37],[243,59,36],[241,56,36],[239,52,35],[238,49,34],[236,46,33],[235,42,32],[233,39,31],[232,36,30],[230,33,29],[228,29,29],[227,26,28],[225,24,28],[222,23,29],[220,21,29],[217,19,30],[215,18,31],[213,16,31],[210,14,32],[208,13,32],[205,11,33],[203,9,34],[201,8,34],[198,6,35],[196,5,36],[194,3,36],[191,1,37],[189,0,37],[185,0,38],[181,0,38],[177,0,38],[174,0,38],[170,0,38],[166,0,38],[162,0,38],[158,0,38],[154,0,38],[151,0,38],[147,0,38],[143,0,38],[139,0,38],[135,0,38],[131,0,38],[128,0,38]],r_=[[8,29,88],[9,30,91],[11,31,95],[13,33,99],[15,34,103],[17,36,106],[18,37,110],[20,39,114],[22,40,118],[24,42,121],[26,43,125],[28,44,129],[29,46,133],[31,47,137],[33,49,140],[35,50,144],[36,52,148],[36,54,149],[36,57,150],[36,60,151],[36,62,153],[36,65,154],[35,68,155],[35,70,156],[35,73,158],[35,76,159],[35,78,160],[34,81,161],[34,83,163],[34,86,164],[34,89,165],[34,91,166],[33,94,168],[33,97,169],[33,101,171],[32,104,172],[32,107,174],[32,110,175],[32,113,177],[31,117,178],[31,120,180],[31,123,181],[30,126,183],[30,129,184],[30,133,186],[29,136,187],[29,139,189],[29,142,190],[29,145,192],[31,147,192],[34,150,192],[36,152,192],[38,154,193],[40,157,193],[43,159,193],[45,161,193],[47,164,194],[50,166,194],[52,168,194],[54,171,194],[56,173,195],[59,175,195],[61,178,195],[63,180,195],[66,182,195],[70,183,195],[74,185,194],[78,186,194],[82,188,193],[85,189,192],[89,191,192],[93,192,191],[97,194,191],[101,195,190],[105,197,190],[109,198,189],[113,199,188],[117,201,188],[121,202,187],[124,204,187],[129,205,186],[133,207,186],[138,209,185],[142,211,185],[147,212,185],[151,214,184],[156,216,184],[160,218,183],[165,219,183],[169,221,182],[174,223,182],[178,225,181],[183,226,181],[187,228,181],[192,230,180],[197,232,180],[200,233,179],[202,234,179],[205,235,179],[207,236,179],[209,237,179],[212,238,178],[214,239,178],[217,240,178],[219,241,178],[221,242,178],[224,242,178],[226,243,177],[229,244,177],[231,245,177],[233,246,177],[236,247,177],[237,248,178],[238,248,181],[240,249,183],[241,249,186],[242,250,188],[243,250,191],[244,250,193],[245,251,196],[246,251,198],[247,252,201],[249,252,203],[250,253,206],[251,253,208],[252,254,211],[253,254,213],[254,254,216],[255,254,203],[255,253,200],[255,252,197],[255,251,195],[255,250,192],[255,249,189],[255,247,186],[255,246,183],[255,245,181],[255,244,178],[255,243,175],[255,242,172],[255,241,170],[255,240,167],[255,238,164],[255,237,161],[254,236,159],[254,235,156],[254,234,153],[254,232,151],[254,231,148],[254,230,145],[254,229,143],[254,227,140],[254,226,137],[254,225,135],[254,223,132],[254,222,130],[254,221,127],[254,220,124],[254,218,122],[254,217,119],[254,215,116],[254,213,114],[254,211,111],[254,208,108],[254,206,106],[254,203,103],[254,201,101],[254,198,98],[254,196,95],[254,193,93],[254,191,90],[254,188,87],[254,186,85],[254,184,82],[254,181,79],[254,179,77],[253,176,75],[253,174,74],[253,172,73],[253,169,72],[253,167,71],[253,165,70],[253,162,69],[253,160,68],[253,158,67],[253,155,66],[253,153,65],[253,151,64],[253,148,63],[253,146,62],[253,144,61],[253,141,60],[252,138,59],[252,134,58],[252,130,57],[252,126,55],[252,122,54],[252,118,53],[252,114,52],[252,110,51],[252,106,50],[252,102,49],[252,98,47],[252,94,46],[252,90,45],[252,87,44],[252,83,43],[252,79,42],[250,75,41],[249,72,40],[247,69,39],[246,65,38],[244,62,37],[243,59,36],[241,56,36],[239,52,35],[238,49,34],[236,46,33],[235,42,32],[233,39,31],[232,36,30],[230,33,29],[228,29,29],[227,26,28],[225,24,28],[222,23,29],[220,21,29],[217,19,30],[215,18,31],[213,16,31],[210,14,32],[208,13,32],[205,11,33],[203,9,34],[201,8,34],[198,6,35],[196,5,36],[194,3,36],[191,1,37],[189,0,37],[185,0,38],[181,0,38],[177,0,38],[174,0,38],[170,0,38],[166,0,38],[162,0,38],[158,0,38],[154,0,38],[151,0,38],[147,0,38],[143,0,38],[139,0,38],[135,0,38],[131,0,38],[128,0,38]],s_=[[2,71,104],[3,72,105],[4,74,107],[6,76,109],[7,78,111],[8,79,113],[10,81,115],[11,83,117],[12,85,119],[14,86,121],[15,88,123],[17,90,125],[18,92,127],[19,94,129],[21,95,131],[22,97,133],[23,99,135],[25,101,137],[26,102,139],[27,104,141],[29,106,143],[30,108,145],[32,109,147],[33,111,149],[34,113,151],[36,115,153],[37,117,154],[38,118,156],[40,120,158],[41,122,160],[42,124,162],[44,125,164],[45,127,166],[47,129,168],[48,131,170],[49,133,172],[51,134,174],[52,136,176],[53,138,178],[55,140,180],[56,141,182],[57,143,184],[59,145,186],[60,147,188],[62,148,190],[63,150,192],[64,152,194],[66,154,196],[67,156,198],[68,157,200],[70,159,202],[71,161,204],[72,163,205],[74,164,207],[75,166,209],[77,168,211],[78,170,213],[79,172,215],[81,173,217],[82,175,219],[83,177,221],[85,179,223],[86,180,225],[87,182,227],[89,184,229],[92,185,229],[94,186,229],[97,187,230],[99,188,230],[102,189,230],[104,190,230],[107,191,231],[109,192,231],[112,193,231],[114,194,232],[117,195,232],[119,196,232],[122,197,233],[124,198,233],[127,199,233],[129,200,234],[132,201,234],[134,202,234],[137,203,235],[139,204,235],[142,205,235],[144,206,235],[147,207,236],[149,208,236],[152,209,236],[154,210,237],[157,211,237],[159,212,237],[162,213,238],[164,214,238],[167,215,238],[169,216,239],[172,217,239],[174,218,239],[177,219,240],[179,220,240],[182,221,240],[185,223,241],[187,224,241],[190,225,241],[192,226,241],[195,227,242],[197,228,242],[200,229,242],[202,230,243],[205,231,243],[207,232,243],[210,233,244],[212,234,244],[215,235,244],[217,236,245],[220,237,245],[222,238,245],[225,239,246],[227,240,246],[230,241,246],[232,242,246],[235,243,247],[237,244,247],[240,245,247],[242,246,248],[245,247,248],[247,248,248],[248,248,247],[248,246,244],[248,245,240],[248,244,237],[248,242,234],[247,241,231],[247,239,227],[247,238,224],[247,237,221],[247,235,218],[246,234,214],[246,232,211],[246,231,208],[246,229,205],[246,228,201],[245,227,198],[245,225,195],[245,224,192],[245,222,188],[245,221,185],[244,220,182],[244,218,179],[244,217,175],[244,215,172],[244,214,169],[243,212,166],[243,211,162],[243,210,159],[243,208,156],[242,207,153],[242,205,149],[242,204,146],[242,203,143],[242,201,140],[241,200,136],[241,198,133],[241,197,130],[241,196,127],[241,194,123],[240,193,120],[240,191,117],[240,190,114],[240,189,111],[240,187,107],[239,186,104],[239,184,101],[239,183,98],[239,181,94],[239,180,91],[238,179,88],[238,177,85],[238,176,81],[238,174,78],[238,173,75],[237,172,72],[237,170,68],[237,169,65],[237,167,62],[237,166,59],[236,164,55],[236,163,52],[236,162,49],[236,160,46],[236,159,42],[234,157,41],[231,156,41],[229,154,41],[226,152,41],[224,151,41],[221,149,41],[219,148,41],[217,146,40],[214,144,40],[212,143,40],[209,141,40],[207,140,40],[204,138,40],[202,136,40],[199,135,39],[197,133,39],[195,131,39],[192,130,39],[190,128,39],[187,127,39],[185,125,39],[182,123,38],[180,122,38],[177,120,38],[175,119,38],[172,117,38],[170,115,38],[168,114,38],[165,112,37],[163,110,37],[160,109,37],[158,107,37],[155,106,37],[153,104,37],[150,102,37],[148,101,36],[146,99,36],[143,98,36],[141,96,36],[138,94,36],[136,93,36],[133,91,36],[131,89,35],[128,88,35],[126,86,35],[124,85,35],[121,83,35],[119,81,35],[116,80,35],[114,78,34],[111,77,34],[109,75,34],[106,73,34],[104,72,34],[102,70,34],[99,68,34],[97,67,33],[94,65,33],[92,64,33],[89,62,33],[87,60,33],[84,59,33],[82,57,33],[80,56,33]],o_=[[5,48,97],[6,49,98],[7,51,100],[8,53,102],[9,55,104],[11,57,106],[12,59,108],[13,61,110],[14,63,112],[15,65,114],[17,67,116],[18,69,118],[19,71,120],[20,73,121],[22,75,123],[23,77,125],[24,79,127],[25,81,129],[26,82,131],[28,84,133],[29,86,135],[30,88,137],[31,90,139],[32,92,141],[34,94,143],[35,96,145],[36,98,146],[37,100,148],[39,102,150],[40,104,152],[41,106,154],[42,108,156],[43,110,158],[45,112,160],[46,113,162],[47,115,164],[48,117,166],[49,119,168],[51,121,170],[52,123,171],[53,125,173],[54,127,175],[56,129,177],[57,131,179],[58,133,181],[59,135,183],[60,137,185],[62,139,187],[63,141,189],[64,143,191],[65,145,193],[67,147,195],[69,148,195],[71,149,196],[74,150,197],[76,152,197],[78,153,198],[81,155,199],[83,156,199],[86,157,200],[88,159,201],[90,160,202],[93,161,202],[95,163,203],[97,164,204],[100,165,204],[102,166,205],[105,168,206],[107,169,207],[109,171,207],[112,172,208],[114,173,209],[116,175,209],[119,176,210],[121,177,211],[124,179,211],[126,180,212],[128,181,213],[131,183,214],[133,184,214],[135,185,215],[138,187,216],[140,188,216],[143,189,217],[145,191,218],[147,192,219],[150,193,219],[152,195,220],[155,196,221],[157,197,221],[159,198,222],[162,200,223],[164,201,223],[166,203,224],[169,204,225],[171,205,226],[174,207,226],[176,208,227],[178,209,228],[181,211,228],[183,212,229],[185,213,230],[188,214,230],[190,216,231],[193,217,232],[195,219,233],[197,220,233],[200,221,234],[202,223,235],[204,224,235],[207,225,236],[209,227,237],[212,228,238],[214,229,238],[216,230,239],[219,232,240],[221,233,240],[224,235,241],[226,236,242],[228,237,243],[231,239,243],[233,240,244],[235,241,245],[238,243,245],[240,244,246],[243,245,247],[245,246,247],[247,248,248],[248,248,247],[248,246,245],[247,243,243],[247,242,241],[246,240,238],[246,238,236],[246,235,234],[245,234,232],[245,232,229],[244,230,227],[244,227,225],[243,226,223],[243,224,220],[242,222,218],[242,220,216],[241,218,214],[241,216,211],[240,214,209],[240,211,207],[240,210,205],[239,208,202],[239,206,200],[238,203,198],[238,202,196],[237,200,193],[237,198,191],[236,195,189],[236,194,187],[235,192,184],[235,190,182],[235,187,180],[234,186,178],[234,184,175],[233,181,173],[233,179,171],[232,178,169],[232,176,166],[231,174,164],[231,172,162],[230,170,160],[230,168,157],[230,166,155],[229,163,153],[229,162,151],[228,160,148],[228,158,146],[227,156,144],[227,154,142],[226,152,139],[226,149,137],[225,147,135],[225,146,133],[224,144,130],[224,142,128],[224,140,126],[223,138,124],[223,135,121],[222,134,119],[222,132,117],[221,130,115],[221,128,112],[220,125,110],[220,124,108],[219,121,106],[219,120,103],[219,118,101],[218,115,99],[218,113,97],[217,112,94],[217,110,92],[216,108,90],[216,105,88],[215,104,85],[215,102,83],[214,100,81],[214,97,79],[214,96,76],[211,94,76],[209,92,75],[207,90,74],[205,88,73],[203,86,72],[200,84,71],[198,82,70],[196,80,69],[194,79,68],[192,77,67],[190,75,67],[187,73,66],[185,71,65],[183,69,64],[181,67,63],[179,65,62],[177,64,61],[174,62,60],[172,60,59],[170,58,58],[168,56,58],[166,54,57],[163,52,56],[161,50,55],[159,48,54],[157,47,53],[155,45,52],[153,43,51],[150,41,50],[148,39,49],[146,37,49],[144,35,48],[142,33,47],[140,32,46],[137,30,45],[135,28,44],[133,26,43],[131,24,42],[129,22,41],[126,20,40],[124,18,40],[122,16,39],[120,15,38],[118,13,37],[116,11,36],[113,9,35],[111,7,34],[109,5,33],[107,3,32],[105,1,31],[103,0,31]],a_=[[43,25,76],[43,27,77],[43,28,79],[43,29,80],[43,31,82],[43,32,83],[43,34,84],[43,35,86],[43,37,87],[43,38,89],[43,40,90],[43,41,92],[42,42,93],[42,44,94],[42,45,96],[42,47,97],[42,48,99],[42,50,100],[42,51,102],[42,53,103],[42,54,105],[41,55,106],[41,57,108],[41,58,109],[41,60,111],[41,61,112],[41,63,114],[41,64,115],[41,66,117],[41,68,118],[41,69,120],[42,71,121],[42,72,123],[42,74,124],[43,75,126],[43,77,127],[43,79,129],[44,80,130],[45,82,131],[46,84,133],[46,85,134],[47,87,136],[48,89,137],[49,90,139],[51,92,140],[52,94,141],[53,95,143],[55,97,144],[56,99,146],[58,100,147],[59,102,148],[61,104,149],[63,105,151],[64,107,152],[66,109,153],[68,111,155],[70,112,156],[72,114,157],[74,116,158],[76,117,159],[78,119,161],[80,121,162],[82,122,163],[84,124,164],[86,126,165],[88,127,167],[90,129,168],[92,131,169],[94,132,170],[97,134,171],[99,136,172],[101,137,174],[103,139,175],[105,141,176],[107,142,177],[109,144,178],[112,146,179],[114,147,181],[116,149,182],[118,151,183],[120,153,184],[123,154,185],[125,156,186],[127,158,188],[129,159,189],[131,161,190],[134,163,191],[136,164,192],[138,166,193],[140,168,195],[143,170,196],[145,171,197],[147,173,198],[149,175,199],[152,176,201],[154,178,202],[156,180,203],[158,182,204],[161,183,205],[163,185,206],[165,187,208],[167,188,209],[170,190,210],[172,192,211],[174,194,212],[177,195,214],[179,197,215],[181,199,216],[183,201,217],[186,202,218],[188,204,219],[190,206,220],[192,207,222],[195,209,223],[197,211,224],[199,213,225],[201,214,225],[203,216,226],[205,217,227],[207,219,228],[209,221,228],[210,222,229],[212,223,229],[214,225,230],[215,226,230],[216,227,230],[217,228,229],[218,229,229],[218,230,228],[218,230,228],[218,231,227],[218,231,226],[218,231,224],[217,231,223],[216,231,221],[215,230,220],[214,230,218],[213,229,216],[211,228,215],[210,228,213],[208,227,211],[206,226,209],[204,225,207],[202,224,205],[201,223,203],[199,222,201],[197,221,199],[195,219,197],[193,218,195],[191,217,193],[189,216,191],[187,215,189],[185,214,187],[183,212,185],[181,211,183],[179,210,181],[177,209,179],[174,208,177],[172,207,175],[170,205,173],[168,204,171],[166,203,170],[164,202,168],[162,201,166],[160,199,164],[158,198,162],[156,197,160],[154,196,158],[152,195,156],[150,193,154],[148,192,152],[146,191,150],[144,190,148],[142,189,146],[140,188,144],[138,186,142],[136,185,140],[134,184,138],[132,183,137],[130,182,135],[128,181,133],[126,179,131],[124,178,129],[122,177,127],[120,176,125],[118,175,123],[116,173,121],[114,172,119],[112,171,117],[111,170,115],[109,169,113],[107,167,111],[105,166,109],[103,165,107],[101,164,105],[99,162,103],[97,161,101],[95,160,99],[93,158,97],[91,157,95],[89,155,93],[88,154,91],[86,153,89],[84,151,87],[82,150,84],[81,148,82],[79,146,80],[78,145,78],[76,143,76],[75,141,73],[73,140,71],[72,138,69],[71,136,67],[70,135,65],[69,133,62],[68,131,60],[68,129,58],[67,128,56],[66,126,54],[66,124,52],[65,123,51],[65,121,49],[65,119,47],[64,118,45],[64,116,44],[64,115,42],[64,113,40],[64,112,39],[64,110,37],[64,109,36],[64,107,34],[64,106,33],[64,105,32],[64,103,30],[64,102,29],[64,101,28],[64,99,26],[65,98,25],[65,97,24],[65,95,22],[65,94,21],[65,93,20],[65,92,18],[65,90,17],[65,89,16],[65,88,15],[65,87,13],[66,86,12],[66,84,11],[66,83,9],[66,82,8],[66,81,7],[66,80,5],[66,78,4],[66,77,3],[66,76,2]],Jl=[[25,51,178],[26,51,178],[26,52,177],[27,53,177],[27,53,177],[28,54,176],[28,55,176],[28,56,176],[29,56,175],[29,57,175],[29,58,175],[30,58,174],[30,59,174],[31,60,174],[31,60,173],[31,61,173],[32,62,172],[32,62,172],[32,63,172],[33,64,171],[33,65,171],[33,65,171],[34,66,170],[34,67,170],[34,67,170],[35,68,169],[35,69,169],[35,69,169],[36,70,168],[36,71,168],[36,71,168],[37,72,167],[37,72,167],[37,73,167],[38,74,166],[38,74,166],[38,75,166],[39,76,165],[39,76,165],[39,77,165],[40,78,164],[40,78,164],[40,79,164],[40,80,163],[41,80,163],[41,81,163],[41,82,162],[42,82,162],[42,83,162],[42,84,161],[43,84,161],[43,85,161],[43,86,160],[44,86,160],[44,87,160],[44,88,159],[45,88,159],[45,89,159],[45,90,158],[46,90,158],[46,91,158],[46,91,157],[47,92,157],[47,93,157],[48,93,156],[48,94,156],[48,95,156],[49,95,155],[49,96,155],[49,97,154],[50,97,154],[50,98,154],[51,98,153],[51,99,153],[52,100,152],[52,100,152],[52,101,152],[53,101,151],[53,102,151],[54,103,150],[54,103,150],[55,104,149],[55,104,149],[56,105,148],[56,106,148],[57,106,147],[57,107,147],[58,107,146],[58,108,146],[59,109,145],[59,109,145],[60,110,144],[60,110,144],[61,111,143],[61,111,143],[62,112,142],[63,112,141],[63,113,141],[64,114,140],[64,114,140],[65,115,139],[65,115,139],[66,116,138],[66,117,138],[67,117,137],[68,118,137],[68,118,136],[69,119,136],[69,120,135],[70,120,135],[71,121,134],[71,121,134],[72,122,133],[72,123,133],[73,123,132],[74,124,132],[74,125,131],[75,125,131],[76,126,130],[77,127,130],[77,128,129],[78,128,129],[79,129,129],[79,130,128],[80,131,128],[81,131,127],[82,132,127],[83,133,127],[83,134,126],[84,135,126],[85,135,126],[86,136,125],[87,137,125],[88,138,125],[88,139,125],[89,140,124],[90,141,124],[91,141,124],[92,142,123],[93,143,123],[94,144,123],[95,145,123],[96,146,122],[96,147,122],[97,148,122],[98,149,122],[99,150,121],[100,151,121],[101,152,121],[102,153,121],[103,153,121],[104,154,120],[105,155,120],[106,156,120],[107,157,120],[108,158,119],[109,159,119],[110,160,119],[111,161,119],[112,162,118],[113,163,118],[114,164,118],[115,165,118],[115,166,117],[116,167,117],[117,168,117],[118,169,117],[119,170,116],[120,171,116],[121,172,116],[122,173,116],[123,174,115],[124,175,115],[125,176,115],[126,177,115],[127,178,114],[128,179,114],[130,180,114],[131,181,114],[132,182,113],[133,183,113],[134,184,113],[135,185,113],[136,186,112],[137,187,112],[138,189,112],[139,190,112],[140,191,111],[141,192,111],[142,193,111],[143,194,111],[144,195,110],[145,196,110],[146,197,110],[147,198,109],[148,199,109],[150,200,109],[151,201,109],[152,202,108],[153,204,108],[154,205,108],[155,206,108],[156,207,107],[158,208,107],[159,209,107],[160,210,107],[161,211,106],[163,212,106],[164,213,106],[165,215,106],[167,216,105],[168,217,105],[170,218,105],[171,219,105],[173,220,104],[174,221,104],[176,222,104],[177,223,104],[179,224,104],[181,225,103],[183,226,103],[184,227,103],[186,228,103],[188,229,103],[190,230,103],[192,231,103],[194,232,102],[196,233,102],[198,234,102],[200,235,102],[202,236,102],[204,237,102],[206,237,102],[208,238,102],[210,239,102],[212,240,102],[214,241,102],[217,241,102],[219,242,102],[221,243,102],[223,244,102],[225,245,102],[227,245,102],[229,246,102],[231,247,102],[233,247,102],[236,248,102],[238,249,102],[240,250,102],[242,250,102],[244,251,102],[246,252,102],[248,252,102],[250,253,102],[252,254,102],[255,254,102]],l_=[[254,254,203],[254,254,202],[254,253,200],[254,253,198],[254,252,196],[254,251,195],[254,251,193],[254,250,191],[254,249,189],[254,249,187],[253,248,186],[253,247,184],[253,247,182],[253,246,180],[253,245,178],[253,245,177],[253,244,175],[253,243,173],[252,243,171],[252,242,170],[252,241,168],[252,241,166],[252,240,164],[252,239,162],[252,239,160],[251,238,159],[251,237,157],[251,236,155],[251,235,153],[251,235,151],[250,234,150],[250,233,148],[250,232,146],[250,231,144],[250,230,142],[249,230,140],[249,229,138],[249,228,137],[249,227,135],[249,226,133],[248,225,131],[248,224,129],[248,223,127],[248,221,126],[247,220,124],[247,219,122],[247,218,120],[247,217,119],[246,216,117],[246,214,115],[246,213,114],[245,212,112],[245,211,110],[245,209,109],[244,208,107],[244,207,106],[244,205,105],[243,204,103],[243,202,102],[243,201,101],[243,200,99],[242,198,98],[242,197,97],[242,196,96],[241,194,95],[241,193,94],[241,191,93],[240,190,92],[240,189,92],[240,187,91],[239,186,90],[239,185,90],[239,183,89],[239,182,88],[238,181,88],[238,180,87],[238,178,87],[237,177,87],[237,176,86],[237,175,86],[237,173,85],[236,172,85],[236,171,85],[236,170,85],[236,168,84],[235,167,84],[235,166,84],[235,165,84],[235,164,83],[234,162,83],[234,161,83],[234,160,83],[234,159,83],[233,158,83],[233,157,82],[233,155,82],[233,154,82],[232,153,82],[232,152,82],[232,151,82],[232,150,82],[231,148,82],[231,147,82],[231,146,81],[230,145,81],[230,144,81],[230,143,81],[230,141,81],[229,140,81],[229,139,81],[229,138,81],[228,137,81],[228,135,81],[228,134,80],[228,133,80],[227,132,80],[227,131,80],[226,129,80],[226,128,80],[226,127,80],[225,126,80],[225,125,80],[224,123,79],[224,122,79],[223,121,79],[223,120,79],[222,118,79],[222,117,79],[221,116,79],[221,114,79],[220,113,78],[219,112,78],[219,111,78],[218,109,78],[217,108,78],[216,107,78],[215,105,77],[214,104,77],[213,103,77],[212,101,77],[211,100,77],[210,99,76],[209,98,76],[208,96,76],[207,95,76],[205,94,75],[204,92,75],[203,91,75],[201,90,75],[200,89,74],[198,88,74],[197,87,74],[195,85,73],[194,84,73],[192,83,73],[190,82,72],[189,81,72],[187,80,72],[185,79,71],[184,79,71],[182,78,70],[180,77,70],[178,76,70],[177,75,69],[175,74,69],[173,74,68],[171,73,68],[170,72,67],[168,72,67],[166,71,66],[164,70,66],[162,70,65],[161,69,65],[159,69,64],[157,68,63],[155,67,63],[153,67,62],[152,66,62],[150,66,61],[148,65,60],[146,65,60],[144,64,59],[143,64,58],[141,63,58],[139,63,57],[137,62,56],[135,62,56],[134,61,55],[132,61,54],[130,60,53],[128,59,53],[127,59,52],[125,58,51],[123,58,50],[121,57,50],[119,57,49],[118,56,48],[116,56,47],[114,55,46],[112,55,46],[111,54,45],[109,54,44],[107,53,43],[106,53,42],[104,52,42],[102,52,41],[100,51,40],[99,50,39],[97,50,38],[95,49,38],[94,49,37],[92,48,36],[90,48,35],[89,47,34],[87,47,33],[85,46,33],[84,46,32],[82,45,31],[80,45,30],[79,44,30],[77,43,29],[75,43,28],[74,42,27],[72,42,27],[71,41,26],[69,41,25],[67,40,24],[66,40,24],[64,39,23],[63,39,22],[61,38,22],[59,38,21],[58,37,20],[56,37,20],[55,36,19],[53,36,18],[52,35,18],[50,35,17],[49,34,16],[47,34,15],[46,33,15],[44,33,14],[43,32,13],[41,31,12],[40,31,11],[39,30,10],[37,30,9],[36,29,8],[34,29,7],[33,28,6],[32,28,5],[30,27,4],[29,27,3],[28,26,2],[26,26,1],[25,25,0]],h_=[[254,254,216],[253,254,215],[251,253,214],[250,253,213],[249,253,212],[247,253,211],[246,253,211],[245,252,210],[244,252,209],[242,252,208],[241,251,207],[240,251,206],[238,251,205],[237,250,204],[235,250,203],[234,250,202],[232,249,201],[231,249,200],[229,248,199],[228,248,198],[226,247,197],[225,246,195],[223,246,194],[221,245,193],[220,244,192],[218,244,191],[216,243,190],[215,242,189],[213,241,187],[211,240,186],[209,239,185],[207,238,184],[206,237,183],[204,236,181],[202,235,180],[200,234,179],[198,233,178],[196,232,177],[195,231,175],[193,229,174],[191,228,173],[189,227,172],[188,226,171],[186,224,170],[184,223,169],[183,221,168],[181,220,166],[179,219,165],[178,217,164],[176,216,163],[175,215,163],[174,213,162],[172,212,161],[171,210,160],[170,209,159],[169,208,158],[168,206,157],[166,205,157],[165,204,156],[164,203,155],[163,201,155],[163,200,154],[162,199,153],[161,198,153],[160,196,152],[159,195,152],[159,194,151],[158,193,151],[157,192,150],[157,190,150],[156,189,149],[156,188,149],[155,187,149],[155,186,148],[154,185,148],[154,184,147],[154,183,147],[153,182,147],[153,181,146],[152,180,146],[152,179,146],[152,178,145],[151,177,145],[151,176,145],[151,175,144],[151,174,144],[150,173,144],[150,172,144],[150,171,143],[150,170,143],[149,169,143],[149,168,143],[149,167,142],[149,166,142],[148,165,142],[148,164,142],[148,163,141],[148,162,141],[148,161,141],[148,160,140],[147,159,140],[147,158,140],[147,157,140],[147,157,139],[147,156,139],[147,155,139],[146,154,139],[146,153,138],[146,152,138],[146,151,138],[146,150,138],[146,149,137],[145,148,137],[145,147,137],[145,146,137],[145,146,136],[145,145,136],[145,144,136],[144,143,136],[144,142,135],[144,141,135],[144,140,135],[144,139,135],[144,138,134],[144,137,134],[143,136,134],[143,135,134],[143,135,133],[143,134,133],[143,133,133],[143,132,133],[142,131,132],[142,130,132],[142,129,132],[142,128,132],[142,127,131],[142,126,131],[141,125,131],[141,125,130],[141,124,130],[141,123,130],[141,122,130],[140,121,129],[140,120,129],[140,119,129],[140,118,129],[140,117,128],[139,116,128],[139,115,128],[139,114,127],[139,113,127],[139,112,127],[138,111,126],[138,111,126],[138,110,126],[138,109,125],[137,108,125],[137,107,125],[137,106,124],[136,105,124],[136,104,124],[136,103,123],[135,102,123],[135,101,123],[135,100,122],[134,99,122],[134,98,121],[133,97,121],[133,96,121],[133,95,120],[132,94,120],[132,93,119],[131,91,119],[131,90,118],[130,89,118],[130,88,117],[129,87,117],[128,86,116],[128,85,116],[127,84,115],[126,83,115],[126,82,114],[125,80,114],[124,79,113],[124,78,112],[123,77,112],[122,76,111],[121,75,111],[120,73,110],[119,72,109],[118,71,108],[117,70,108],[116,69,107],[115,68,106],[114,66,106],[113,65,105],[112,64,104],[111,63,103],[110,62,102],[109,60,102],[107,59,101],[106,58,100],[105,57,99],[104,56,98],[102,54,97],[101,53,96],[100,52,95],[98,51,95],[97,50,94],[96,49,93],[94,48,92],[93,46,91],[91,45,90],[90,44,89],[88,43,88],[87,42,87],[85,41,86],[84,40,85],[82,39,84],[81,38,83],[79,37,82],[78,36,81],[76,35,80],[75,34,79],[73,34,78],[72,33,78],[70,32,77],[68,31,76],[67,30,75],[65,29,74],[64,29,73],[62,28,72],[61,27,71],[59,27,70],[58,26,69],[56,25,68],[55,24,67],[53,24,66],[52,23,66],[50,23,65],[49,22,64],[47,21,63],[46,21,62],[44,20,61],[43,20,60],[41,19,59],[40,19,59],[38,18,58],[37,18,57],[35,17,56],[34,17,55],[32,16,54],[31,16,54],[29,15,53],[27,15,52],[26,14,51]],c_=[[255,255,229],[253,254,228],[252,253,227],[251,252,227],[249,252,226],[248,251,226],[247,250,225],[245,250,225],[244,249,224],[243,248,223],[241,248,223],[240,247,222],[239,246,222],[237,246,221],[236,245,221],[235,244,220],[233,244,220],[232,243,219],[231,242,218],[229,242,218],[228,241,217],[227,240,217],[225,240,216],[224,239,216],[223,238,215],[221,238,214],[220,237,214],[219,236,213],[218,235,213],[216,235,212],[215,234,212],[214,233,211],[212,233,211],[211,232,210],[210,231,209],[208,231,209],[207,230,208],[206,229,208],[204,229,207],[203,228,207],[202,227,206],[200,227,205],[199,226,205],[198,225,204],[196,225,204],[195,224,203],[194,223,203],[192,223,202],[191,222,202],[190,221,201],[188,221,200],[187,220,200],[186,219,199],[185,218,199],[183,218,198],[182,217,198],[181,216,197],[179,216,196],[178,215,196],[177,214,195],[175,214,195],[174,213,194],[173,212,194],[171,212,193],[170,211,193],[169,210,192],[167,210,191],[166,209,191],[165,208,190],[163,208,190],[162,207,189],[161,206,189],[159,206,188],[158,205,187],[157,204,187],[155,204,186],[154,203,186],[153,202,185],[152,201,185],[150,201,184],[149,200,184],[148,199,183],[146,199,182],[145,198,182],[144,197,181],[142,197,181],[141,196,180],[140,195,180],[138,195,179],[137,194,178],[136,193,178],[134,193,177],[133,192,177],[132,191,176],[130,191,176],[129,190,175],[128,189,175],[126,189,174],[125,188,173],[124,187,173],[122,187,172],[121,186,172],[120,185,171],[119,184,171],[117,184,170],[116,183,169],[115,182,169],[113,182,168],[112,181,168],[111,180,167],[109,180,167],[108,179,166],[107,178,166],[105,178,165],[104,177,164],[103,176,164],[101,176,163],[100,175,163],[99,174,162],[97,174,162],[96,173,161],[95,172,160],[93,172,160],[92,171,159],[91,170,159],[89,170,158],[88,169,158],[87,168,157],[86,167,157],[84,167,156],[83,166,155],[82,165,155],[80,165,154],[79,164,154],[78,163,153],[76,163,153],[75,162,152],[74,161,151],[72,161,151],[71,160,150],[70,159,150],[68,159,149],[67,158,149],[66,157,148],[64,157,148],[63,156,147],[62,155,146],[60,155,146],[59,154,145],[58,153,145],[56,153,144],[55,152,144],[54,151,143],[53,151,143],[52,150,142],[51,149,141],[51,148,140],[50,147,139],[50,146,138],[49,145,137],[49,144,136],[48,143,135],[48,142,134],[47,142,133],[47,141,132],[46,140,131],[46,139,130],[45,138,129],[45,137,129],[44,136,128],[44,135,127],[43,134,126],[43,134,125],[42,133,124],[42,132,123],[41,131,122],[41,130,121],[40,129,120],[40,128,119],[39,127,118],[38,126,117],[38,126,116],[37,125,115],[37,124,115],[36,123,114],[36,122,113],[35,121,112],[35,120,111],[34,119,110],[34,118,109],[33,117,108],[33,117,107],[32,116,106],[32,115,105],[31,114,104],[31,113,103],[30,112,102],[30,111,102],[29,110,101],[29,109,100],[28,109,99],[28,108,98],[27,107,97],[27,106,96],[26,105,95],[25,104,94],[25,103,93],[24,102,92],[24,101,91],[23,101,90],[23,100,89],[22,99,88],[22,98,88],[21,97,87],[21,96,86],[20,95,85],[20,94,84],[19,93,83],[19,93,82],[18,92,81],[18,91,80],[17,90,79],[17,89,78],[16,88,77],[16,87,76],[15,86,75],[15,85,75],[14,84,74],[14,84,73],[13,83,72],[12,82,71],[12,81,70],[11,80,69],[11,79,68],[10,78,67],[10,77,66],[9,76,65],[9,76,64],[8,75,63],[8,74,62],[7,73,61],[7,72,61],[6,71,60],[6,70,59],[5,69,58],[5,68,57],[4,68,56],[4,67,55],[3,66,54],[3,65,53],[2,64,52],[2,63,51],[1,62,50],[1,61,49],[0,60,48],[0,60,48]],u_=[[0,1,0],[1,2,2],[1,3,4],[2,4,6],[3,5,9],[3,6,11],[4,7,13],[4,9,14],[5,10,16],[5,11,17],[6,12,19],[6,13,20],[7,14,21],[8,15,23],[8,16,24],[9,16,25],[10,17,26],[10,18,27],[11,19,28],[11,20,30],[11,20,31],[12,21,32],[12,22,33],[12,23,34],[12,23,36],[13,24,37],[13,25,38],[13,25,39],[13,26,41],[13,27,42],[13,28,43],[13,28,44],[13,29,46],[14,30,47],[14,31,48],[14,31,50],[14,32,51],[14,33,52],[14,34,54],[15,35,55],[15,35,56],[15,36,58],[15,37,59],[15,38,60],[15,39,62],[16,40,63],[16,40,65],[16,41,66],[16,42,67],[17,43,69],[17,44,70],[17,45,72],[17,45,73],[18,46,75],[18,47,76],[18,48,77],[18,49,79],[19,50,80],[19,51,82],[19,52,83],[20,53,85],[20,54,86],[20,54,88],[21,55,89],[21,56,91],[21,57,92],[22,58,94],[22,59,95],[22,60,97],[23,61,98],[23,62,100],[24,63,101],[24,64,103],[24,65,104],[25,65,106],[25,66,107],[26,67,109],[26,68,110],[27,69,112],[27,70,113],[28,71,115],[28,72,116],[29,73,118],[29,74,120],[30,75,121],[30,76,123],[31,77,124],[32,78,126],[32,79,127],[33,80,129],[34,80,130],[34,81,132],[35,82,134],[36,83,135],[36,84,137],[37,85,138],[38,86,140],[39,87,141],[40,88,143],[40,89,145],[41,90,146],[42,91,148],[43,92,149],[44,93,151],[45,94,153],[46,95,154],[47,96,156],[48,97,157],[50,99,159],[51,100,161],[52,101,162],[53,102,164],[55,103,165],[56,104,167],[57,105,169],[59,106,170],[60,108,172],[62,109,173],[63,110,175],[65,111,176],[66,112,178],[68,114,179],[69,115,180],[71,116,182],[72,117,183],[74,119,184],[76,120,185],[77,121,187],[79,122,188],[81,123,189],[82,125,190],[84,126,191],[86,127,192],[87,128,193],[89,129,193],[90,130,194],[92,131,195],[94,133,196],[95,134,196],[97,135,197],[98,136,197],[99,137,198],[101,138,198],[102,139,199],[104,139,199],[105,140,199],[106,141,200],[108,142,200],[109,143,200],[110,144,200],[112,145,200],[113,146,201],[114,146,201],[116,147,201],[117,148,201],[118,149,201],[119,150,201],[121,150,201],[122,151,201],[123,152,201],[124,153,201],[125,153,201],[127,154,201],[128,155,201],[129,156,201],[130,156,201],[131,157,201],[132,158,201],[134,159,201],[135,159,201],[136,160,201],[137,161,201],[138,161,201],[140,162,201],[141,163,201],[142,164,201],[143,164,201],[144,165,201],[145,166,201],[147,167,201],[148,167,201],[149,168,201],[150,169,201],[151,170,201],[153,170,201],[154,171,201],[155,172,201],[156,173,201],[157,173,201],[159,174,201],[160,175,201],[161,176,201],[162,177,201],[164,177,201],[165,178,201],[166,179,201],[167,180,202],[169,181,202],[170,182,202],[171,182,202],[172,183,202],[174,184,202],[175,185,203],[176,186,203],[178,187,203],[179,188,203],[180,189,204],[182,190,204],[183,191,205],[185,192,205],[186,193,205],[187,194,206],[189,195,206],[190,196,207],[192,197,208],[193,199,208],[195,200,209],[196,201,209],[198,202,210],[199,203,211],[200,205,212],[202,206,213],[203,207,213],[205,208,214],[207,210,215],[208,211,216],[210,212,217],[211,214,218],[213,215,219],[214,216,220],[216,218,221],[217,219,222],[219,221,224],[220,222,225],[222,223,226],[223,225,227],[225,226,228],[227,228,230],[228,229,231],[230,231,232],[231,232,233],[233,234,235],[234,235,236],[236,236,238],[237,238,239],[239,239,240],[241,241,242],[242,242,243],[244,244,244],[245,245,246],[247,247,247],[248,248,249],[250,250,250],[251,251,252],[253,253,253],[254,255,254]],d_=[[254,252,205],[254,251,202],[253,250,200],[252,249,198],[252,247,196],[251,246,194],[250,245,192],[250,244,190],[249,243,188],[248,241,185],[248,240,183],[247,239,181],[246,238,179],[246,237,177],[245,236,175],[244,234,173],[244,233,171],[243,232,168],[242,231,166],[242,230,164],[241,229,162],[240,227,160],[240,226,158],[239,225,156],[238,224,153],[238,223,151],[237,222,149],[236,221,147],[235,220,145],[235,219,143],[234,217,140],[233,216,138],[232,215,136],[232,214,134],[231,213,132],[230,212,129],[229,211,127],[229,210,125],[228,209,123],[227,208,121],[226,207,119],[225,206,116],[224,205,114],[223,204,112],[223,203,110],[222,202,108],[221,201,106],[220,200,103],[219,199,101],[218,198,99],[217,197,97],[216,196,95],[215,196,93],[214,195,91],[213,194,88],[212,193,86],[211,192,84],[209,191,82],[208,190,80],[207,190,78],[206,189,76],[205,188,74],[203,187,72],[202,186,70],[201,186,68],[200,185,66],[198,184,64],[197,183,62],[195,183,60],[194,182,59],[193,181,57],[191,181,55],[190,180,53],[188,179,51],[187,179,50],[185,178,48],[184,177,46],[182,177,44],[181,176,43],[179,175,41],[178,175,40],[176,174,38],[175,173,36],[173,173,35],[171,172,33],[170,171,32],[168,171,30],[167,170,29],[165,170,28],[163,169,26],[162,168,25],[160,168,23],[158,167,22],[157,167,21],[155,166,20],[153,165,18],[151,165,17],[150,164,16],[148,164,15],[146,163,14],[145,162,13],[143,162,12],[141,161,11],[139,161,10],[138,160,9],[136,159,8],[134,159,7],[132,158,7],[131,158,6],[129,157,6],[127,156,6],[125,156,5],[124,155,5],[122,155,5],[120,154,5],[118,153,5],[116,153,5],[115,152,5],[113,151,6],[111,151,6],[109,150,7],[107,150,7],[106,149,8],[104,148,8],[102,148,9],[100,147,9],[98,146,10],[97,146,11],[95,145,12],[93,145,12],[91,144,13],[89,143,14],[87,143,15],[86,142,16],[84,141,16],[82,141,17],[80,140,18],[78,139,19],[76,139,20],[75,138,20],[73,137,21],[71,137,22],[69,136,23],[67,135,23],[66,134,24],[64,134,25],[62,133,26],[60,132,26],[59,131,27],[57,131,28],[55,130,28],[53,129,29],[52,129,30],[50,128,30],[48,127,31],[46,126,32],[45,125,32],[43,125,33],[42,124,33],[40,123,34],[38,122,35],[37,121,35],[35,121,36],[34,120,36],[32,119,37],[31,118,37],[29,117,38],[28,117,38],[26,116,39],[25,115,39],[24,114,39],[22,113,40],[21,112,40],[20,111,40],[19,111,41],[18,110,41],[17,109,41],[16,108,42],[15,107,42],[14,106,42],[13,105,43],[13,104,43],[12,103,43],[12,103,43],[11,102,43],[11,101,44],[11,100,44],[10,99,44],[10,98,44],[10,97,44],[10,96,44],[11,95,44],[11,94,44],[11,93,44],[11,92,44],[12,92,44],[12,91,44],[12,90,44],[13,89,44],[13,88,44],[14,87,44],[14,86,44],[15,85,44],[15,84,44],[15,83,44],[16,82,43],[16,81,43],[17,80,43],[17,79,43],[18,78,43],[18,77,42],[19,76,42],[19,75,42],[20,74,42],[20,74,41],[20,73,41],[21,72,41],[21,71,40],[21,70,40],[22,69,40],[22,68,39],[22,67,39],[23,66,39],[23,65,38],[23,64,38],[23,63,37],[24,62,37],[24,61,36],[24,60,36],[24,59,35],[24,58,35],[24,57,34],[25,56,34],[25,55,33],[25,54,33],[25,53,32],[25,52,31],[25,52,31],[25,51,30],[25,50,30],[25,49,29],[25,48,28],[25,47,28],[25,46,27],[25,45,26],[24,44,26],[24,43,25],[24,42,24],[24,41,24],[24,40,23],[24,39,22],[23,38,21],[23,37,21],[23,36,20],[23,35,19],[23,35,18]],f_=[[254,254,254],[254,254,253],[253,253,251],[253,253,250],[253,253,248],[253,253,247],[253,252,245],[252,252,244],[252,252,242],[252,251,241],[251,251,239],[251,251,238],[251,250,236],[250,250,234],[250,250,233],[250,249,231],[249,249,230],[249,249,228],[248,248,227],[248,248,225],[247,247,223],[247,247,222],[246,246,220],[246,246,218],[245,245,217],[244,245,215],[244,244,213],[243,243,211],[242,243,210],[241,242,208],[240,241,206],[239,241,204],[239,240,203],[238,239,201],[236,238,199],[235,237,197],[234,236,195],[233,235,193],[232,234,191],[231,233,190],[229,232,188],[228,231,186],[226,230,184],[225,229,182],[223,228,180],[222,226,178],[220,225,176],[219,224,174],[217,222,173],[215,221,171],[213,220,169],[212,218,167],[210,217,165],[208,215,164],[206,214,162],[204,212,160],[202,211,159],[200,209,157],[198,208,156],[197,206,154],[195,205,153],[193,203,151],[191,202,150],[189,200,149],[187,199,147],[185,197,146],[183,196,145],[181,194,144],[179,193,143],[178,192,142],[176,190,142],[174,189,141],[172,187,140],[171,186,139],[169,185,139],[167,184,138],[166,182,138],[164,181,137],[162,180,137],[161,179,136],[159,178,136],[158,176,136],[156,175,135],[155,174,135],[154,173,135],[152,172,135],[151,171,135],[150,170,135],[148,169,135],[147,168,135],[146,167,135],[144,166,135],[143,166,135],[142,165,135],[141,164,135],[140,163,135],[139,162,136],[137,161,136],[136,161,136],[135,160,136],[134,159,136],[133,158,137],[132,158,137],[131,157,137],[130,156,137],[129,155,138],[128,155,138],[127,154,138],[126,153,139],[125,153,139],[124,152,139],[123,151,140],[122,151,140],[121,150,141],[120,149,141],[119,149,141],[118,148,142],[117,147,142],[116,147,143],[115,146,143],[114,146,143],[113,145,144],[112,144,144],[111,144,145],[110,143,145],[109,142,145],[108,142,146],[108,141,146],[107,141,147],[106,140,147],[105,139,147],[104,139,148],[103,138,148],[102,138,149],[101,137,149],[100,136,149],[99,136,150],[98,135,150],[97,135,150],[96,134,151],[95,133,151],[94,133,152],[94,132,152],[93,131,152],[92,131,153],[91,130,153],[90,129,153],[89,129,153],[88,128,154],[87,127,154],[86,127,154],[85,126,155],[84,125,155],[83,125,155],[82,124,155],[81,123,155],[80,122,156],[79,122,156],[78,121,156],[77,120,156],[76,119,156],[75,119,156],[74,118,156],[74,117,157],[73,116,157],[72,115,157],[71,115,157],[70,114,157],[69,113,157],[68,112,157],[67,111,157],[66,110,156],[65,109,156],[64,108,156],[63,107,156],[62,107,156],[61,106,156],[60,105,155],[59,104,155],[58,103,155],[57,102,155],[56,101,154],[55,100,154],[54,98,154],[53,97,153],[52,96,153],[51,95,152],[50,94,152],[49,93,151],[48,92,151],[47,91,150],[47,90,150],[46,89,149],[45,87,148],[44,86,148],[43,85,147],[42,84,146],[41,83,145],[40,81,145],[39,80,144],[38,79,143],[37,78,142],[37,76,141],[36,75,140],[35,74,139],[34,73,139],[33,71,138],[32,70,137],[31,69,136],[31,68,135],[30,66,133],[29,65,132],[28,64,131],[27,62,130],[27,61,129],[26,60,128],[25,58,127],[24,57,126],[24,56,124],[23,54,123],[22,53,122],[21,52,121],[21,50,119],[20,49,118],[19,48,117],[18,46,116],[18,45,114],[17,44,113],[16,43,112],[15,41,110],[15,40,109],[14,39,108],[13,37,106],[12,36,105],[12,35,103],[11,33,102],[10,32,101],[9,31,99],[8,29,98],[8,28,97],[7,27,95],[6,25,94],[6,24,92],[5,23,91],[4,21,89],[4,20,88],[3,19,87],[2,17,85],[2,16,84],[1,14,82],[1,13,81],[0,12,80],[0,10,78],[0,8,77],[0,6,75],[0,5,74]];function Ql(r,e,t){const i=r.slice();return i[56]=e[t],i}function eh(r,e,t){const i=r.slice();return i[65]=e[t],i}function th(r,e,t){const i=r.slice();return i[60]=e[t],i[70]=t,i}function ih(r,e,t){const i=r.slice();return i[68]=e[t],i[70]=t,i}function nh(r,e,t){const i=r.slice();return i[68]=e[t],i[70]=t,i}function rh(r,e,t){const i=r.slice();return i[59]=e[t][0],i[60]=e[t][1],i}function sh(r,e,t){const i=r.slice();return i[59]=e[t][0],i[60]=e[t][1],i}function g_(r){let e,t,i,n=mt(r[18]),s=[];for(let o=0;o<n.length;o+=1)s[o]=dh(eh(r,n,o));return{c(){e=D("div");for(let o=0;o<s.length;o+=1)s[o].c();t=ee(),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=G(e);for(let l=0;l<s.length;l+=1)s[l].l(a);t=te(a),a.forEach(w),this.h()},h(){I(e,"class",i="grid grid-cols-1 "+(r[4]?"grid-cols-1":"grid-cols-[40px_40px] p-1")+" "+(r[7]?"":"mt-1")+" place-items-center")},m(o,a){F(o,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);b(e,t)},p(o,a){if(a[0]&829311){n=mt(o[18]);let l;for(l=0;l<n.length;l+=1){const h=eh(o,n,l);s[l]?s[l].p(h,a):(s[l]=dh(h),s[l].c(),s[l].m(e,t))}for(;l<s.length;l+=1)s[l].d(1);s.length=n.length}a[0]&144&&i!==(i="grid grid-cols-1 "+(o[4]?"grid-cols-1":"grid-cols-[40px_40px] p-1")+" "+(o[7]?"":"mt-1")+" place-items-center")&&I(e,"class",i)},d(o){o&&w(e),vi(s,o)}}}function __(r){let e,t,i,n,s,o,a,l,h,c,u='<label for="custom_bounds_input" class="flex variant-outline-tertiary p-1" title="Set custom maximum bound">Custom Min:</label>',d,f,g,_,m,y,p='<label for="custom_bounds_input" class="flex variant-outline-tertiary p-1" title="Set custom maximum bound">Custom Max:</label>',T,E,x,v,C,R,S='<div class="h-full flex-center variant-outline-tertiary p-1">Steps:</div>',P,O,N,V,U,L,k,Q='<div class="flex variant-outline-tertiary p-1 h-full flex-center" title="Select color scheme">Color Scheme:</div>',q,ie,J,Z,fe,Ie,X,De,Re,K;function ce(ae,ve){return ae[3]?F_:k_}let Ke=ce(r),me=Ke(r);function Ve(ae,ve){return ae[4]?G_:N_}let Se=Ve(r),ge=Se(r);function Ee(ae,ve){if(ae[11]=="divergent"||ae[11]=="divergent_individual")return z_;if(ae[11]=="sequential")return U_}let Ze=Ee(r),Te=Ze&&Ze(r);return{c(){e=D("div"),t=D("div"),i=D("div"),me.c(),s=ee(),o=D("div"),ge.c(),l=ee(),h=D("div"),c=D("nobr"),c.innerHTML=u,d=ee(),f=D("input"),_=ee(),m=D("div"),y=D("nobr"),y.innerHTML=p,T=ee(),E=D("input"),v=ee(),C=D("div"),R=D("nobr"),R.innerHTML=S,P=ee(),O=D("input"),U=ee(),L=D("div"),k=D("nobr"),k.innerHTML=Q,q=ee(),ie=D("select"),Te&&Te.c(),De=ee(),this.h()},l(ae){e=M(ae,"DIV",{class:!0});var ve=G(e);t=M(ve,"DIV",{class:!0});var Pe=G(t);i=M(Pe,"DIV",{class:!0});var ot=G(i);me.l(ot),ot.forEach(w),s=te(Pe),o=M(Pe,"DIV",{class:!0});var it=G(o);ge.l(it),it.forEach(w),l=te(Pe),h=M(Pe,"DIV",{class:!0});var z=G(h);c=M(z,"NOBR",{"data-svelte-h":!0}),Le(c)!=="svelte-tpl90h"&&(c.innerHTML=u),d=te(z),f=M(z,"INPUT",{id:!0,class:!0}),z.forEach(w),_=te(Pe),m=M(Pe,"DIV",{class:!0});var oe=G(m);y=M(oe,"NOBR",{"data-svelte-h":!0}),Le(y)!=="svelte-cg8u4r"&&(y.innerHTML=p),T=te(oe),E=M(oe,"INPUT",{id:!0,class:!0}),oe.forEach(w),v=te(Pe),C=M(Pe,"DIV",{class:!0});var j=G(C);R=M(j,"NOBR",{"data-svelte-h":!0}),Le(R)!=="svelte-13pxheq"&&(R.innerHTML=S),P=te(j),O=M(j,"INPUT",{type:!0,id:!0,class:!0,max:!0,min:!0,title:!0}),j.forEach(w),U=te(Pe),L=M(Pe,"DIV",{class:!0});var le=G(L);k=M(le,"NOBR",{"data-svelte-h":!0}),Le(k)!=="svelte-qdi68w"&&(k.innerHTML=Q),q=te(le),ie=M(le,"SELECT",{id:!0,class:!0});var Ae=G(ie);Te&&Te.l(Ae),Ae.forEach(w),le.forEach(w),Pe.forEach(w),ve.forEach(w),De=te(ae),this.h()},h(){I(i,"class",n="flex "+(r[4]?"md:mr-1 max-md:mb-1":"mb-1")),I(o,"class",a="flex-1 "+(r[4]?"md:mr-2 max-md:mb-1":"mb-1")),I(f,"id","custom_bounds_input"),I(f,"class","flex-1 text-black ml-1 max-w-[96px] pl-1"),I(h,"class",g="flex "+(r[4]?"md:mr-2 max-md:mb-1":"mb-1")),I(E,"id","custom_bounds_input"),I(E,"class","flex-1 text-black ml-1 max-w-[96px] pl-1"),I(m,"class",x="flex "+(r[4]?"md:mr-2 max-md:mb-1":"mb-1")),I(O,"type","number"),I(O,"id",N=r[6]+"_steps_input"),I(O,"class","flex-1 text-black ml-1 max-w-[40px] pl-1 pr-0 text-xs font-bold"),I(O,"max","21"),I(O,"min","0"),I(O,"title","Number of color stops"),I(C,"class",V="flex "+(r[4]?"md:mr-2 mr-1":"mb-1")),I(ie,"id",J=r[6]+"color_scheme_select"),I(ie,"class",Z="flex-1 text-black py-0 pr-7 text-xs font-bold "+(r[4]?"px-2 ml-1":"w-[176px] h-[32px] mt-1")),r[12]===void 0&&Gh(()=>r[35].call(ie)),I(L,"class",fe=r[4]?"flex":""),I(t,"class",Ie=(r[4]?"flex text-xs font-bold h-7":"")+" "+(r[7]&&r[8]?"mt-[2px]":"")),I(e,"class",X=r[4]?"":"pt-2 flex place-items-center p-1")},m(ae,ve){F(ae,e,ve),b(e,t),b(t,i),me.m(i,null),b(t,s),b(t,o),ge.m(o,null),b(t,l),b(t,h),b(h,c),b(h,d),b(h,f),b(t,_),b(t,m),b(m,y),b(m,T),b(m,E),b(t,v),b(t,C),b(C,R),b(C,P),b(C,O),jt(O,r[14]),b(t,U),b(t,L),b(L,k),b(L,q),b(L,ie),Te&&Te.m(ie,null),ts(ie,r[12],!0),F(ae,De,ve),Re||(K=[tt(f,"change",r[21]),tt(E,"change",r[20]),tt(O,"change",r[23]),tt(O,"input",r[34]),tt(ie,"change",r[22]),tt(ie,"change",r[35])],Re=!0)},p(ae,ve){Ke===(Ke=ce(ae))&&me?me.p(ae,ve):(me.d(1),me=Ke(ae),me&&(me.c(),me.m(i,null))),ve[0]&16&&n!==(n="flex "+(ae[4]?"md:mr-1 max-md:mb-1":"mb-1"))&&I(i,"class",n),Se===(Se=Ve(ae))&&ge?ge.p(ae,ve):(ge.d(1),ge=Se(ae),ge&&(ge.c(),ge.m(o,null))),ve[0]&16&&a!==(a="flex-1 "+(ae[4]?"md:mr-2 max-md:mb-1":"mb-1"))&&I(o,"class",a),ve[0]&16&&g!==(g="flex "+(ae[4]?"md:mr-2 max-md:mb-1":"mb-1"))&&I(h,"class",g),ve[0]&16&&x!==(x="flex "+(ae[4]?"md:mr-2 max-md:mb-1":"mb-1"))&&I(m,"class",x),ve[0]&64&&N!==(N=ae[6]+"_steps_input")&&I(O,"id",N),ve[0]&16384&&Ts(O.value)!==ae[14]&&jt(O,ae[14]),ve[0]&16&&V!==(V="flex "+(ae[4]?"md:mr-2 mr-1":"mb-1"))&&I(C,"class",V),Ze===(Ze=Ee(ae))&&Te?Te.p(ae,ve):(Te&&Te.d(1),Te=Ze&&Ze(ae),Te&&(Te.c(),Te.m(ie,null))),ve[0]&64&&J!==(J=ae[6]+"color_scheme_select")&&I(ie,"id",J),ve[0]&16&&Z!==(Z="flex-1 text-black py-0 pr-7 text-xs font-bold "+(ae[4]?"px-2 ml-1":"w-[176px] h-[32px] mt-1"))&&I(ie,"class",Z),ve[0]&69632&&ts(ie,ae[12]),ve[0]&16&&fe!==(fe=ae[4]?"flex":"")&&I(L,"class",fe),ve[0]&400&&Ie!==(Ie=(ae[4]?"flex text-xs font-bold h-7":"")+" "+(ae[7]&&ae[8]?"mt-[2px]":""))&&I(t,"class",Ie),ve[0]&16&&X!==(X=ae[4]?"":"pt-2 flex place-items-center p-1")&&I(e,"class",X)},d(ae){ae&&(w(e),w(De)),me.d(),ge.d(),Te&&Te.d(),Re=!1,xs(K)}}}function m_(r){let e,t,i=r[5],n,s=ah(r);return{c(){e=D("div"),t=D("div"),s.c(),this.h()},l(o){e=M(o,"DIV",{class:!0});var a=G(e);t=M(a,"DIV",{class:!0});var l=G(t);s.l(l),l.forEach(w),a.forEach(w),this.h()},h(){I(t,"class",n=r[4]?"flex items-center":""),I(e,"class","text-[13px] font-bold")},m(o,a){F(o,e,a),b(e,t),s.m(t,null)},p(o,a){a[0]&32&&Yi(i,i=o[5])?(s.d(1),s=ah(o),s.c(),s.m(t,null)):s.p(o,a),a[0]&16&&n!==(n=o[4]?"flex items-center":"")&&I(t,"class",n)},d(o){o&&w(e),s.d(o)}}}function p_(r){let e;function t(s,o){return s[10]?I_:b_}let i=t(r),n=i(r);return{c(){e=D("div"),n.c()},l(s){e=M(s,"DIV",{});var o=G(e);n.l(o),o.forEach(w)},m(s,o){F(s,e,o),n.m(e,null)},p(s,o){i===(i=t(s))&&n?n.p(s,o):(n.d(1),n=i(s),n&&(n.c(),n.m(e,null)))},d(s){s&&w(e),n.d()}}}function y_(r){let e,t=r[60].toFixed(r[9])+"",i,n;return{c(){e=D("div"),i=W(t),this.h()},l(s){e=M(s,"DIV",{class:!0});var o=G(e);i=Y(o,t),o.forEach(w),this.h()},h(){I(e,"class",n="flex items-center justify-center w-["+r[13]+"px] h-[20px]")},m(s,o){F(s,e,o),b(e,i)},p(s,o){o[0]&33280&&t!==(t=s[60].toFixed(s[9])+"")&&pe(i,t),o[0]&8192&&n!==(n="flex items-center justify-center w-["+s[13]+"px] h-[20px]")&&I(e,"class",n)},d(s){s&&w(e)}}}function E_(r){let e;function t(s,o){return T_}let n=t()(r);return{c(){n.c(),e=Ge()},l(s){n.l(s),e=Ge()},m(s,o){n.m(s,o),F(s,e,o)},p(s,o){n.p(s,o)},d(s){s&&w(e),n.d(s)}}}function T_(r){let e,t,i;function n(a,l){return l[0]&32768&&(e=null),l[0]&32768&&(t=null),a[70]==0?R_:(e==null&&(e=Math.floor(a[15].length/2)-2==a[70]||a[70]==Math.floor(a[15].length/2)),e?C_:(t==null&&(t=a[70]==Math.floor(a[15].length/2)-1),t?w_:a[70]==a[15].length-1?v_:x_))}let s=n(r,[-1,-1,-1]),o=s(r);return{c(){o.c(),i=Ge()},l(a){o.l(a),i=Ge()},m(a,l){o.m(a,l),F(a,i,l)},p(a,l){s===(s=n(a,l))&&o?o.p(a,l):(o.d(1),o=s(a),o&&(o.c(),o.m(i.parentNode,i)))},d(a){a&&w(i),o.d(a)}}}function x_(r){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{style:!0}),G(e).forEach(w),this.h()},h(){Ct(e,"width",r[13]+"px")},m(t,i){F(t,e,i)},p(t,i){i[0]&8192&&Ct(e,"width",t[13]+"px")},d(t){t&&w(e)}}}function v_(r){let e,t=r[60].toFixed(r[9])+"",i;return{c(){e=D("div"),i=W(t),this.h()},l(n){e=M(n,"DIV",{style:!0});var s=G(e);i=Y(s,t),s.forEach(w),this.h()},h(){Ct(e,"width",r[13]+"px")},m(n,s){F(n,e,s),b(e,i)},p(n,s){s[0]&33280&&t!==(t=n[60].toFixed(n[9])+"")&&pe(i,t),s[0]&8192&&Ct(e,"width",n[13]+"px")},d(n){n&&w(e)}}}function w_(r){let e,t;return{c(){e=D("div"),t=W("  |"),this.h()},l(i){e=M(i,"DIV",{style:!0});var n=G(e);t=Y(n,"  |"),n.forEach(w),this.h()},h(){Ct(e,"width",r[13]+"px"),Ct(e,"padding-left",Math.floor(r[13]/2)-8+"px")},m(i,n){F(i,e,n),b(e,t)},p(i,n){n[0]&8192&&Ct(e,"width",i[13]+"px"),n[0]&8192&&Ct(e,"padding-left",Math.floor(i[13]/2)-8+"px")},d(i){i&&w(e)}}}function C_(r){let e,t=r[60].toFixed(r[9])+"",i;return{c(){e=D("div"),i=W(t),this.h()},l(n){e=M(n,"DIV",{style:!0});var s=G(e);i=Y(s,t),s.forEach(w),this.h()},h(){Ct(e,"width",r[13]+"px"),Ct(e,"padding-left",Math.floor(r[13]/2)-8+"px")},m(n,s){F(n,e,s),b(e,i)},p(n,s){s[0]&33280&&t!==(t=n[60].toFixed(n[9])+"")&&pe(i,t),s[0]&8192&&Ct(e,"width",n[13]+"px"),s[0]&8192&&Ct(e,"padding-left",Math.floor(n[13]/2)-8+"px")},d(n){n&&w(e)}}}function R_(r){let e,t=r[60].toFixed(r[9])+"",i;return{c(){e=D("div"),i=W(t),this.h()},l(n){e=M(n,"DIV",{style:!0});var s=G(e);i=Y(s,t),s.forEach(w),this.h()},h(){Ct(e,"width",r[13]+"px")},m(n,s){F(n,e,s),b(e,i)},p(n,s){s[0]&33280&&t!==(t=n[60].toFixed(n[9])+"")&&pe(i,t),s[0]&8192&&Ct(e,"width",n[13]+"px")},d(n){n&&w(e)}}}function oh(r){let e;function t(s,o){return s[4]?E_:y_}let i=t(r),n=i(r);return{c(){n.c(),e=Ge()},l(s){n.l(s),e=Ge()},m(s,o){n.m(s,o),F(s,e,o)},p(s,o){i===(i=t(s))&&n?n.p(s,o):(n.d(1),n=i(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&w(e),n.d(s)}}}function ah(r){let e,t=mt(r[15]),i=[];for(let n=0;n<t.length;n+=1)i[n]=oh(th(r,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=Ge()},l(n){for(let s=0;s<i.length;s+=1)i[s].l(n);e=Ge()},m(n,s){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,s);F(n,e,s)},p(n,s){if(s[0]&41488){t=mt(n[15]);let o;for(o=0;o<t.length;o+=1){const a=th(n,t,o);i[o]?i[o].p(a,s):(i[o]=oh(a),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=t.length}},d(n){n&&w(e),vi(i,n)}}}function b_(r){let e,t=r[5],i,n=hh(r);return{c(){e=D("div"),n.c(),this.h()},l(s){e=M(s,"DIV",{class:!0});var o=G(e);n.l(o),o.forEach(w),this.h()},h(){I(e,"class",i=(r[4]?"flex items-center":"")+" "+(r[8],""))},m(s,o){F(s,e,o),n.m(e,null)},p(s,o){o[0]&32&&Yi(t,t=s[5])?(n.d(1),n=hh(s),n.c(),n.m(e,null)):n.p(s,o),o[0]&272&&i!==(i=(s[4]?"flex items-center":"")+" "+(s[8],""))&&I(e,"class",i)},d(s){s&&w(e),n.d(s)}}}function I_(r){let e,t=r[5],i,n=uh(r);return{c(){e=D("div"),n.c(),this.h()},l(s){e=M(s,"DIV",{class:!0});var o=G(e);n.l(o),o.forEach(w),this.h()},h(){I(e,"class",i=(r[4]?"flex items-center":"")+" "+(r[8],""))},m(s,o){F(s,e,o),n.m(e,null)},p(s,o){o[0]&32&&Yi(t,t=s[5])?(n.d(1),n=uh(s),n.c(),n.m(e,null)):n.p(s,o),o[0]&272&&i!==(i=(s[4]?"flex items-center":"")+" "+(s[8],""))&&I(e,"class",i)},d(s){s&&w(e),n.d(s)}}}function S_(r){let e,t,i;return{c(){e=Ft("rect"),this.h()},l(n){e=Nt(n,"rect",{width:!0,height:!0,fill:!0,x:!0,y:!0}),G(e).forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20"),I(e,"fill",i=r[19](r[68])),I(e,"x","0"),I(e,"y","0")},m(n,s){F(n,e,s)},p(n,s){s[0]&8192&&t!==(t=n[13]+"px")&&I(e,"width",t),s[0]&32&&i!==(i=n[19](n[68]))&&I(e,"fill",i)},d(n){n&&w(e)}}}function A_(r){let e,t;return{c(){e=Ft("rect"),this.h()},l(i){e=Nt(i,"rect",{width:!0,height:!0,fill:!0,x:!0,y:!0}),G(e).forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20"),I(e,"fill","#444444"),I(e,"x","0"),I(e,"y","0")},m(i,n){F(i,e,n)},p(i,n){n[0]&8192&&t!==(t=i[13]+"px")&&I(e,"width",t)},d(i){i&&w(e)}}}function L_(r){let e;function t(s,o){return s[3]&&s[2]<s[15][s[70]]?M_:D_}let i=t(r),n=i(r);return{c(){n.c(),e=Ge()},l(s){n.l(s),e=Ge()},m(s,o){n.m(s,o),F(s,e,o)},p(s,o){i===(i=t(s))&&n?n.p(s,o):(n.d(1),n=i(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&w(e),n.d(s)}}}function D_(r){let e,t,i;return{c(){e=Ft("rect"),this.h()},l(n){e=Nt(n,"rect",{width:!0,height:!0,fill:!0,x:!0,y:!0}),G(e).forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20"),I(e,"fill",i=r[19](r[68])),I(e,"x","0"),I(e,"y","0")},m(n,s){F(n,e,s)},p(n,s){s[0]&8192&&t!==(t=n[13]+"px")&&I(e,"width",t),s[0]&32&&i!==(i=n[19](n[68]))&&I(e,"fill",i)},d(n){n&&w(e)}}}function M_(r){let e,t;return{c(){e=Ft("rect"),this.h()},l(i){e=Nt(i,"rect",{width:!0,height:!0,fill:!0,x:!0,y:!0}),G(e).forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20"),I(e,"fill","#444444"),I(e,"x","0"),I(e,"y","0")},m(i,n){F(i,e,n)},p(i,n){n[0]&8192&&t!==(t=i[13]+"px")&&I(e,"width",t)},d(i){i&&w(e)}}}function lh(r){let e,t;function i(o,a){return o[70]==o[5].length-1?L_:o[3]&&(o[1]>o[15][o[70]+1]||o[2]<o[15][o[70]])?A_:S_}let n=i(r),s=n(r);return{c(){e=Ft("svg"),s.c(),this.h()},l(o){e=Nt(o,"svg",{width:!0,height:!0});var a=G(e);s.l(a),a.forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20")},m(o,a){F(o,e,a),s.m(e,null)},p(o,a){n===(n=i(o))&&s?s.p(o,a):(s.d(1),s=n(o),s&&(s.c(),s.m(e,null))),a[0]&8192&&t!==(t=o[13]+"px")&&I(e,"width",t)},d(o){o&&w(e),s.d()}}}function hh(r){let e,t=mt(r[5]),i=[];for(let n=0;n<t.length;n+=1)i[n]=lh(ih(r,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=Ge()},l(n){for(let s=0;s<i.length;s+=1)i[s].l(n);e=Ge()},m(n,s){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,s);F(n,e,s)},p(n,s){if(s[0]&565294){t=mt(n[5]);let o;for(o=0;o<t.length;o+=1){const a=ih(n,t,o);i[o]?i[o].p(a,s):(i[o]=lh(a),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=t.length}},d(n){n&&w(e),vi(i,n)}}}function P_(r){let e,t,i;return{c(){e=Ft("rect"),this.h()},l(n){e=Nt(n,"rect",{width:!0,height:!0,fill:!0,x:!0,y:!0}),G(e).forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20"),I(e,"fill",i=r[19](r[68])),I(e,"x","0"),I(e,"y","0")},m(n,s){F(n,e,s)},p(n,s){s[0]&8192&&t!==(t=n[13]+"px")&&I(e,"width",t),s[0]&32&&i!==(i=n[19](n[68]))&&I(e,"fill",i)},d(n){n&&w(e)}}}function O_(r){let e,t;return{c(){e=Ft("rect"),this.h()},l(i){e=Nt(i,"rect",{width:!0,height:!0,fill:!0,x:!0,y:!0}),G(e).forEach(w),this.h()},h(){I(e,"width",t=r[13]+"px"),I(e,"height","20"),I(e,"fill","#444444"),I(e,"x","0"),I(e,"y","0")},m(i,n){F(i,e,n)},p(i,n){n[0]&8192&&t!==(t=i[13]+"px")&&I(e,"width",t)},d(i){i&&w(e)}}}function ch(r){let e,t,i,n,s,o=r[15][r[70]]+"",a,l,h=(r[0]>r[15][r[70]])+"",c,u,d=typeof r[15][r[70]],f,g,_=typeof r[0],m,y,p;function T(v,C){return v[3]&&(v[1]>=v[15][v[70]]||v[2]<=v[15][v[70]])?O_:P_}let E=T(r),x=E(r);return{c(){e=Ft("stop"),n=W(r[0]),s=W(":"),a=W(o),l=W(":"),c=W(h),u=W(":"),f=W(d),g=W(":"),m=W(_),y=Ft("svg"),x.c(),this.h()},l(v){e=Nt(v,"stop",{offset:!0,"stop-color":!0}),G(e).forEach(w),n=Y(v,r[0]),s=Y(v,":"),a=Y(v,o),l=Y(v,":"),c=Y(v,h),u=Y(v,":"),f=Y(v,d),g=Y(v,":"),m=Y(v,_),y=Nt(v,"svg",{width:!0,height:!0});var C=G(y);x.l(C),C.forEach(w),this.h()},h(){I(e,"offset",t=(r[70]+1)*100/r[5].length+"%"),I(e,"stop-color",i=r[19](r[68])),I(y,"width",p=r[13]+"px"),I(y,"height","20")},m(v,C){F(v,e,C),F(v,n,C),F(v,s,C),F(v,a,C),F(v,l,C),F(v,c,C),F(v,u,C),F(v,f,C),F(v,g,C),F(v,m,C),F(v,y,C),x.m(y,null)},p(v,C){C[0]&32&&t!==(t=(v[70]+1)*100/v[5].length+"%")&&I(e,"offset",t),C[0]&32&&i!==(i=v[19](v[68]))&&I(e,"stop-color",i),C[0]&1&&pe(n,v[0]),C[0]&32768&&o!==(o=v[15][v[70]]+"")&&pe(a,o),C[0]&32769&&h!==(h=(v[0]>v[15][v[70]])+"")&&pe(c,h),C[0]&32768&&d!==(d=typeof v[15][v[70]])&&pe(f,d),C[0]&1&&_!==(_=typeof v[0])&&pe(m,_),E===(E=T(v))&&x?x.p(v,C):(x.d(1),x=E(v),x&&(x.c(),x.m(y,null))),C[0]&8192&&p!==(p=v[13]+"px")&&I(y,"width",p)},d(v){v&&(w(e),w(n),w(s),w(a),w(l),w(c),w(u),w(f),w(g),w(m),w(y)),x.d()}}}function uh(r){let e,t,i,n,s,o,a,l=mt(r[5]),h=[];for(let c=0;c<l.length;c+=1)h[c]=ch(nh(r,l,c));return{c(){e=Ft("svg"),t=Ft("linearGradient");for(let c=0;c<h.length;c+=1)h[c].c();n=Ft("rect"),this.h()},l(c){e=Nt(c,"svg",{width:!0,height:!0});var u=G(e);t=Nt(u,"linearGradient",{id:!0,x1:!0,x2:!0,y1:!0,y2:!0});var d=G(t);for(let f=0;f<h.length;f+=1)h[f].l(d);d.forEach(w),n=Nt(u,"rect",{width:!0,height:!0,fill:!0}),G(n).forEach(w),u.forEach(w),this.h()},h(){I(t,"id",i=r[6]+"_grad1"),I(t,"x1","0%"),I(t,"x2","100%"),I(t,"y1","0%"),I(t,"y2","0%"),I(n,"width",s=r[13]*r[5].length+"px"),I(n,"height","20px"),I(n,"fill",o="url(#"+r[6]+"_grad1)"),I(e,"width",a=r[13]*r[5].length+"px"),I(e,"height","20px")},m(c,u){F(c,e,u),b(e,t);for(let d=0;d<h.length;d+=1)h[d]&&h[d].m(t,null);b(e,n)},p(c,u){if(u[0]&565295){l=mt(c[5]);let d;for(d=0;d<l.length;d+=1){const f=nh(c,l,d);h[d]?h[d].p(f,u):(h[d]=ch(f),h[d].c(),h[d].m(t,null))}for(;d<h.length;d+=1)h[d].d(1);h.length=l.length}u[0]&64&&i!==(i=c[6]+"_grad1")&&I(t,"id",i),u[0]&8224&&s!==(s=c[13]*c[5].length+"px")&&I(n,"width",s),u[0]&64&&o!==(o="url(#"+c[6]+"_grad1)")&&I(n,"fill",o),u[0]&8224&&a!==(a=c[13]*c[5].length+"px")&&I(e,"width",a)},d(c){c&&w(e),vi(h,c)}}}function dh(r){let e;function t(s,o){if(s[65]=="colors")return p_;if(s[65]=="numbers")return m_}let i=t(r),n=i&&i(r);return{c(){n&&n.c(),e=Ge()},l(s){n&&n.l(s),e=Ge()},m(s,o){n&&n.m(s,o),F(s,e,o)},p(s,o){n&&n.p(s,o)},d(s){s&&w(e),n&&n.d(s)}}}function k_(r){let e,t,i,n,s;return{c(){e=D("button"),t=W("Show bounds"),this.h()},l(o){e=M(o,"BUTTON",{class:!0,title:!0});var a=G(e);t=Y(a,"Show bounds"),a.forEach(w),this.h()},h(){I(e,"class",i="variant-filled-tertiary hover:bg-tertiary-600 p-1 w-28 "+(r[4]?"h-[28px]":"")),I(e,"title","Show only color stops within bounds")},m(o,a){F(o,e,a),b(e,t),n||(s=tt(e,"click",r[31]),n=!0)},p(o,a){a[0]&16&&i!==(i="variant-filled-tertiary hover:bg-tertiary-600 p-1 w-28 "+(o[4]?"h-[28px]":""))&&I(e,"class",i)},d(o){o&&w(e),n=!1,s()}}}function F_(r){let e,t,i,n,s;return{c(){e=D("button"),t=W("Show all"),this.h()},l(o){e=M(o,"BUTTON",{class:!0,title:!0});var a=G(e);t=Y(a,"Show all"),a.forEach(w),this.h()},h(){I(e,"class",i="variant-filled-tertiary hover:bg-tertiary-600 p-1 w-28 "+(r[4]?"h-[28px]":"")),I(e,"title","Show all color stops")},m(o,a){F(o,e,a),b(e,t),n||(s=tt(e,"click",r[30]),n=!0)},p(o,a){a[0]&16&&i!==(i="variant-filled-tertiary hover:bg-tertiary-600 p-1 w-28 "+(o[4]?"h-[28px]":""))&&I(e,"class",i)},d(o){o&&w(e),n=!1,s()}}}function N_(r){let e,t="Vertical",i,n;return{c(){e=D("button"),e.textContent=t,this.h()},l(s){e=M(s,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Le(e)!=="svelte-6iz5xs"&&(e.textContent=t),this.h()},h(){I(e,"class","variant-filled-tertiary hover:bg-tertiary-600 p-1 w-28"),I(e,"title","Switch to vertical legend layout")},m(s,o){F(s,e,o),i||(n=tt(e,"click",r[33]),i=!0)},p:st,d(s){s&&w(e),i=!1,n()}}}function G_(r){let e,t="Horizontal",i,n;return{c(){e=D("button"),e.textContent=t,this.h()},l(s){e=M(s,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),Le(e)!=="svelte-zb3h6r"&&(e.textContent=t),this.h()},h(){I(e,"class","variant-filled-tertiary hover:bg-tertiary-600 p-1 w-28 h-[28px]"),I(e,"title","Switch to horizontal legend layout")},m(s,o){F(s,e,o),i||(n=tt(e,"click",r[32]),i=!0)},p:st,d(s){s&&w(e),i=!1,n()}}}function U_(r){let e,t=mt(Object.entries(r[16]).filter(ph)),i=[];for(let n=0;n<t.length;n+=1)i[n]=fh(rh(r,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=Ge()},l(n){for(let s=0;s<i.length;s+=1)i[s].l(n);e=Ge()},m(n,s){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,s);F(n,e,s)},p(n,s){if(s[0]&65536){t=mt(Object.entries(n[16]).filter(ph));let o;for(o=0;o<t.length;o+=1){const a=rh(n,t,o);i[o]?i[o].p(a,s):(i[o]=fh(a),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=t.length}},d(n){n&&w(e),vi(i,n)}}}function z_(r){let e,t=mt(Object.entries(r[16]).filter(mh)),i=[];for(let n=0;n<t.length;n+=1)i[n]=gh(sh(r,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=Ge()},l(n){for(let s=0;s<i.length;s+=1)i[s].l(n);e=Ge()},m(n,s){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,s);F(n,e,s)},p(n,s){if(s[0]&65536){t=mt(Object.entries(n[16]).filter(mh));let o;for(o=0;o<t.length;o+=1){const a=sh(n,t,o);i[o]?i[o].p(a,s):(i[o]=gh(a),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=t.length}},d(n){n&&w(e),vi(i,n)}}}function fh(r){let e,t=r[60].name+"",i;return{c(){e=D("option"),i=W(t),this.h()},l(n){e=M(n,"OPTION",{});var s=G(e);i=Y(s,t),s.forEach(w),this.h()},h(){e.__value=r[59],jt(e,e.__value)},m(n,s){F(n,e,s),b(e,i)},p:st,d(n){n&&w(e)}}}function gh(r){let e,t=r[60].name+"",i;return{c(){e=D("option"),i=W(t),this.h()},l(n){e=M(n,"OPTION",{});var s=G(e);i=Y(s,t),s.forEach(w),this.h()},h(){e.__value=r[59],jt(e,e.__value)},m(n,s){F(n,e,s),b(e,i)},p:st,d(n){n&&w(e)}}}function _h(r){let e;function t(s,o){if(s[56]=="tools")return __;if(s[56]=="colors")return g_}let i=t(r),n=i&&i(r);return{c(){n&&n.c(),e=Ge()},l(s){n&&n.l(s),e=Ge()},m(s,o){n&&n.m(s,o),F(s,e,o)},p(s,o){n&&n.p(s,o)},d(s){s&&w(e),n&&n.d(s)}}}function B_(r){let e,t,i,n,s=mt(r[17]),o=[];for(let a=0;a<s.length;a+=1)o[a]=_h(Ql(r,s,a));return{c(){e=D("div"),t=D("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=M(a,"DIV",{id:!0,class:!0});var l=G(e);t=M(l,"DIV",{class:!0});var h=G(t);for(let c=0;c<o.length;c+=1)o[c].l(h);h.forEach(w),l.forEach(w),this.h()},h(){I(t,"class",i="grid grid-cols-1 place-items-center "+(r[4]?"grid-cols-1 w-full":"w-full")),I(e,"id",r[6]),I(e,"class",n="p-1 "+(r[4]?"w-full":"w-[260px]"))},m(a,l){F(a,e,l),b(e,t);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null)},p(a,l){if(l[0]&16777215){s=mt(a[17]);let h;for(h=0;h<s.length;h+=1){const c=Ql(a,s,h);o[h]?o[h].p(c,l):(o[h]=_h(c),o[h].c(),o[h].m(t,null))}for(;h<o.length;h+=1)o[h].d(1);o.length=s.length}l[0]&16&&i!==(i="grid grid-cols-1 place-items-center "+(a[4]?"grid-cols-1 w-full":"w-full"))&&I(t,"class",i),l[0]&64&&I(e,"id",a[6]),l[0]&16&&n!==(n="p-1 "+(a[4]?"w-full":"w-[260px]"))&&I(e,"class",n)},i:st,o:st,d(a){a&&w(e),vi(o,a)}}}const mh=([r,e])=>e.orientation==="div",ph=([r,e])=>e.orientation==="seq";function X_(r,e,t){let i={prec_div:{scheme:e_,orientation:"div",name:"Precipitation"},chem_div:{scheme:t_,orientation:"div",name:"Chemical"},cryo_div:{scheme:i_,orientation:"div",name:"Cryosphere"},misc_div:{scheme:r_,orientation:"div",name:"Other variables"},misc_div_custom:{scheme:n_,orientation:"div",name:"Other variables cust."},slev_div:{scheme:s_,orientation:"div",name:"Sea level"},temp_div:{scheme:o_,orientation:"div",name:"Temperature"},wind_div:{scheme:a_,orientation:"div",name:"Wind"},prec_seq:{scheme:c_,orientation:"seq",name:"Precipitation"},chem_seq:{scheme:h_,orientation:"seq",name:"Chemical"},cryo_seq:{scheme:u_,orientation:"seq",name:"Cryosphere"},misc_seq:{scheme:Jl,orientation:"seq",name:"Other variables"},slev_seq:{scheme:f_,orientation:"seq",name:"Sea level"},temp_seq:{scheme:l_,orientation:"seq",name:"Temperature"},wind_seq:{scheme:d_,orientation:"seq",name:"Wind"}};const n=Fh();let{init_color_scheme:s=""}=e,{frame_id:o=""}=e,a=Jl,l,h=40,c=["tools","colors"],u=["colors","numbers"],{object_order_flip:d=!1}=e,{colorbar_order_flip:f=!1}=e,{num_digits:g=1}=e,{toggle_gradient:_=!1}=e,m=21,y=21,{cmin:p=-100}=e,{cmax:T=100}=e,{cmin_real:E=-100}=e,{cmax_real:x=100}=e,v=0,C=0,{show_in_bounds:R=!1}=e,{horizontal:S=!0}=e,P=[],{color_steps:O=[]}=e;const N=["divergent","sequential","divergent_individual","categorical"];let{data_mode:V=N[0]}=e;s!=""?fe(s):K(),d&&c.reverse(),f&&u.reverse(),Qi(()=>(window.addEventListener("resize",U),U(),()=>{window.removeEventListener("resize",U)}));const U=()=>{const z=document.getElementById(o);if(z){var oe=Math.max(0,z.offsetWidth-38);t(13,h=Math.floor(oe/m))}};var L=function(z){var oe=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(z);return oe?[parseInt(oe[1],16),parseInt(oe[2],16),parseInt(oe[3],16)]:null},k=function(z){return"#"+((1<<24)+(z[0]<<16)+(z[1]<<8)+z[2]).toString(16).slice(1)};function Q(z=p,oe=T){var j=!1;z!=p&&oe!=T&&(j=!0),t(0,p=z),t(24,T=oe),j&&K()}function q(z,oe,j=!1){t(1,E=z),t(2,x=oe);var le=Math.max(Math.abs(E),Math.abs(x));t(0,p=-le),t(24,T=le),j&&K()}function ie(z){if(!z.target)return;const oe=z.target;var j=Math.abs(parseFloat(oe.value));if(isNaN(j)){C=0,K();return}if(Math.abs(j)>=.01){C=Math.abs(j),K();return}else{C=0,K();return}}function J(z){if(!z.target)return;const oe=z.target;var j=parseFloat(oe.value);if(isNaN(j)){v=0,K();return}if(-1*Math.abs(j)<=-.01){v=-1*Math.abs(j),K();return}else{v=0,K();return}}function Z(z){if(!z.target)return;var j=z.target.value;for(const[le,Ae]of Object.entries(i))if(j==le){a=Ae.scheme,t(12,l=le),K();return}throw Error("Color scheme not imported or misspelled!")}function fe(z){for(const[oe,j]of Object.entries(i))if(z==oe){a=j.scheme,t(12,l=oe),K();return}throw Error("Color scheme not imported or misspelled!")}function Ie(z){return V=="divergent"?De(z):X(z)}function X(z){const oe=new Array(m*2);if(z=="rbg")for(let j=0;j<m;j++)oe[j*2]=P[j],oe[j*2+1]=O[j];else for(let j=0;j<m;j++)oe[j*2]=P[j],oe[j*2+1]=k(O[j]);return oe}function De(z){const oe=new Array(m*2);if(z=="rbg")for(let j=0;j<m;j++)oe[j*2]=[P[j],P[j+1]],oe[j*2+1]=L(O[j]);else for(let j=0;j<m;j++)oe[j*2]=[P[j],P[j+1]],oe[j*2+1]=O[j];return oe}function Re(z){if(!z.target)return;const oe=z.target;var j=parseInt(oe.value);if(V=="divergent"||V=="divergent_individual"){var le=m>=j?-1:1,Ae=j%2==0?1:0;m=j+Ae*le,m<3&&(m=3)}else m=j;m<2?m=2:m>41&&(m=41),t(14,y=m),K(),U()}function K(){V=="divergent"?(me(),Ve()):V=="sequential"?(ce(),Ke()):V=="divergent_individual"&&(Se(),Ze()),n("color_stops_changed",{})}function ce(){t(5,O=[]);for(var z=a.length,oe=0;oe<m;oe++){var j=Math.round(oe*(z/m));t(5,O=[...O,a[j]])}}function Ke(){t(15,P=[]),t(15,P=[...P,p]);for(let z=1;z<m;z++)t(15,P=[...P,p+z*((T-p)/m)]);t(15,P=[...P,T])}function me(){t(5,O=[]);var z=a.length,oe=Math.ceil(z/2),j=Math.floor(m/2);t(5,O=[...O,a[0]]);for(let Ae=1;Ae<j;Ae+=1){var le=Math.round(z/(m-1)*Ae);t(5,O=[...O,a[le]])}t(5,O=[...O,a[oe]]);for(let Ae=1;Ae<j;Ae+=1){var le=Math.round(z/(m-1)*Ae)+oe;t(5,O=[...O,a[le]])}t(5,O=[...O,a[a.length-1]])}function Ve(){if(!(p>T)){var z=0,oe=0;v<=-.01?z=v:z=p,C>=.01?oe=C:oe=T,t(15,P=[]);var j=Math.floor(m/2);t(15,P=[...P,z]);for(let le=1;le<j;le++)t(15,P=[...P,z+le*(Math.abs(z)/j)]);t(15,P=[...P,0]);for(let le=1;le<j+1;le++)t(15,P=[...P,le*(Math.abs(oe)/(j+1))]);t(15,P=[...P,oe])}}function Se(){me()}function ge(z=p,oe=0){for(var j=Math.floor(m/2),le=[],Ae=0;Ae<j;Ae++)le.push(p+Ae*(Math.abs(p)/j));return le}function Ee(z=10,oe=500){for(var j=[],le=Math.floor(m/2),Ae=0;Ae<le;Ae++)j.push(10+Ae*10);for(var ut=[],je=0;je<j.length;je++){var pt=j[je],$=(Math.pow(1.1,Math.pow(pt/le,1.3))-1)*100;ut.push($)}return ut}function Ze(){if(p>=0)throw new Error("cmin cant be >= 0!");var z=[];z=z.concat(ge(),[0],Ee()),t(15,P=z)}const Te=()=>{t(3,R=!R)},ae=()=>{t(3,R=!R)},ve=()=>{t(4,S=!S)},Pe=()=>{t(4,S=!S)};function ot(){y=Ts(this.value),t(14,y)}function it(){l=Nh(this),t(12,l),t(16,i)}return r.$$set=z=>{"init_color_scheme"in z&&t(25,s=z.init_color_scheme),"frame_id"in z&&t(6,o=z.frame_id),"object_order_flip"in z&&t(7,d=z.object_order_flip),"colorbar_order_flip"in z&&t(8,f=z.colorbar_order_flip),"num_digits"in z&&t(9,g=z.num_digits),"toggle_gradient"in z&&t(10,_=z.toggle_gradient),"cmin"in z&&t(0,p=z.cmin),"cmax"in z&&t(24,T=z.cmax),"cmin_real"in z&&t(1,E=z.cmin_real),"cmax_real"in z&&t(2,x=z.cmax_real),"show_in_bounds"in z&&t(3,R=z.show_in_bounds),"horizontal"in z&&t(4,S=z.horizontal),"color_steps"in z&&t(5,O=z.color_steps),"data_mode"in z&&t(11,V=z.data_mode)},[p,E,x,R,S,O,o,d,f,g,_,V,l,h,y,P,i,c,u,k,ie,J,Z,Re,T,s,U,Q,q,Ie,Te,ae,ve,Pe,ot,it]}class V_ extends Rr{constructor(e){super(),br(this,e,X_,B_,Yi,{init_color_scheme:25,frame_id:6,object_order_flip:7,colorbar_order_flip:8,num_digits:9,toggle_gradient:10,cmin:0,cmax:24,cmin_real:1,cmax_real:2,show_in_bounds:3,horizontal:4,color_steps:5,data_mode:11,handle_bar_resize:26,set_bounds:27,set_bounds_real:28,get_color_boundaries:29},null,[-1,-1,-1])}get handle_bar_resize(){return this.$$.ctx[26]}get set_bounds(){return this.$$.ctx[27]}get set_bounds_real(){return this.$$.ctx[28]}get get_color_boundaries(){return this.$$.ctx[29]}}function yh(r,e,t){const i=r.slice();return i[12]=e[t],i[14]=t,i}function Eh(r){let e,t,i="Layer slider",n,s,o,a,l,h,c,u,d=new Date(r[2][r[0]]).toDateString()+"",f,g,_,m,y,p=mt(r[1]),T=[];for(let E=0;E<p.length;E+=1)T[E]=xh(yh(r,p,E));return{c(){e=D("div"),t=D("h4"),t.textContent=i,n=ee(),s=D("div"),o=D("input"),l=ee();for(let E=0;E<T.length;E+=1)T[E].c();h=ee(),c=D("div"),u=W("Value: "),f=W(d),g=W(" || Band: "),_=W(r[0]),this.h()},l(E){e=M(E,"DIV",{class:!0});var x=G(e);t=M(x,"H4",{class:!0,"data-svelte-h":!0}),Le(t)!=="svelte-qn7mve"&&(t.textContent=i),n=te(x),s=M(x,"DIV",{class:!0});var v=G(s);o=M(v,"INPUT",{type:!0,class:!0,id:!0,min:!0,max:!0,step:!0}),l=te(v);for(let R=0;R<T.length;R+=1)T[R].l(v);v.forEach(w),h=te(x),c=M(x,"DIV",{class:!0});var C=G(c);u=Y(C,"Value: "),f=Y(C,d),g=Y(C," || Band: "),_=Y(C,r[0]),C.forEach(w),x.forEach(w),this.h()},h(){I(t,"class","h4 text-center"),I(o,"type","range"),I(o,"class","slider relative h-[20px] w-full bg-transparent svelte-1qw1pw8"),I(o,"id","slider-picker-input-slider"),I(o,"min","0"),I(o,"max",a=r[1].length-1),I(o,"step","1"),I(s,"class","relative h-[40px] mt-6"),I(c,"class","grid grid-cols-1 place-items-center"),I(e,"class","md:px-20 max-md:px-4")},m(E,x){F(E,e,x),b(e,t),b(e,n),b(e,s),b(s,o),jt(o,r[0]),b(s,l);for(let v=0;v<T.length;v+=1)T[v]&&T[v].m(s,null);b(e,h),b(e,c),b(c,u),b(c,f),b(c,g),b(c,_),m||(y=[tt(o,"change",r[7]),tt(o,"input",r[7]),tt(o,"change",function(){O1(r[3])&&r[3].apply(this,arguments)})],m=!0)},p(E,x){if(r=E,x&2&&a!==(a=r[1].length-1)&&I(o,"max",a),x&1&&jt(o,r[0]),x&18){p=mt(r[1]);let v;for(v=0;v<p.length;v+=1){const C=yh(r,p,v);T[v]?T[v].p(C,x):(T[v]=xh(C),T[v].c(),T[v].m(s,null))}for(;v<T.length;v+=1)T[v].d(1);T.length=p.length}x&5&&d!==(d=new Date(r[2][r[0]]).toDateString()+"")&&pe(f,d),x&1&&pe(_,r[0])},d(E){E&&w(e),vi(T,E),m=!1,xs(y)}}}function Th(r){let e,t=r[12]+"",i,n;return{c(){e=D("div"),i=W(t),n=ee(),this.h()},l(s){e=M(s,"DIV",{class:!0,style:!0});var o=G(e);i=Y(o,t),n=te(o),o.forEach(w),this.h()},h(){I(e,"class","top-[-20px] translate-x-[-50%] absolute flex select-none"),Ct(e,"left",r[14]/(r[1].length-1)*100+"%")},m(s,o){F(s,e,o),b(e,i),b(e,n)},p(s,o){o&2&&t!==(t=s[12]+"")&&pe(i,t),o&2&&Ct(e,"left",s[14]/(s[1].length-1)*100+"%")},d(s){s&&w(e)}}}function xh(r){let e=r[4].includes(r[14])||r[14]==r[1].length-1,t,i=e&&Th(r);return{c(){i&&i.c(),t=Ge()},l(n){i&&i.l(n),t=Ge()},m(n,s){i&&i.m(n,s),F(n,t,s)},p(n,s){s&18&&(e=n[4].includes(n[14])||n[14]==n[1].length-1),e?i?i.p(n,s):(i=Th(n),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null)},d(n){n&&w(t),i&&i.d(n)}}}function j_(r){let e,t=r[1]&&Eh(r);return{c(){t&&t.c(),e=Ge()},l(i){t&&t.l(i),e=Ge()},m(i,n){t&&t.m(i,n),F(i,e,n)},p(i,[n]){i[1]?t?t.p(i,n):(t=Eh(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:st,o:st,d(i){i&&w(e),t&&t.d(i)}}}function W_(r,e,t){if(t<=1)return!1;const n=(r-e)/(t-1);return[e,...Array(t-2).fill("").map((s,o)=>Math.round(e+n*(o+1))),r]}function Y_(r,e,t){const i=Fh();let{valMap:n}=e,{dateMap:s}=e,{onSliderChangeFunction:o=d}=e,a=[],l=0,{slider_index:h=0}=e,{slider_value:c=0}=e,{label_space:u=80}=e;Qi(()=>{window.addEventListener("resize",f),f()}),P1(()=>{window.removeEventListener("resize",f)});function d(_){t(0,h=_.target.value),n&&(t(5,c=n[h]),i("slider_changed",{}))}function f(){if(n){var _=n.length,m=document.getElementById("slider-picker-input-slider");if(!m)throw new Error("Element with id 'slider-picker-input-slider' does not exist.");if(!u||u<=0){var y="Invalid label space: "+u.toString();throw new Error(y)}var p=m.clientWidth,T=Math.floor(p/u);if(l!=T){l=T;var E=W_(_-1,0,l);E&&t(4,a=E)}}}function g(){h=Ts(this.value),t(0,h)}return r.$$set=_=>{"valMap"in _&&t(1,n=_.valMap),"dateMap"in _&&t(2,s=_.dateMap),"onSliderChangeFunction"in _&&t(3,o=_.onSliderChangeFunction),"slider_index"in _&&t(0,h=_.slider_index),"slider_value"in _&&t(5,c=_.slider_value),"label_space"in _&&t(6,u=_.label_space)},[h,n,s,o,a,c,u,g]}class C1 extends Rr{constructor(e){super(),br(this,e,Y_,j_,Yi,{valMap:1,dateMap:2,onSliderChangeFunction:3,slider_index:0,slider_value:5,label_space:6})}}function K_(r){let e,t;return{c(){e=Ft("svg"),t=Ft("path"),this.h()},l(i){e=Nt(i,"svg",{class:!0,xmlns:!0,viewBox:!0,width:!0,height:!0});var n=G(e);t=Nt(n,"path",{d:!0}),G(t).forEach(w),n.forEach(w),this.h()},h(){I(t,"d","M177.8 63.2l10 17.4c2.8 4.8 4.2 10.3 4.2 15.9l0 41.4c0 3.9 1.6 7.7 4.3 10.4c6.2 6.2 16.5 5.7 22-1.2l13.6-17c4.7-5.9 12.9-7.7 19.6-4.3l15.2 7.6c3.4 1.7 7.2 2.6 11 2.6c6.5 0 12.8-2.6 17.4-7.2l3.9-3.9c2.9-2.9 7.3-3.6 11-1.8l29.2 14.6c7.8 3.9 12.6 11.8 12.6 20.5c0 10.5-7.1 19.6-17.3 22.2l-35.4 8.8c-7.4 1.8-15.1 1.5-22.4-.9l-32-10.7c-3.3-1.1-6.7-1.7-10.2-1.7c-7 0-13.8 2.3-19.4 6.5L176 212c-10.1 7.6-16 19.4-16 32l0 28c0 26.5 21.5 48 48 48l32 0c8.8 0 16 7.2 16 16l0 48c0 17.7 14.3 32 32 32c10.1 0 19.6-4.7 25.6-12.8l25.6-34.1c8.3-11.1 12.8-24.6 12.8-38.4l0-12.1c0-3.9 2.6-7.3 6.4-8.2l5.3-1.3c11.9-3 20.3-13.7 20.3-26c0-7.1-2.8-13.9-7.8-18.9l-33.5-33.5c-3.7-3.7-3.7-9.7 0-13.4c5.7-5.7 14.1-7.7 21.8-5.1l14.1 4.7c12.3 4.1 25.7-1.5 31.5-13c3.5-7 11.2-10.8 18.9-9.2l27.4 5.5C432 112.4 351.5 48 256 48c-27.7 0-54 5.4-78.2 15.2zM0 256a256 256 0 1 1 512 0A256 256 0 1 1 0 256z"),I(e,"class","fill-white"),I(e,"xmlns","http://www.w3.org/2000/svg"),I(e,"viewBox","0 0 512 512"),I(e,"width",r[0]),I(e,"height","40")},m(i,n){F(i,e,n),b(e,t)},p(i,[n]){n&1&&I(e,"width",i[0])},i:st,o:st,d(i){i&&w(e)}}}function H_(r,e,t){let{w:i=36}=e;return r.$$set=n=>{"w"in n&&t(0,i=n.w)},[i]}class Z_ extends Rr{constructor(e){super(),br(this,e,H_,K_,Yi,{w:0})}}const he={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},$r=[he.FILL],Ni=[he.STROKE],rn=[he.BEGIN_PATH],vh=[he.CLOSE_PATH];class R1{drawCustom(e,t,i,n,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,t,i){}drawFeature(e,t,i){}drawGeometryCollection(e,t,i){}drawLineString(e,t,i){}drawMultiLineString(e,t,i){}drawMultiPoint(e,t,i){}drawMultiPolygon(e,t,i){}drawPoint(e,t,i){}drawPolygon(e,t,i){}drawText(e,t,i){}setFillStrokeStyle(e,t){}setImageStyle(e,t){}setTextStyle(e,t){}}class Nr extends R1{constructor(e,t,i,n){super(),this.tolerance=e,this.maxExtent=t,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const t=this.pixelRatio;return t==1?e:e.map(function(i){return i*t})}appendFlatPointCoordinates(e,t){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=t)n[0]=e[a],n[1]=e[a+1],on(i,n)&&(s[o++]=n[0],s[o++]=n[1]);return o}appendFlatLineCoordinates(e,t,i,n,s,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(t+=n);let c=e[t],u=e[t+1];const d=this.tmpCoordinate_;let f=!0,g,_,m;for(g=t+n;g<i;g+=n)d[0]=e[g],d[1]=e[g+1],m=go(h,d),m!==_?(f&&(a[l++]=c,a[l++]=u,f=!1),a[l++]=d[0],a[l++]=d[1]):m===dt.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,c=d[0],u=d[1],_=m;return(s&&f||g===t+n)&&(a[l++]=c,a[l++]=u),l}drawCustomCoordinates_(e,t,i,n,s){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(e,t,l,n,!1,!1);s.push(h),t=l}return t}drawCustom(e,t,i,n,s){this.beginGeometry(e,t,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let h,c,u,d,f;switch(o){case"MultiPolygon":h=e.getOrientedFlatCoordinates(),d=[];const g=e.getEndss();f=0;for(let _=0,m=g.length;_<m;++_){const y=[];f=this.drawCustomCoordinates_(h,f,g[_],a,y),d.push(y)}this.instructions.push([he.CUSTOM,l,d,e,i,gl,s]),this.hitDetectionInstructions.push([he.CUSTOM,l,d,e,n||i,gl,s]);break;case"Polygon":case"MultiLineString":u=[],h=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),f=this.drawCustomCoordinates_(h,0,e.getEnds(),a,u),this.instructions.push([he.CUSTOM,l,u,e,i,us,s]),this.hitDetectionInstructions.push([he.CUSTOM,l,u,e,n||i,us,s]);break;case"LineString":case"Circle":h=e.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([he.CUSTOM,l,c,e,i,bn,s]),this.hitDetectionInstructions.push([he.CUSTOM,l,c,e,n||i,bn,s]);break;case"MultiPoint":h=e.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,a),c>l&&(this.instructions.push([he.CUSTOM,l,c,e,i,bn,s]),this.hitDetectionInstructions.push([he.CUSTOM,l,c,e,n||i,bn,s]));break;case"Point":h=e.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([he.CUSTOM,l,c,e,i,void 0,s]),this.hitDetectionInstructions.push([he.CUSTOM,l,c,e,n||i,void 0,s]);break}this.endGeometry(t)}beginGeometry(e,t,i){this.beginGeometryInstruction1_=[he.BEGIN_GEOMETRY,t,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[he.BEGIN_GEOMETRY,t,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let t;const i=e.length;let n,s,o=-1;for(t=0;t<i;++t)n=e[t],s=n[0],s==he.END_GEOMETRY?o=t:s==he.BEGIN_GEOMETRY&&(n[2]=t,K1(this.hitDetectionInstructions,o,t),o=-1)}setFillStrokeStyle(e,t){const i=this.state;if(e){const n=e.getColor();i.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,i.fillStyle=ai(n||Ot)}else i.fillStyle=void 0;if(t){const n=t.getColor();i.strokeStyle=ai(n||Er);const s=t.getLineCap();i.lineCap=s!==void 0?s:zn;const o=t.getLineDash();i.lineDash=o?o.slice():Ti;const a=t.getLineDashOffset();i.lineDashOffset=a||xi;const l=t.getLineJoin();i.lineJoin=l!==void 0?l:Bn;const h=t.getWidth();i.lineWidth=h!==void 0?h:xr;const c=t.getMiterLimit();i.miterLimit=c!==void 0?c:yr,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(e){const t=e.fillStyle,i=[he.SET_FILL_STYLE,t];return typeof t!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[he.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,this.applyPixelRatio(e.lineDash),e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,t){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(t.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,t){const i=e.strokeStyle,n=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,h=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=n||s!=e.currentLineDash&&!Hi(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=h)&&(i!==void 0&&t.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=n,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=h)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const t=[he.END_GEOMETRY,e];this.instructions.push(t),this.hitDetectionInstructions.push(t)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Xh(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;Oo(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class q_ extends Nr{constructor(e,t,i,n){super(e,t,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,t,i){if(!this.image_||this.maxExtent&&!on(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,t,i);const n=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,s);this.instructions.push([he.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([he.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}drawMultiPoint(e,t,i){if(!this.image_)return;this.beginGeometry(e,t,i);const n=e.getFlatCoordinates(),s=[];for(let l=0,h=n.length;l<h;l+=e.getStride())(!this.maxExtent||on(this.maxExtent,n.slice(l,l+2)))&&s.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([he.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([he.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(t)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,t){const i=e.getAnchor(),n=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=n[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}class $_ extends Nr{constructor(e,t,i,n){super(e,t,i,n)}drawFlatCoordinates_(e,t,i,n){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,t,i,n,!1,!1),a=[he.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,t,i){const n=this.state,s=n.strokeStyle,o=n.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ti,xi],rn);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Ni),this.endGeometry(t)}drawMultiLineString(e,t,i){const n=this.state,s=n.strokeStyle,o=n.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(e,t,i),this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ti,xi],rn);const a=e.getEnds(),l=e.getFlatCoordinates(),h=e.getStride();let c=0;for(let u=0,d=a.length;u<d;++u)c=this.drawFlatCoordinates_(l,c,a[u],h);this.hitDetectionInstructions.push(Ni),this.endGeometry(t)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Ni),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Ni),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(rn)}}class wh extends Nr{constructor(e,t,i,n){super(e,t,i,n)}drawFlatCoordinatess_(e,t,i,n){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=i.length;this.instructions.push(rn),this.hitDetectionInstructions.push(rn);for(let h=0;h<l;++h){const c=i[h],u=this.coordinates.length,d=this.appendFlatLineCoordinates(e,t,c,n,!0,!a),f=[he.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(vh),this.hitDetectionInstructions.push(vh)),t=c}return o&&(this.instructions.push($r),this.hitDetectionInstructions.push($r)),a&&(this.instructions.push(Ni),this.hitDetectionInstructions.push(Ni)),t}drawCircle(e,t,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_FILL_STYLE,Ot]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ti,xi]);const a=e.getFlatCoordinates(),l=e.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const c=[he.CIRCLE,h];this.instructions.push(rn,c),this.hitDetectionInstructions.push(rn,c),n.fillStyle!==void 0&&(this.instructions.push($r),this.hitDetectionInstructions.push($r)),n.strokeStyle!==void 0&&(this.instructions.push(Ni),this.hitDetectionInstructions.push(Ni)),this.endGeometry(t)}drawPolygon(e,t,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_FILL_STYLE,Ot]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ti,xi]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),h=e.getStride();this.drawFlatCoordinatess_(l,0,a,h),this.endGeometry(t)}drawMultiPolygon(e,t,i){const n=this.state,s=n.fillStyle,o=n.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,t,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_FILL_STYLE,Ot]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ti,xi]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),h=e.getStride();let c=0;for(let u=0,d=a.length;u<d;++u)c=this.drawFlatCoordinatess_(l,c,a[u],h);this.endGeometry(t)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const t=this.coordinates;for(let i=0,n=t.length;i<n;++i)t[i]=Ji(t[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;e.fillStyle!==void 0&&this.updateFillStyle(e,this.createFill),e.strokeStyle!==void 0&&this.updateStrokeStyle(e,this.applyStroke)}}function J_(r,e,t,i,n){const s=[];let o=t,a=0,l=e.slice(t,2);for(;a<r&&o+n<i;){const[h,c]=l.slice(-2),u=e[o+n],d=e[o+n+1],f=Math.sqrt((u-h)*(u-h)+(d-c)*(d-c));if(a+=f,a>=r){const g=(r-a+f)/f,_=Kt(h,u,g),m=Kt(c,d,g);l.push(_,m),s.push(l),l=[_,m],a==r&&(o+=n),a=0}else if(a<r)l.push(e[o+n],e[o+n+1]),o+=n;else{const g=f-a,_=Kt(h,u,g/f),m=Kt(c,d,g/f);l.push(_,m),s.push(l),l=[_,m],a=0,o+=n}}return a>0&&s.push(l),s}function Q_(r,e,t,i,n){let s=t,o=t,a=0,l=0,h=t,c,u,d,f,g,_,m,y,p,T;for(u=t;u<i;u+=n){const E=e[u],x=e[u+1];g!==void 0&&(p=E-g,T=x-_,f=Math.sqrt(p*p+T*T),m!==void 0&&(l+=d,c=Math.acos((m*p+y*T)/(d*f)),c>r&&(l>a&&(a=l,s=h,o=u),l=0,h=u-n)),d=f,m=p,y=T),g=E,_=x}return l+=f,l>a?[h,u]:[s,o]}const Es={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class em extends Nr{constructor(e,t,i,n){super(e,t,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Ot]={fillStyle:Ot},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,t,i){const n=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!s)return;const a=this.coordinates;let l=a.length;const h=e.getType();let c=null,u=e.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!zt(this.maxExtent,e.getExtent()))return;let d;if(c=e.getFlatCoordinates(),h=="LineString")d=[c.length];else if(h=="MultiLineString")d=e.getEnds();else if(h=="Polygon")d=e.getEnds().slice(0,1);else if(h=="MultiPolygon"){const m=e.getEndss();d=[];for(let y=0,p=m.length;y<p;++y)d.push(m[y][0])}this.beginGeometry(e,t,i);const f=o.repeat,g=f?void 0:o.textAlign;let _=0;for(let m=0,y=d.length;m<y;++m){let p;f?p=J_(f*this.resolution,c,_,d[m],u):p=[c.slice(_,d[m])];for(let T=0,E=p.length;T<E;++T){const x=p[T];let v=0,C=x.length;if(g==null){const S=Q_(o.maxAngle,x,0,x.length,2);v=S[0],C=S[1]}for(let S=v;S<C;S+=u)a.push(x[S],x[S+1]);const R=a.length;_=d[m],this.drawChars_(l,R),l=R}}this.endGeometry(t)}else{let d=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=e.getFlatCoordinates();break;case"LineString":c=e.getFlatMidpoint();break;case"Circle":c=e.getCenter();break;case"MultiLineString":c=e.getFlatMidpoints(),u=2;break;case"Polygon":c=e.getFlatInteriorPoint(),o.overflow||d.push(c[2]/this.resolution),u=3;break;case"MultiPolygon":const p=e.getFlatInteriorPoints();c=[];for(let T=0,E=p.length;T<E;T+=3)o.overflow||d.push(p[T+2]/this.resolution),c.push(p[T],p[T+1]);if(c.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(c,u);if(f===l)return;if(d&&(f-l)/2!==c.length/u){let p=l/2;d=d.filter((T,E)=>{const x=a[(p+E)*2]===c[E*u]&&a[(p+E)*2+1]===c[E*u+1];return x||--p,x})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(e,t,i);let g=o.padding;if(g!=nn&&(o.scale[0]<0||o.scale[1]<0)){let p=o.padding[0],T=o.padding[1],E=o.padding[2],x=o.padding[3];o.scale[0]<0&&(T=-T,x=-x),o.scale[1]<0&&(p=-p,E=-E),g=[p,T,E,x]}const _=this.pixelRatio;this.instructions.push([he.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,g==nn?nn:g.map(function(p){return p*_}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const m=1/_,y=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=Ot,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([he.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[m,m],NaN,this.declutterMode_,this.declutterImageWithText_,g,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Ot:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),o.backgroundFill&&(this.state.fillStyle=y,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(t)}}saveTextStates_(){const e=this.textStrokeState_,t=this.textState_,i=this.textFillState_,n=this.strokeKey_;e&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:t.font,textAlign:t.textAlign||Tr,justify:t.justify,textBaseline:t.textBaseline||gs,scale:t.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,t){const i=this.textStrokeState_,n=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=Es[n.textBaseline],c=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([he.DRAW_CHARS,e,t,h,n.overflow,a,n.maxAngle,l,c,s,d*l,u,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([he.DRAW_CHARS,e,t,h,n.overflow,a&&Ot,n.maxAngle,l,c,s,d*l,u,o,1/l,this.declutterMode_])}setTextStyle(e,t){let i,n,s;if(!e)this.text_="";else{const o=e.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=ai(o.getColor()||Ot)):(n=null,this.textFillState_=n);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const g=a.getLineDash(),_=a.getLineDashOffset(),m=a.getWidth(),y=a.getMiterLimit();s.lineCap=a.getLineCap()||zn,s.lineDash=g?g.slice():Ti,s.lineDashOffset=_===void 0?xi:_,s.lineJoin=a.getLineJoin()||Bn,s.lineWidth=m===void 0?xr:m,s.miterLimit=y===void 0?yr:y,s.strokeStyle=ai(a.getColor()||Er)}i=this.textState_;const l=e.getFont()||$c;$2(l);const h=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||gs,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||nn,i.scale=h===void 0?[1,1]:h;const c=e.getOffsetX(),u=e.getOffsetY(),d=e.getRotateWithView(),f=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textRotation_=f===void 0?0:f,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:Ne(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+Ne(n.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=t}}const tm={Circle:wh,Default:Nr,Image:q_,LineString:$_,Polygon:wh,Text:em};class im{constructor(e,t,i,n){this.tolerance_=e,this.maxExtent_=t,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const t in this.buildersByZIndex_){e[t]=e[t]||{};const i=this.buildersByZIndex_[t];for(const n in i){const s=i[n].finish();e[t][n]=s}}return e}getBuilder(e,t){const i=e!==void 0?e.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let s=n[t];if(s===void 0){const o=tm[t];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[t]=s}return s}}function nm(r,e,t,i,n,s,o,a,l,h,c,u){let d=r[e],f=r[e+1],g=0,_=0,m=0,y=0;function p(){g=d,_=f,e+=i,d=r[e],f=r[e+1],y+=m,m=Math.sqrt((d-g)*(d-g)+(f-_)*(f-_))}do p();while(e<t-i&&y+m<s);let T=m===0?0:(s-y)/m;const E=Kt(g,d,T),x=Kt(_,f,T),v=e-i,C=y,R=s+a*l(h,n,c);for(;e<t-i&&y+m<R;)p();T=m===0?0:(R-y)/m;const S=Kt(g,d,T),P=Kt(_,f,T);let O;if(u){const k=[E,x,S,P];_c(k,0,4,2,u,k,k),O=k[0]>k[2]}else O=E>S;const N=Math.PI,V=[],U=v+i===e;e=v,m=0,y=C,d=r[e],f=r[e+1];let L;if(U){p(),L=Math.atan2(f-_,d-g),O&&(L+=L>0?-N:N);const k=(S+E)/2,Q=(P+x)/2;return V[0]=[k,Q,(R-s)/2,L,n],V}n=n.replace(/\n/g," ");for(let k=0,Q=n.length;k<Q;){p();let q=Math.atan2(f-_,d-g);if(O&&(q+=q>0?-N:N),L!==void 0){let X=q-L;if(X+=X>N?-2*N:X<-N?2*N:0,Math.abs(X)>o)return null}L=q;const ie=k;let J=0;for(;k<Q;++k){const X=O?Q-k-1:k,De=a*l(h,n[X],c);if(e+i<t&&y+m<s+J+De/2)break;J+=De}if(k===ie)continue;const Z=O?n.substring(Q-ie,Q-k):n.substring(ie,k);T=m===0?0:(s+J/2-y)/m;const fe=Kt(g,d,T),Ie=Kt(_,f,T);V.push([fe,Ie,J/2,q,Z]),s+=J}return V}const En=li(),Li=[],gi=[],_i=[],Di=[];function Ch(r){return r[3].declutterBox}const Rh=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function ho(r,e){return e==="start"?e=Rh.test(r)?"right":"left":e==="end"&&(e=Rh.test(r)?"left":"right"),Es[e]}function rm(r,e,t){return t>0&&r.push(`
`,""),r.push(e,""),r}class sm{constructor(e,t,i,n,s){this.overlaps=i,this.pixelRatio=t,this.resolution=e,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=Gt(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new Kc:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,t,i,n){const s=e+t+i+n;if(this.labels_[s])return this.labels_[s];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[t],h=this.pixelRatio,c=[l.scale[0]*h,l.scale[1]*h],u=Array.isArray(e),d=l.justify?Es[l.justify]:ho(Array.isArray(e)?e[0]:e,l.textAlign||Tr),f=n&&o.lineWidth?o.lineWidth:0,g=u?e:e.split(`
`).reduce(rm,[]),{width:_,height:m,widths:y,heights:p,lineWidths:T}=Q2(l,g),E=_+f,x=[],v=(E+2)*c[0],C=(m+f)*c[1],R={width:v<0?Math.floor(v):Math.ceil(v),height:C<0?Math.floor(C):Math.ceil(C),contextInstructions:x};(c[0]!=1||c[1]!=1)&&x.push("scale",c),n&&(x.push("strokeStyle",o.strokeStyle),x.push("lineWidth",f),x.push("lineCap",o.lineCap),x.push("lineJoin",o.lineJoin),x.push("miterLimit",o.miterLimit),x.push("setLineDash",[o.lineDash]),x.push("lineDashOffset",o.lineDashOffset)),i&&x.push("fillStyle",a.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const S=.5-d;let P=d*E+S*f;const O=[],N=[];let V=0,U=0,L=0,k=0,Q;for(let q=0,ie=g.length;q<ie;q+=2){const J=g[q];if(J===`
`){U+=V,V=0,P=d*E+S*f,++k;continue}const Z=g[q+1]||l.font;Z!==Q&&(n&&O.push("font",Z),i&&N.push("font",Z),Q=Z),V=Math.max(V,p[L]);const fe=[J,P+S*y[L]+d*(y[L]-T[k]),.5*(f+V)+U];P+=y[L],n&&O.push("strokeText",fe),i&&N.push("fillText",fe),++L}return Array.prototype.push.apply(x,O),Array.prototype.push.apply(x,N),this.labels_[s]=R,R}replayTextBackground_(e,t,i,n,s,o,a){e.beginPath(),e.moveTo.apply(e,t),e.lineTo.apply(e,i),e.lineTo.apply(e,n),e.lineTo.apply(e,s),e.lineTo.apply(e,t),o&&(this.alignAndScaleFill_=o[2],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,t,i,n,s,o,a,l,h,c,u,d,f,g,_,m){a*=d[0],l*=d[1];let y=i-a,p=n-l;const T=s+h>e?e-h:s,E=o+c>t?t-c:o,x=g[3]+T*d[0]+g[1],v=g[0]+E*d[1]+g[2],C=y-g[3],R=p-g[0];(_||u!==0)&&(Li[0]=C,Di[0]=C,Li[1]=R,gi[1]=R,gi[0]=C+x,_i[0]=gi[0],_i[1]=R+v,Di[1]=_i[1]);let S;return u!==0?(S=Ci(Gt(),i,n,1,1,u,-i,-n),yt(S,Li),yt(S,gi),yt(S,_i),yt(S,Di),an(Math.min(Li[0],gi[0],_i[0],Di[0]),Math.min(Li[1],gi[1],_i[1],Di[1]),Math.max(Li[0],gi[0],_i[0],Di[0]),Math.max(Li[1],gi[1],_i[1],Di[1]),En)):an(Math.min(C,C+x),Math.min(R,R+v),Math.max(C,C+x),Math.max(R,R+v),En),f&&(y=Math.round(y),p=Math.round(p)),{drawImageX:y,drawImageY:p,drawImageW:T,drawImageH:E,originX:h,originY:c,declutterBox:{minX:En[0],minY:En[1],maxX:En[2],maxY:En[3],value:m},canvasTransform:S,scale:d}}replayImageOrLabel_(e,t,i,n,s,o,a){const l=!!(o||a),h=n.declutterBox,c=a?a[2]*n.scale[0]/2:0;return h.minX-c<=t[0]&&h.maxX+c>=0&&h.minY-c<=t[1]&&h.maxY+c>=0&&(l&&this.replayTextBackground_(e,Li,gi,_i,Di,o,a),e0(e,n.canvasTransform,s,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(e){const t=this.alignAndScaleFill_;if(t){const i=yt(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;e.save(),e.translate(i[0]%n,i[1]%n),t!==1&&e.scale(t,t),e.rotate(this.viewRotation_)}e.fill(),t&&e.restore()}setStrokeStyle_(e,t){e.strokeStyle=t[1],e.lineWidth=t[2],e.lineCap=t[3],e.lineJoin=t[4],e.miterLimit=t[5],e.lineDashOffset=t[7],e.setLineDash(t[6])}drawLabelWithPointPlacement_(e,t,i,n){const s=this.textStates[t],o=this.createLabel(e,t,n,i),a=this.strokeStates[i],l=this.pixelRatio,h=ho(Array.isArray(e)?e[0]:e,s.textAlign||Tr),c=Es[s.textBaseline||gs],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*s.scale[0],f=h*d+2*(.5-h)*u,g=c*o.height/l+2*(.5-c)*u;return{label:o,anchorX:f,anchorY:g}}execute_(e,t,i,n,s,o,a,l){const h=this.zIndexContext_;let c;this.pixelCoordinates_&&Hi(i,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=sn(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),td(this.renderedTransform_,i));let u=0;const d=n.length;let f=0,g,_,m,y,p,T,E,x,v,C,R,S,P,O=0,N=0,V=null,U=null;const L=this.coordinateCache_,k=this.viewRotation_,Q=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,q={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:k},ie=this.instructions!=n||this.overlaps?0:200;let J,Z,fe,Ie;for(;u<d;){const X=n[u];switch(X[0]){case he.BEGIN_GEOMETRY:J=X[1],Ie=X[3],J.getGeometry()?a!==void 0&&!zt(a,Ie.getExtent())?u=X[2]+1:++u:u=X[2],h&&(h.zIndex=X[4]);break;case he.BEGIN_PATH:O>ie&&(this.fill_(e),O=0),N>ie&&(e.stroke(),N=0),!O&&!N&&(e.beginPath(),p=NaN,T=NaN),++u;break;case he.CIRCLE:f=X[1];const Re=c[f],K=c[f+1],ce=c[f+2],Ke=c[f+3],me=ce-Re,Ve=Ke-K,Se=Math.sqrt(me*me+Ve*Ve);e.moveTo(Re+Se,K),e.arc(Re,K,Se,0,2*Math.PI,!0),++u;break;case he.CLOSE_PATH:e.closePath(),++u;break;case he.CUSTOM:f=X[1],g=X[2];const ge=X[3],Ee=X[4],Ze=X[5];q.geometry=ge,q.feature=J,u in L||(L[u]=[]);const Te=L[u];Ze?Ze(c,f,g,2,Te):(Te[0]=c[f],Te[1]=c[f+1],Te.length=2),h&&(h.zIndex=X[6]),Ee(Te,q),++u;break;case he.DRAW_IMAGE:f=X[1],g=X[2],v=X[3],_=X[4],m=X[5];let ae=X[6];const ve=X[7],Pe=X[8],ot=X[9],it=X[10];let z=X[11];const oe=X[12];let j=X[13];y=X[14]||"declutter";const le=X[15];if(!v&&X.length>=20){C=X[19],R=X[20],S=X[21],P=X[22];const At=this.drawLabelWithPointPlacement_(C,R,S,P);v=At.label,X[3]=v;const at=X[23];_=(At.anchorX-at)*this.pixelRatio,X[4]=_;const Xt=X[24];m=(At.anchorY-Xt)*this.pixelRatio,X[5]=m,ae=v.height,X[6]=ae,j=v.width,X[13]=j}let Ae;X.length>25&&(Ae=X[25]);let ut,je,pt;X.length>17?(ut=X[16],je=X[17],pt=X[18]):(ut=nn,je=!1,pt=!1),it&&Q?z+=k:!it&&!Q&&(z-=k);let $=0;for(;f<g;f+=2){if(Ae&&Ae[$++]<j/this.pixelRatio)continue;const At=this.calculateImageOrLabelDimensions_(v.width,v.height,c[f],c[f+1],j,ae,_,m,Pe,ot,z,oe,s,ut,je||pt,J),at=[e,t,v,At,ve,je?V:null,pt?U:null];if(l){let Xt,Jt,Vt;if(le){const et=g-f;if(!le[et]){le[et]={args:at,declutterMode:y};continue}const Lt=le[et];Xt=Lt.args,Jt=Lt.declutterMode,delete le[et],Vt=Ch(Xt)}let ui,di;if(Xt&&(Jt!=="declutter"||!l.collides(Vt))&&(ui=!0),(y!=="declutter"||!l.collides(At.declutterBox))&&(di=!0),Jt==="declutter"&&y==="declutter"){const et=ui&&di;ui=et,di=et}ui&&(Jt!=="none"&&l.insert(Vt),this.replayImageOrLabel_.apply(this,Xt)),di&&(y!=="none"&&l.insert(At.declutterBox),this.replayImageOrLabel_.apply(this,at))}else this.replayImageOrLabel_.apply(this,at)}++u;break;case he.DRAW_CHARS:const we=X[1],ne=X[2],ue=X[3],Me=X[4];P=X[5];const B=X[6],re=X[7],nt=X[8];S=X[9];const Qe=X[10];C=X[11],R=X[12];const We=[X[13],X[13]];y=X[14]||"declutter";const bt=this.textStates[R],It=bt.font,St=[bt.scale[0]*re,bt.scale[1]*re];let $t;It in this.widths_?$t=this.widths_[It]:($t={},this.widths_[It]=$t);const Zn=Id(c,we,ne,2),bi=Math.abs(St[0])*Ml(It,C,$t);if(Me||bi<=Zn){const At=this.textStates[R].textAlign,at=(Zn-bi)*ho(C,At),Xt=nm(c,we,ne,2,C,at,B,Math.abs(St[0]),Ml,It,$t,Q?0:this.viewRotation_);e:if(Xt){const Jt=[];let Vt,ui,di,et,Lt;if(S)for(Vt=0,ui=Xt.length;Vt<ui;++Vt){Lt=Xt[Vt],di=Lt[4],et=this.createLabel(di,R,"",S),_=Lt[2]+(St[0]<0?-Qe:Qe),m=ue*et.height+(.5-ue)*2*Qe*St[1]/St[0]-nt;const fi=this.calculateImageOrLabelDimensions_(et.width,et.height,Lt[0],Lt[1],et.width,et.height,_,m,0,0,Lt[3],We,!1,nn,!1,J);if(l&&y==="declutter"&&l.collides(fi.declutterBox))break e;Jt.push([e,t,et,fi,1,null,null])}if(P)for(Vt=0,ui=Xt.length;Vt<ui;++Vt){Lt=Xt[Vt],di=Lt[4],et=this.createLabel(di,R,P,""),_=Lt[2],m=ue*et.height-nt;const fi=this.calculateImageOrLabelDimensions_(et.width,et.height,Lt[0],Lt[1],et.width,et.height,_,m,0,0,Lt[3],We,!1,nn,!1,J);if(l&&y==="declutter"&&l.collides(fi.declutterBox))break e;Jt.push([e,t,et,fi,1,null,null])}l&&y!=="none"&&l.load(Jt.map(Ch));for(let fi=0,L1=Jt.length;fi<L1;++fi)this.replayImageOrLabel_.apply(this,Jt[fi])}}++u;break;case he.END_GEOMETRY:if(o!==void 0){J=X[1];const At=o(J,Ie);if(At)return At}++u;break;case he.FILL:ie?O++:this.fill_(e),++u;break;case he.MOVE_TO_LINE_TO:for(f=X[1],g=X[2],Z=c[f],fe=c[f+1],E=Z+.5|0,x=fe+.5|0,(E!==p||x!==T)&&(e.moveTo(Z,fe),p=E,T=x),f+=2;f<g;f+=2)Z=c[f],fe=c[f+1],E=Z+.5|0,x=fe+.5|0,(f==g-2||E!==p||x!==T)&&(e.lineTo(Z,fe),p=E,T=x);++u;break;case he.SET_FILL_STYLE:V=X,this.alignAndScaleFill_=X[2],O&&(this.fill_(e),O=0,N&&(e.stroke(),N=0)),e.fillStyle=X[1],++u;break;case he.SET_STROKE_STYLE:U=X,N&&(e.stroke(),N=0),this.setStrokeStyle_(e,X),++u;break;case he.STROKE:ie?N++:e.stroke(),++u;break;default:++u;break}}O&&this.fill_(e),N&&e.stroke()}execute(e,t,i,n,s,o){this.viewRotation_=n,this.execute_(e,t,i,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,t,i,n,s){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],t,this.hitDetectionInstructions,!0,n,s)}}const hr=["Polygon","Circle","LineString","Image","Text","Default"],b1=["Image","Text"],om=hr.filter(r=>!b1.includes(r));class am{constructor(e,t,i,n,s,o,a){this.maxExtent_=e,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=t,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Gt(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,t){const i=this.getClipCoords(t);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,t){for(const i in e){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const s=e[i];for(const o in s){const a=s[o];n[o]=new sm(this.resolution_,this.pixelRatio_,this.overlaps_,a,t)}}}hasExecutors(e){for(const t in this.executorsByZIndex_){const i=this.executorsByZIndex_[t];for(let n=0,s=e.length;n<s;++n)if(e[n]in i)return!0}return!1}forEachFeatureAtCoordinate(e,t,i,n,s,o){n=Math.round(n);const a=n*2+1,l=Ci(this.hitDetectionTransform_,n+.5,n+.5,1/t,-1/t,-i,-e[0],-e[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=ht(a,a,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):h||c.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=li(),or(u,e),Oo(u,t*(this.renderBuffer_+n),u));const d=lm(n);let f;function g(x,v){const C=c.getImageData(0,0,a,a).data;for(let R=0,S=d.length;R<S;R++)if(C[d[R]]>0){if(!o||f!=="Image"&&f!=="Text"||o.includes(x)){const P=(d[R]-3)/4,O=n-P%a,N=n-(P/a|0),V=s(x,v,O*O+N*N);if(V)return V}c.clearRect(0,0,a,a);break}}const _=Object.keys(this.executorsByZIndex_).map(Number);_.sort(In);let m,y,p,T,E;for(m=_.length-1;m>=0;--m){const x=_[m].toString();for(p=this.executorsByZIndex_[x],y=hr.length-1;y>=0;--y)if(f=hr[y],T=p[f],T!==void 0&&(E=T.executeHitDetection(c,l,i,g,u),E))return E}}getClipCoords(e){const t=this.maxExtent_;if(!t)return null;const i=t[0],n=t[1],s=t[2],o=t[3],a=[i,n,i,o,s,o,s,n];return sn(a,0,8,2,e,a),a}isEmpty(){return Fo(this.executorsByZIndex_)}execute(e,t,i,n,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(In),o=o||hr;let h,c,u,d,f,g;for(a&&l.reverse(),h=0,c=l.length;h<c;++h){const _=l[h].toString();for(f=this.executorsByZIndex_[_],u=0,d=o.length;u<d;++u){const m=o[u];if(g=f[m],g!==void 0){const y=a===null?void 0:g.getZIndexContext(),p=y?y.getContext():e,T=this.maxExtent_&&m!=="Image"&&m!=="Text";if(T&&(p.save(),this.clip(p,i)),g.execute(p,t,i,n,s,a),T&&p.restore(),y){y.offset();const E=l[h];this.deferredZIndexContexts_[E]||(this.deferredZIndexContexts_[E]=[]),this.deferredZIndexContexts_[E].push(y)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,t=Object.keys(e).map(Number).sort(In);for(let i=0,n=t.length;i<n;++i)e[t[i]].forEach(s=>{s.draw(this.renderedContext_),s.clear()})}}const co={};function lm(r){if(co[r]!==void 0)return co[r];const e=r*2+1,t=r*r,i=new Array(t+1);for(let s=0;s<=r;++s)for(let o=0;o<=r;++o){const a=s*s+o*o;if(a>t)break;let l=i[a];l||(l=[],i[a]=l),l.push(((r+s)*e+(r+o))*4+3),s>0&&l.push(((r-s)*e+(r+o))*4+3),o>0&&(l.push(((r+s)*e+(r-o))*4+3),s>0&&l.push(((r-s)*e+(r-o))*4+3))}const n=[];for(let s=0,o=i.length;s<o;++s)i[s]&&n.push(...i[s]);return co[r]=n,n}class hm extends R1{constructor(e,t,i,n,s,o,a){super(),this.context_=e,this.pixelRatio_=t,this.extent_=i,this.transform_=n,this.transformRotation_=n?zo(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Gt()}drawImages_(e,t,i,n){if(!this.image_)return;const s=sn(e,t,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let c=0,u=s.length;c<u;c+=2){const d=s[c]-this.imageAnchorX_,f=s[c+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=d+this.imageAnchorX_,_=f+this.imageAnchorY_;Ci(a,g,_,1,1,h,-g,-_),o.save(),o.transform.apply(o,a),o.translate(g,_),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,t,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=sn(e,t,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);t<i;t+=n){const l=s[t]+this.textOffsetX_,h=s[t+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(e,t,i,n,s){const o=this.context_,a=sn(e,t,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return s&&o.closePath(),i}drawRings_(e,t,i,n){for(let s=0,o=i.length;s<o;++s)t=this.moveToLineTo_(e,t,i[s],n,!0);return t}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zt(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=cd(e,this.transform_,this.pixelCoordinates_),i=t[2]-t[0],n=t[3]-t[1],s=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(t[0],t[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,t){const i=t.getGeometryFunction()(e);i&&(this.setStyle(t),this.drawGeometry(i))}drawGeometryCollection(e){const t=e.getGeometriesArray();for(let i=0,n=t.length;i<n;++i)this.drawGeometry(t[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(t,0,t.length,i),this.text_!==""&&this.drawText_(t,0,t.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zt(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getFlatCoordinates();t.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),t.stroke()}if(this.text_!==""){const t=e.getFlatMidpoint();this.drawText_(t,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const t=e.getExtent();if(zt(this.extent_,t)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,h=o.length;l<h;++l)s=this.moveToLineTo_(n,s,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zt(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_;t.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoint();this.drawText_(t,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!zt(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const t=this.context_,i=e.getOrientedFlatCoordinates();let n=0;const s=e.getEndss(),o=e.getStride();t.beginPath();for(let a=0,l=s.length;a<l;++a){const h=s[a];n=this.drawRings_(i,n,h,o)}this.fillState_&&t.fill(),this.strokeState_&&t.stroke()}if(this.text_!==""){const t=e.getFlatInteriorPoints();this.drawText_(t,0,t.length,2)}}}setContextFillState_(e){const t=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,t.fillStyle=e.fillStyle):(t.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const t=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,t.lineCap=e.lineCap),Hi(i.lineDash,e.lineDash)||t.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,t.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,t.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,t.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,t.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,t.strokeStyle=e.strokeStyle)):(t.lineCap=e.lineCap,t.setLineDash(e.lineDash),t.lineDashOffset=e.lineDashOffset,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const t=this.context_,i=this.contextTextState_,n=e.textAlign?e.textAlign:Tr;i?(i.font!=e.font&&(i.font=e.font,t.font=e.font),i.textAlign!=n&&(i.textAlign=n,t.textAlign=n),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,t.textBaseline=e.textBaseline)):(t.font=e.font,t.textAlign=n,t.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:n,textBaseline:e.textBaseline})}setFillStrokeStyle(e,t){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:ai(i||Ot)}}if(!t)this.strokeState_=null;else{const i=t.getColor(),n=t.getLineCap(),s=t.getLineDash(),o=t.getLineDashOffset(),a=t.getLineJoin(),l=t.getWidth(),h=t.getMiterLimit(),c=s||Ti;this.strokeState_={lineCap:n!==void 0?n:zn,lineDash:this.pixelRatio_===1?c:c.map(u=>u*this.pixelRatio_),lineDashOffset:(o||xi)*this.pixelRatio_,lineJoin:a!==void 0?a:Bn,lineWidth:(l!==void 0?l:xr)*this.pixelRatio_,miterLimit:h!==void 0?h:yr,strokeStyle:ai(i||Er)}}}setImageStyle(e){let t;if(!e||!(t=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),n=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=t[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=t[0]*i}setTextStyle(e){if(!e)this.text_="";else{const t=e.getFill();if(!t)this.textFillState_=null;else{const f=t.getColor();this.textFillState_={fillStyle:ai(f||Ot)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const f=i.getColor(),g=i.getLineCap(),_=i.getLineDash(),m=i.getLineDashOffset(),y=i.getLineJoin(),p=i.getWidth(),T=i.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:zn,lineDash:_||Ti,lineDashOffset:m||xi,lineJoin:y!==void 0?y:Bn,lineWidth:p!==void 0?p:xr,miterLimit:T!==void 0?T:yr,strokeStyle:ai(f||Er)}}const n=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),h=e.getScaleArray(),c=e.getText(),u=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:n!==void 0?n:$c,textAlign:u!==void 0?u:Tr,textBaseline:d!==void 0?d:gs},this.text_=c!==void 0?Array.isArray(c)?c.reduce((f,g,_)=>f+=_%2?" ":g,""):c:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const ri=.5;function cm(r,e,t,i,n,s,o,a,l){const h=n,c=r[0]*ri,u=r[1]*ri,d=ht(c,u);d.imageSmoothingEnabled=!1;const f=d.canvas,g=new hm(d,ri,n,null,o,a,null),_=t.length,m=Math.floor((256*256*256-1)/_),y={};for(let T=1;T<=_;++T){const E=t[T-1],x=E.getStyleFunction()||i;if(!x)continue;let v=x(E,s);if(!v)continue;Array.isArray(v)||(v=[v]);const R=(T*m).toString(16).padStart(7,"#00000");for(let S=0,P=v.length;S<P;++S){const O=v[S],N=O.getGeometryFunction()(E);if(!N||!zt(h,N.getExtent()))continue;const V=O.clone(),U=V.getFill();U&&U.setColor(R);const L=V.getStroke();L&&(L.setColor(R),L.setLineDash(null)),V.setText(void 0);const k=O.getImage();if(k){const J=k.getImageSize();if(!J)continue;const Z=ht(J[0],J[1],void 0,{alpha:!1}),fe=Z.canvas;Z.fillStyle=R,Z.fillRect(0,0,fe.width,fe.height),V.setImage(new ks({img:fe,anchor:k.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:k.getOrigin(),opacity:1,size:k.getSize(),scale:k.getScale(),rotation:k.getRotation(),rotateWithView:k.getRotateWithView()}))}const Q=V.getZIndex()||0;let q=y[Q];q||(q={},y[Q]=q,q.Polygon=[],q.Circle=[],q.LineString=[],q.Point=[]);const ie=N.getType();if(ie==="GeometryCollection"){const J=N.getGeometriesArrayRecursive();for(let Z=0,fe=J.length;Z<fe;++Z){const Ie=J[Z];q[Ie.getType().replace("Multi","")].push(Ie,V)}}else q[ie.replace("Multi","")].push(N,V)}}const p=Object.keys(y).map(Number).sort(In);for(let T=0,E=p.length;T<E;++T){const x=y[p[T]];for(const v in x){const C=x[v];for(let R=0,S=C.length;R<S;R+=2){g.setStyle(C[R+1]);for(let P=0,O=e.length;P<O;++P)g.setTransform(e[P]),g.drawGeometry(C[R])}}}return d.getImageData(0,0,f.width,f.height)}function um(r,e,t){const i=[];if(t){const n=Math.floor(Math.round(r[0])*ri),s=Math.floor(Math.round(r[1])*ri),o=(Je(n,0,t.width-1)+Je(s,0,t.height-1)*t.width)*4,a=t.data[o],l=t.data[o+1],c=t.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/e.length);c&&c%u===0&&i.push(e[c/u-1])}return i}const dm=.5,I1={Point:Tm,LineString:pm,Polygon:vm,MultiPoint:xm,MultiLineString:ym,MultiPolygon:Em,GeometryCollection:mm,Circle:gm};function fm(r,e){return parseInt(Ne(r),10)-parseInt(Ne(e),10)}function bh(r,e){const t=S1(r,e);return t*t}function S1(r,e){return dm*r/e}function gm(r,e,t,i,n){const s=t.getFill(),o=t.getStroke();if(s||o){const l=r.getBuilder(t.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,i,n)}const a=t.getText();if(a&&a.getText()){const l=r.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function Ih(r,e,t,i,n,s,o,a){const l=[],h=t.getImage();if(h){let d=!0;const f=h.getImageState();f==be.LOADED||f==be.ERROR?d=!1:f==be.IDLE&&h.load(),d&&l.push(h.ready())}const c=t.getFill();c&&c.loading()&&l.push(c.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>n(null)),_m(r,e,t,i,s,o,a),u}function _m(r,e,t,i,n,s,o){const a=t.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,n);if(t.getRenderer())A1(r,l,t,e,o);else{const c=I1[l.getType()];c(r,l,t,e,o,s)}}function A1(r,e,t,i,n){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)A1(r,o[a],t,i,n);return}r.getBuilder(t.getZIndex(),"Default").drawCustom(e,i,t.getRenderer(),t.getHitDetectionRenderer(),n)}function mm(r,e,t,i,n,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const h=I1[o[a].getType()];h(r,o[a],t,i,n,s)}}function pm(r,e,t,i,n){const s=t.getStroke();if(s){const a=r.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,i,n)}const o=t.getText();if(o&&o.getText()){const a=r.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,n)}}function ym(r,e,t,i,n){const s=t.getStroke();if(s){const a=r.getBuilder(t.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,i,n)}const o=t.getText();if(o&&o.getText()){const a=r.getBuilder(t.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,n)}}function Em(r,e,t,i,n){const s=t.getFill(),o=t.getStroke();if(o||s){const l=r.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,i,n)}const a=t.getText();if(a&&a.getText()){const l=r.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,n)}}function Tm(r,e,t,i,n,s){const o=t.getImage(),a=t.getText(),l=a&&a.getText(),h=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=be.LOADED)return;const c=r.getBuilder(t.getZIndex(),"Image");c.setImageStyle(o,h),c.drawPoint(e,i,n)}if(l){const c=r.getBuilder(t.getZIndex(),"Text");c.setTextStyle(a,h),c.drawText(e,i,n)}}function xm(r,e,t,i,n,s){const o=t.getImage(),a=o&&o.getOpacity()!==0,l=t.getText(),h=l&&l.getText(),c=s&&a&&h?{}:void 0;if(a){if(o.getImageState()!=be.LOADED)return;const u=r.getBuilder(t.getZIndex(),"Image");u.setImageStyle(o,c),u.drawMultiPoint(e,i,n)}if(h){const u=r.getBuilder(t.getZIndex(),"Text");u.setTextStyle(l,c),u.drawText(e,i,n)}}function vm(r,e,t,i,n){const s=t.getFill(),o=t.getStroke();if(s||o){const l=r.getBuilder(t.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,i,n)}const a=t.getText();if(a&&a.getText()){const l=r.getBuilder(t.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,n)}}class wm extends X2{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=li(),this.wrappedRenderedExtent_=li(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,t,i){const n=t.extent,s=t.viewState,o=s.center,a=s.resolution,l=s.projection,h=s.rotation,c=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=t.pixelRatio,g=t.viewHints,_=!(g[vt.ANIMATING]||g[vt.INTERACTING]),m=this.context,y=Math.round(Ye(n)/a*f),p=Math.round(Bt(n)/a*f),T=u.getWrapX()&&l.canWrapX(),E=T?Ye(c):null,x=T?Math.ceil((n[2]-c[2])/E)+1:1;let v=T?Math.floor((n[0]-c[0])/E):0;do{const C=this.getRenderTransform(o,a,h,f,y,p,v*E);e.execute(m,[m.canvas.width,m.canvas.height],C,h,_,i===void 0?hr:i?b1:om,i?d&&t.declutter[d]:void 0)}while(++v<x)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ht(this.context.canvas.width,this.context.canvas.height,Al))}resetDrawContext_(){if(this.opacity_!==1){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Fn(this.context),Al.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.resetDrawContext_())}renderFrame(e,t){const i=e.pixelRatio,n=e.layerStatesArray[e.layerIndex];this.opacity_=n.opacity;const s=e.extent,o=e.viewState.resolution,a=Math.round(Ye(s)/o*i),l=Math.round(Bt(s)/o*i);Ci(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/i,1/i,0,-a/2,-l/2),gc(this.inversePixelTransform,this.pixelTransform);const h=sd(this.pixelTransform);this.useContainer(t,h,this.getBackground(e));const c=this.context,u=c.canvas,d=this.replayGroup_;let f=d&&!d.isEmpty();if(!f&&!(this.getLayer().hasListener(gt.PRERENDER)||this.getLayer().hasListener(gt.POSTRENDER)))return null;u.width!=a||u.height!=l?(u.width=a,u.height=l,u.style.transform!==h&&(u.style.transform=h)):this.containerReused||c.clearRect(0,0,a,l),this.setDrawContext_(),this.preRender(c,e);const g=e.viewState;g.projection;let _=!1;if(f&&n.extent&&this.clipping){const m=en(n.extent);f=zt(m,e.extent),_=f&&!er(m,e.extent),_&&this.clipUnrotated(c,e,m)}return f&&this.renderWorlds(d,e,this.getLayer().getDeclutter()?!1:void 0),_&&c.restore(),this.postRender(c,e),this.renderedRotation_!==g.rotation&&(this.renderedRotation_=g.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(t=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=[this.context.canvas.width,this.context.canvas.height];yt(this.pixelTransform,i);const n=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),c=[],u=i[0]*ri,d=i[1]*ri;c.push(this.getRenderTransform(n,s,o,ri,u,d,0).slice());const f=h.getSource(),g=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!er(g,l)){let _=l[0];const m=Ye(g);let y=0,p;for(;_<g[0];)--y,p=m*y,c.push(this.getRenderTransform(n,s,o,ri,u,d,p).slice()),_+=m;for(y=0,_=l[2];_>g[2];)++y,p=m*y,c.push(this.getRenderTransform(n,s,o,ri,u,d,p).slice()),_-=m}this.hitDetectionImageData_=cm(i,c,this.renderedFeatures_,h.getStyleFunction(),l,s,o,bh(s,this.renderedPixelRatio_))}t(um(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,t,i,n,s){if(!this.replayGroup_)return;const o=t.viewState.resolution,a=t.viewState.rotation,l=this.getLayer(),h={},c=function(g,_,m){const y=Ne(g),p=h[y];if(p){if(p!==!0&&m<p.distanceSq){if(m===0)return h[y]=!0,s.splice(s.lastIndexOf(p),1),n(g,l,_);p.geometry=_,p.distanceSq=m}}else{if(m===0)return h[y]=!0,n(g,l,_);s.push(h[y]={feature:g,layer:l,geometry:_,distanceSq:m,callback:n})}};let u;const d=[this.replayGroup_],f=this.getLayer().getDeclutter();return d.some(g=>u=g.forEachFeatureAtCoordinate(e,o,a,i,c,f&&t.declutter[f]?t.declutter[f].all().map(_=>_.value):null)),u}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const t=this.getLayer(),i=t.getSource();if(!i)return!1;const n=e.viewHints[vt.ANIMATING],s=e.viewHints[vt.INTERACTING],o=t.getUpdateWhileAnimating(),a=t.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,h=e.viewState,c=h.projection,u=h.resolution,d=e.pixelRatio,f=t.getRevision(),g=t.getRenderBuffer();let _=t.getRenderOrder();_===void 0&&(_=fm);const m=h.center.slice(),y=Oo(l,g*u),p=y.slice(),T=[y.slice()],E=c.getExtent();if(i.getWrapX()&&c.canWrapX()&&!er(E,e.extent)){const U=Ye(E),L=Math.max(Ye(y)/2,U);y[0]=E[0]-L,y[2]=E[2]+L,tc(m,c);const k=W1(T[0],c);k[0]<E[0]&&k[2]<E[2]?T.push([k[0]+U,k[1],k[2]+U,k[3]]):k[0]>E[0]&&k[2]>E[2]&&T.push([k[0]-U,k[1],k[2]-U,k[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==_&&er(this.wrappedRenderedExtent_,y))return Hi(this.renderedExtent_,p)||(this.hitDetectionImageData_=null,this.renderedExtent_=p),this.renderedCenter_=m,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new im(S1(u,d),y,u,d);let v;for(let U=0,L=T.length;U<L;++U)i.loadFeatures(T[U],u,c);const C=bh(u,d);let R=!0;const S=(U,L)=>{let k;const Q=U.getStyleFunction()||t.getStyleFunction();if(Q&&(k=Q(U,u)),k){const q=this.renderFeature(U,C,k,x,v,this.getLayer().getDeclutter(),L);R=R&&!q}},P=Wo(y),O=i.getFeaturesInExtent(P);_&&O.sort(_);for(let U=0,L=O.length;U<L;++U)S(O[U],U);this.renderedFeatures_=O,this.ready=R;const N=x.finish(),V=new am(y,u,d,i.getOverlaps(),N,t.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=_,this.renderedExtent_=p,this.wrappedRenderedExtent_=y,this.renderedCenter_=m,this.renderedProjection_=c,this.renderedPixelRatio_=d,this.replayGroup_=V,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,t,i,n,s,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let h=0,c=i.length;h<c;++h)l=Ih(n,e,i[h],t,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Ih(n,e,i,t,this.boundHandleStyleImageChange_,s,o,a);return l}}class Cm extends o1{constructor(e){super(e)}createRenderer(){return new wm(this)}}const Rm={SELECT:"select"};class bm extends wi{constructor(e,t,i,n){super(e),this.selected=t,this.deselected=i,this.mapBrowserEvent=n}}const Jr={};class Ba extends Hn{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:sg,this.addCondition_=e.addCondition?e.addCondition:Xl,this.removeCondition_=e.removeCondition?e.removeCondition:Xl,this.toggleCondition_=e.toggleCondition?e.toggleCondition:c1,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:kn,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:Im(),this.features_=e.features||new si;let t;if(e.layers)if(typeof e.layers=="function")t=e.layers;else{const i=e.layers;t=function(n){return i.includes(n)}}else t=kn;this.layerFilter_=t,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,t){this.featureLayerAssociation_[Ne(e)]=t}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[Ne(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(wt.ADD,this.boundAddFeature_),this.features_.addEventListener(wt.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(wt.ADD,this.boundAddFeature_),this.features_.removeEventListener(wt.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){const i=this.getMap().getAllLayers().find(function(n){if(n instanceof Cm&&n.getSource()&&n.getSource().hasFeature(t))return n});i&&this.addFeatureLayerAssociation_(t,i)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const t=Ne(e);t in Jr||(Jr[t]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const t=this.getMap().getInteractions().getArray();for(let n=t.length-1;n>=0;--n){const s=t[n];if(s!==this&&s instanceof Ba&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const i=Ne(e);e.setStyle(Jr[i]),delete Jr[i]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[Ne(e)]}handleEvent(e){if(!this.condition_(e))return!0;const t=this.addCondition_(e),i=this.removeCondition_(e),n=this.toggleCondition_(e),s=!t&&!i&&!n,o=e.map,a=this.getFeatures(),l=[],h=[];if(s){cn(this.featureLayerAssociation_),o.forEachFeatureAtPixel(e.pixel,(c,u)=>{if(!(!(c instanceof cs)||!this.filter_(c,u)))return this.addFeatureLayerAssociation_(c,u),h.push(c),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=a.getLength()-1;c>=0;--c){const u=a.item(c),d=h.indexOf(u);d>-1?h.splice(d,1):(a.remove(u),l.push(u))}h.length!==0&&a.extend(h)}else{o.forEachFeatureAtPixel(e.pixel,(c,u)=>{if(!(!(c instanceof cs)||!this.filter_(c,u)))return(t||n)&&!a.getArray().includes(c)?(this.addFeatureLayerAssociation_(c,u),h.push(c)):(i||n)&&a.getArray().includes(c)&&(l.push(c),this.removeFeatureLayerAssociation_(c)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=l.length-1;c>=0;--c)a.remove(l[c]);a.extend(h)}return(h.length>0||l.length>0)&&this.dispatchEvent(new bm(Rm.SELECT,h,l,e)),!0}}function Im(){const r=r0();return mo(r.Polygon,r.LineString),mo(r.GeometryCollection,r.LineString),function(e){return e.getGeometry()?r[e.getGeometry().getType()]:null}}function Sh(r,e,t){const i=r.slice();return i[63]=e[t],i}function Ah(r){let e,t="Select file:",i,n,s,o,a,l,h=r[6]&&Lh(r),c=r[2]&&r[16].length>1&&Mh(r);return{c(){e=D("label"),e.textContent=t,i=ee(),n=D("select"),h&&h.c(),s=ee(),c&&c.c(),o=Ge(),this.h()},l(u){e=M(u,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Le(e)!=="svelte-qipr25"&&(e.textContent=t),i=te(u),n=M(u,"SELECT",{id:!0,class:!0});var d=G(n);h&&h.l(d),d.forEach(w),s=te(u),c&&c.l(u),o=Ge(),this.h()},h(){I(e,"class","flex max-w-[100px] place-items-center justify-center variant-outline-tertiary p-1"),I(e,"for","fileselect"),I(n,"id","fileselect"),I(n,"class","bg-primary-500 rounded-md p-1 max-lg:max-w-[100%] max-w-[80%] max-lg:mt-1 lg:ml-2"),r[1]===void 0&&Gh(()=>r[34].call(n))},m(u,d){F(u,e,d),F(u,i,d),F(u,n,d),h&&h.m(n,null),r[33](n),ts(n,r[1],!0),F(u,s,d),c&&c.m(u,d),F(u,o,d),a||(l=[tt(n,"change",r[34]),tt(n,"change",r[24])],a=!0)},p(u,d){u[6]?h?h.p(u,d):(h=Lh(u),h.c(),h.m(n,null)):h&&(h.d(1),h=null),d[0]&130&&ts(n,u[1]),u[2]&&u[16].length>1?c?c.p(u,d):(c=Mh(u),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},d(u){u&&(w(e),w(i),w(n),w(s),w(o)),h&&h.d(),r[33](null),c&&c.d(u),a=!1,xs(l)}}}function Lh(r){let e,t=mt(r[7]),i=[];for(let n=0;n<t.length;n+=1)i[n]=Dh(Sh(r,t,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();e=Ge()},l(n){for(let s=0;s<i.length;s+=1)i[s].l(n);e=Ge()},m(n,s){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,s);F(n,e,s)},p(n,s){if(s[0]&128){t=mt(n[7]);let o;for(o=0;o<t.length;o+=1){const a=Sh(n,t,o);i[o]?i[o].p(a,s):(i[o]=Dh(a),i[o].c(),i[o].m(e.parentNode,e))}for(;o<i.length;o+=1)i[o].d(1);i.length=t.length}},d(n){n&&w(e),vi(i,n)}}}function Dh(r){let e,t=r[63]+"",i,n,s;return{c(){e=D("option"),i=W(t),n=ee(),this.h()},l(o){e=M(o,"OPTION",{});var a=G(e);i=Y(a,t),n=te(a),a.forEach(w),this.h()},h(){e.__value=s=r[63],jt(e,e.__value)},m(o,a){F(o,e,a),b(e,i),b(e,n)},p(o,a){a[0]&128&&t!==(t=o[63]+"")&&pe(i,t),a[0]&128&&s!==(s=o[63])&&(e.__value=s,jt(e,e.__value))},d(o){o&&w(e)}}}function Mh(r){let e;function t(s,o){return s[5]?Am:Sm}let i=t(r),n=i(r);return{c(){n.c(),e=Ge()},l(s){n.l(s),e=Ge()},m(s,o){n.m(s,o),F(s,e,o)},p(s,o){i===(i=t(s))&&n?n.p(s,o):(n.d(1),n=i(s),n&&(n.c(),n.m(e.parentNode,e)))},d(s){s&&w(e),n.d(s)}}}function Sm(r){let e,t,i="Compare layer",n,s;return{c(){e=D("div"),t=D("button"),t.textContent=i,this.h()},l(o){e=M(o,"DIV",{});var a=G(e);t=M(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(t)!=="svelte-756zk3"&&(t.textContent=i),a.forEach(w),this.h()},h(){I(t,"class","variant-filled-tertiary hover:bg-tertiary-600 p-1 px-2 lg:ml-2 max-lg:mt-1 rounded-md")},m(o,a){F(o,e,a),b(e,t),n||(s=tt(t,"click",r[36]),n=!0)},p:st,d(o){o&&w(e),n=!1,s()}}}function Am(r){let e,t,i="Normal mode",n,s;return{c(){e=D("div"),t=D("button"),t.textContent=i,this.h()},l(o){e=M(o,"DIV",{});var a=G(e);t=M(a,"BUTTON",{class:!0,"data-svelte-h":!0}),Le(t)!=="svelte-1h0qcfo"&&(t.textContent=i),a.forEach(w),this.h()},h(){I(t,"class","variant-filled-tertiary p-1 px-2 lg:ml-2 max-lg:mt-1 rounded-md")},m(o,a){F(o,e,a),b(e,t),n||(s=tt(t,"click",r[35]),n=!0)},p:st,d(o){o&&w(e),n=!1,s()}}}function Ph(r){let e,t,i;return t=new Uh({props:{size:"24px"}}),{c(){e=D("div"),Gi(t.$$.fragment),this.h()},l(n){e=M(n,"DIV",{class:!0});var s=G(e);Ui(t.$$.fragment,s),s.forEach(w),this.h()},h(){I(e,"class","flex-center ml-2")},m(n,s){F(n,e,s),zi(t,e,null),i=!0},i(n){i||(rt(t.$$.fragment,n),i=!0)},o(n){ft(t.$$.fragment,n),i=!1},d(n){n&&w(e),Bi(t)}}}function Oh(r){let e,t,i,n,s=`<div class="variant-outline-tertiary p-2"><span>Hovering Pixel: [</span> <span id="hovering_pixel_x"></span>,
			<span id="hovering_pixel_y"></span>
			]
			<span>  Value: </span><span id="hovering_value"></span> <span>  Status: </span><span id="status"></span></div>`,o;const a=[Dm,Lm],l=[];function h(c,u){return c[16].length>=2?0:c[16].length==1?1:-1}return~(e=h(r))&&(t=l[e]=a[e](r)),{c(){t&&t.c(),i=ee(),n=D("div"),n.innerHTML=s,this.h()},l(c){t&&t.l(c),i=te(c),n=M(c,"DIV",{class:!0,"data-svelte-h":!0}),Le(n)!=="svelte-1x6yz55"&&(n.innerHTML=s),this.h()},h(){I(n,"class","w-full px-4 mt-2")},m(c,u){~e&&l[e].m(c,u),F(c,i,u),F(c,n,u),o=!0},p(c,u){let d=e;e=h(c),e===d?~e&&l[e].p(c,u):(t&&(cr(),ft(l[d],1,1,()=>{l[d]=null}),ur()),~e?(t=l[e],t?t.p(c,u):(t=l[e]=a[e](c),t.c()),rt(t,1),t.m(i.parentNode,i)):t=null)},i(c){o||(rt(t),o=!0)},o(c){ft(t),o=!1},d(c){c&&(w(i),w(n)),~e&&l[e].d(c)}}}function Lm(r){let e,t,i,n="Single layer metadata",s,o,a,l=r[20].min+"",h,c,u,d,f=r[20].max+"",g,_,m,y,p=r[19]["time#units"]+"",T;return{c(){e=D("div"),t=D("div"),i=D("h2"),i.textContent=n,s=ee(),o=D("div"),a=W("MIN: "),h=W(l),c=ee(),u=D("div"),d=W("MAX: "),g=W(f),_=ee(),m=D("div"),y=W("Start: "),T=W(p),this.h()},l(E){e=M(E,"DIV",{class:!0});var x=G(e);t=M(x,"DIV",{class:!0});var v=G(t);i=M(v,"H2",{"data-svelte-h":!0}),Le(i)!=="svelte-9eu1dk"&&(i.textContent=n),s=te(v),o=M(v,"DIV",{id:!0});var C=G(o);a=Y(C,"MIN: "),h=Y(C,l),C.forEach(w),c=te(v),u=M(v,"DIV",{id:!0});var R=G(u);d=Y(R,"MAX: "),g=Y(R,f),R.forEach(w),_=te(v),m=M(v,"DIV",{id:!0});var S=G(m);y=Y(S,"Start: "),T=Y(S,p),S.forEach(w),v.forEach(w),x.forEach(w),this.h()},h(){I(o,"id","band_min"),I(u,"id","band_min"),I(m,"id","band_timestamp"),I(t,"class","variant-outline-tertiary grid grid-cols-1 justify-items-center p-2"),I(e,"class","w-full px-4 mt-2")},m(E,x){F(E,e,x),b(e,t),b(t,i),b(t,s),b(t,o),b(o,a),b(o,h),b(t,c),b(t,u),b(u,d),b(u,g),b(t,_),b(t,m),b(m,y),b(m,T)},p(E,x){x[0]&1048576&&l!==(l=E[20].min+"")&&pe(h,l),x[0]&1048576&&f!==(f=E[20].max+"")&&pe(g,f),x[0]&524288&&p!==(p=E[19]["time#units"]+"")&&pe(T,p)},i:st,o:st,d(E){E&&w(e)}}}function Dm(r){let e,t,i,n,s,o,a,l,h,c,u,d=r[20].min+"",f,g,_,m,y=r[20].max+"",p,T,E,x,v,C,R,S,P;function O(L){r[37](L)}function N(L){r[38](L)}let V={valMap:r[16],dateMap:r[22]};r[10]!==void 0&&(V.slider_value=r[10]),r[11]!==void 0&&(V.slider_index=r[11]),x=new C1({props:V}),Vi.push(()=>On(x,"slider_value",O)),Vi.push(()=>On(x,"slider_index",N)),x.$on("slider_changed",r[25]);let U=r[5]&&kh(r);return{c(){e=D("div"),t=D("div"),i=D("h2"),n=W("Layer meta data "),s=D("b"),o=W("#"),a=W(r[14]),l=W(":"),h=ee(),c=D("div"),u=W("MIN: "),f=W(d),g=ee(),_=D("div"),m=W("MAX: "),p=W(y),T=ee(),E=D("div"),Gi(x.$$.fragment),R=ee(),U&&U.c(),S=Ge(),this.h()},l(L){e=M(L,"DIV",{class:!0});var k=G(e);t=M(k,"DIV",{class:!0});var Q=G(t);i=M(Q,"H2",{});var q=G(i);n=Y(q,"Layer meta data "),s=M(q,"B",{});var ie=G(s);o=Y(ie,"#"),a=Y(ie,r[14]),l=Y(ie,":"),ie.forEach(w),q.forEach(w),h=te(Q),c=M(Q,"DIV",{id:!0});var J=G(c);u=Y(J,"MIN: "),f=Y(J,d),J.forEach(w),g=te(Q),_=M(Q,"DIV",{id:!0});var Z=G(_);m=Y(Z,"MAX: "),p=Y(Z,y),Z.forEach(w),Q.forEach(w),T=te(k),E=M(k,"DIV",{class:!0});var fe=G(E);Ui(x.$$.fragment,fe),fe.forEach(w),k.forEach(w),R=te(L),U&&U.l(L),S=Ge(),this.h()},h(){I(c,"id","band_min"),I(_,"id","band_min"),I(t,"class","variant-outline-tertiary min-w-[128px] md:max-w-[128px] mt-2 px-2 pt-1 max-md:grid max-md:grid-cols-1 max-md:justify-items-center"),I(E,"class","px-2 variant-outline-tertiary mt-2 pt-1 md:ml-1 w-full"),I(e,"class","md:flex w-full pl-4 pr-4")},m(L,k){F(L,e,k),b(e,t),b(t,i),b(i,n),b(i,s),b(s,o),b(s,a),b(s,l),b(t,h),b(t,c),b(c,u),b(c,f),b(t,g),b(t,_),b(_,m),b(_,p),b(e,T),b(e,E),zi(x,E,null),F(L,R,k),U&&U.m(L,k),F(L,S,k),P=!0},p(L,k){(!P||k[0]&16384)&&pe(a,L[14]),(!P||k[0]&1048576)&&d!==(d=L[20].min+"")&&pe(f,d),(!P||k[0]&1048576)&&y!==(y=L[20].max+"")&&pe(p,y);const Q={};k[0]&65536&&(Q.valMap=L[16]),!v&&k[0]&1024&&(v=!0,Q.slider_value=L[10],Pn(()=>v=!1)),!C&&k[0]&2048&&(C=!0,Q.slider_index=L[11],Pn(()=>C=!1)),x.$set(Q),L[5]?U?(U.p(L,k),k[0]&32&&rt(U,1)):(U=kh(L),U.c(),rt(U,1),U.m(S.parentNode,S)):U&&(cr(),ft(U,1,1,()=>{U=null}),ur())},i(L){P||(rt(x.$$.fragment,L),rt(U),P=!0)},o(L){ft(x.$$.fragment,L),ft(U),P=!1},d(L){L&&(w(e),w(R),w(S)),Bi(x),U&&U.d(L)}}}function kh(r){let e,t,i,n,s,o,a,l,h,c,u,d=r[21].min+"",f,g,_,m,y=r[21].max+"",p,T,E,x,v,C,R;function S(N){r[39](N)}function P(N){r[40](N)}let O={valMap:r[16],dateMap:r[22]};return r[12]!==void 0&&(O.slider_value=r[12]),r[13]!==void 0&&(O.slider_index=r[13]),x=new C1({props:O}),Vi.push(()=>On(x,"slider_value",S)),Vi.push(()=>On(x,"slider_index",P)),x.$on("slider_changed",r[26]),{c(){e=D("div"),t=D("div"),i=D("h2"),n=W("Layer meta data "),s=D("b"),o=W("#"),a=W(r[15]),l=W(":"),h=ee(),c=D("div"),u=W("MIN: "),f=W(d),g=ee(),_=D("div"),m=W("MAX: "),p=W(y),T=ee(),E=D("div"),Gi(x.$$.fragment),this.h()},l(N){e=M(N,"DIV",{class:!0});var V=G(e);t=M(V,"DIV",{class:!0});var U=G(t);i=M(U,"H2",{});var L=G(i);n=Y(L,"Layer meta data "),s=M(L,"B",{});var k=G(s);o=Y(k,"#"),a=Y(k,r[15]),l=Y(k,":"),k.forEach(w),L.forEach(w),h=te(U),c=M(U,"DIV",{id:!0});var Q=G(c);u=Y(Q,"MIN: "),f=Y(Q,d),Q.forEach(w),g=te(U),_=M(U,"DIV",{id:!0});var q=G(_);m=Y(q,"MAX: "),p=Y(q,y),q.forEach(w),U.forEach(w),T=te(V),E=M(V,"DIV",{class:!0});var ie=G(E);Ui(x.$$.fragment,ie),ie.forEach(w),V.forEach(w),this.h()},h(){I(c,"id","band_min"),I(_,"id","band_min"),I(t,"class","variant-outline-tertiary min-w-[128px] md:max-w-[128px] mt-2 px-2 pt-1 max-md:grid max-md:grid-cols-1 max-md:justify-items-center"),I(E,"class","px-2 variant-outline-tertiary mt-2 pt-1 md:ml-1 w-full"),I(e,"class","md:flex w-full pl-4 pr-4")},m(N,V){F(N,e,V),b(e,t),b(t,i),b(i,n),b(i,s),b(s,o),b(s,a),b(s,l),b(t,h),b(t,c),b(c,u),b(c,f),b(t,g),b(t,_),b(_,m),b(_,p),b(e,T),b(e,E),zi(x,E,null),R=!0},p(N,V){(!R||V[0]&32768)&&pe(a,N[15]),(!R||V[0]&2097152)&&d!==(d=N[21].min+"")&&pe(f,d),(!R||V[0]&2097152)&&y!==(y=N[21].max+"")&&pe(p,y);const U={};V[0]&65536&&(U.valMap=N[16]),!v&&V[0]&4096&&(v=!0,U.slider_value=N[12],Pn(()=>v=!1)),!C&&V[0]&8192&&(C=!0,U.slider_index=N[13],Pn(()=>C=!1)),x.$set(U)},i(N){R||(rt(x.$$.fragment,N),R=!0)},o(N){ft(x.$$.fragment,N),R=!1},d(N){N&&w(e),Bi(x)}}}function Mm(r){let e,t="<td><b>Varinfo:</b></td><td>null</td>";return{c(){e=D("tr"),e.innerHTML=t},l(i){e=M(i,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-el9xlh"&&(e.innerHTML=t)},m(i,n){F(i,e,n)},p:st,d(i){i&&w(e)}}}function Pm(r){let e,t="<td><b>Varinfo:</b></td><td></td>",i,n,s,o="Varname:",a,l,h=r[19].varinfo.NETCDF_VARNAME+"",c,u,d,f,g="Long name:",_,m,y=r[19].varinfo.long_name+"",p,T,E,x,v="Stand. name:",C,R,S=r[19].varinfo.standard_name+"",P,O,N,V,U="Type:",L,k,Q=r[19].varinfo.type+"",q,ie,J,Z,fe="Units:",Ie,X,De=r[19].varinfo.unit+"",Re;return{c(){e=D("tr"),e.innerHTML=t,i=ee(),n=D("tr"),s=D("td"),s.textContent=o,a=ee(),l=D("td"),c=W(h),u=ee(),d=D("tr"),f=D("td"),f.textContent=g,_=ee(),m=D("td"),p=W(y),T=ee(),E=D("tr"),x=D("td"),x.textContent=v,C=ee(),R=D("td"),P=W(S),O=ee(),N=D("tr"),V=D("td"),V.textContent=U,L=ee(),k=D("td"),q=W(Q),ie=ee(),J=D("tr"),Z=D("td"),Z.textContent=fe,Ie=ee(),X=D("td"),Re=W(De)},l(K){e=M(K,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-7vr72k"&&(e.innerHTML=t),i=te(K),n=M(K,"TR",{});var ce=G(n);s=M(ce,"TD",{"data-svelte-h":!0}),Le(s)!=="svelte-9f1ts6"&&(s.textContent=o),a=te(ce),l=M(ce,"TD",{});var Ke=G(l);c=Y(Ke,h),Ke.forEach(w),ce.forEach(w),u=te(K),d=M(K,"TR",{});var me=G(d);f=M(me,"TD",{"data-svelte-h":!0}),Le(f)!=="svelte-dwbizn"&&(f.textContent=g),_=te(me),m=M(me,"TD",{});var Ve=G(m);p=Y(Ve,y),Ve.forEach(w),me.forEach(w),T=te(K),E=M(K,"TR",{});var Se=G(E);x=M(Se,"TD",{"data-svelte-h":!0}),Le(x)!=="svelte-j8zr5b"&&(x.textContent=v),C=te(Se),R=M(Se,"TD",{});var ge=G(R);P=Y(ge,S),ge.forEach(w),Se.forEach(w),O=te(K),N=M(K,"TR",{});var Ee=G(N);V=M(Ee,"TD",{"data-svelte-h":!0}),Le(V)!=="svelte-m26t5w"&&(V.textContent=U),L=te(Ee),k=M(Ee,"TD",{});var Ze=G(k);q=Y(Ze,Q),Ze.forEach(w),Ee.forEach(w),ie=te(K),J=M(K,"TR",{});var Te=G(J);Z=M(Te,"TD",{"data-svelte-h":!0}),Le(Z)!=="svelte-6x24b1"&&(Z.textContent=fe),Ie=te(Te),X=M(Te,"TD",{});var ae=G(X);Re=Y(ae,De),ae.forEach(w),Te.forEach(w)},m(K,ce){F(K,e,ce),F(K,i,ce),F(K,n,ce),b(n,s),b(n,a),b(n,l),b(l,c),F(K,u,ce),F(K,d,ce),b(d,f),b(d,_),b(d,m),b(m,p),F(K,T,ce),F(K,E,ce),b(E,x),b(E,C),b(E,R),b(R,P),F(K,O,ce),F(K,N,ce),b(N,V),b(N,L),b(N,k),b(k,q),F(K,ie,ce),F(K,J,ce),b(J,Z),b(J,Ie),b(J,X),b(X,Re)},p(K,ce){ce[0]&524288&&h!==(h=K[19].varinfo.NETCDF_VARNAME+"")&&pe(c,h),ce[0]&524288&&y!==(y=K[19].varinfo.long_name+"")&&pe(p,y),ce[0]&524288&&S!==(S=K[19].varinfo.standard_name+"")&&pe(P,S),ce[0]&524288&&Q!==(Q=K[19].varinfo.type+"")&&pe(q,Q),ce[0]&524288&&De!==(De=K[19].varinfo.unit+"")&&pe(Re,De)},d(K){K&&(w(e),w(i),w(n),w(u),w(d),w(T),w(E),w(O),w(N),w(ie),w(J))}}}function Om(r){let e,t="<td><b>CornerCoordinates:</b></td><td>null</td>";return{c(){e=D("tr"),e.innerHTML=t},l(i){e=M(i,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-jgxpec"&&(e.innerHTML=t)},m(i,n){F(i,e,n)},p:st,d(i){i&&w(e)}}}function km(r){let e,t="<td><b>CornerCoordinates:</b></td><td></td>",i,n,s,o="center:",a,l,h,c=r[19].cornerCoordinates.center[0]+"",u,d,f=r[19].cornerCoordinates.center[1]+"",g,_,m,y,p,T="lowerLeft:",E,x,v,C=r[19].cornerCoordinates.lowerLeft[0]+"",R,S,P=r[19].cornerCoordinates.lowerLeft[1]+"",O,N,V,U,L,k="lowerRight:",Q,q,ie,J=r[19].cornerCoordinates.lowerRight[0]+"",Z,fe,Ie=r[19].cornerCoordinates.lowerRight[1]+"",X,De,Re,K,ce,Ke="upperLeft:",me,Ve,Se,ge=r[19].cornerCoordinates.upperLeft[0]+"",Ee,Ze,Te=r[19].cornerCoordinates.upperLeft[1]+"",ae,ve,Pe,ot,it,z="upperRight:",oe,j,le,Ae=r[19].cornerCoordinates.upperRight[0]+"",ut,je,pt=r[19].cornerCoordinates.upperRight[1]+"",$,we;return{c(){e=D("tr"),e.innerHTML=t,i=ee(),n=D("tr"),s=D("td"),s.textContent=o,a=ee(),l=D("td"),h=W("["),u=W(c),d=W(", "),g=W(f),_=W("]"),m=ee(),y=D("tr"),p=D("td"),p.textContent=T,E=ee(),x=D("td"),v=W("["),R=W(C),S=W(", "),O=W(P),N=W("]"),V=ee(),U=D("tr"),L=D("td"),L.textContent=k,Q=ee(),q=D("td"),ie=W("["),Z=W(J),fe=W(", "),X=W(Ie),De=W("]"),Re=ee(),K=D("tr"),ce=D("td"),ce.textContent=Ke,me=ee(),Ve=D("td"),Se=W("["),Ee=W(ge),Ze=W(", "),ae=W(Te),ve=W("]"),Pe=ee(),ot=D("tr"),it=D("td"),it.textContent=z,oe=ee(),j=D("td"),le=W("["),ut=W(Ae),je=W(", "),$=W(pt),we=W("]")},l(ne){e=M(ne,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-nrrol"&&(e.innerHTML=t),i=te(ne),n=M(ne,"TR",{});var ue=G(n);s=M(ue,"TD",{"data-svelte-h":!0}),Le(s)!=="svelte-1lqznpl"&&(s.textContent=o),a=te(ue),l=M(ue,"TD",{});var Me=G(l);h=Y(Me,"["),u=Y(Me,c),d=Y(Me,", "),g=Y(Me,f),_=Y(Me,"]"),Me.forEach(w),ue.forEach(w),m=te(ne),y=M(ne,"TR",{});var B=G(y);p=M(B,"TD",{"data-svelte-h":!0}),Le(p)!=="svelte-1ejbmgg"&&(p.textContent=T),E=te(B),x=M(B,"TD",{});var re=G(x);v=Y(re,"["),R=Y(re,C),S=Y(re,", "),O=Y(re,P),N=Y(re,"]"),re.forEach(w),B.forEach(w),V=te(ne),U=M(ne,"TR",{});var nt=G(U);L=M(nt,"TD",{"data-svelte-h":!0}),Le(L)!=="svelte-xpl1f1"&&(L.textContent=k),Q=te(nt),q=M(nt,"TD",{});var Qe=G(q);ie=Y(Qe,"["),Z=Y(Qe,J),fe=Y(Qe,", "),X=Y(Qe,Ie),De=Y(Qe,"]"),Qe.forEach(w),nt.forEach(w),Re=te(ne),K=M(ne,"TR",{});var We=G(K);ce=M(We,"TD",{"data-svelte-h":!0}),Le(ce)!=="svelte-158ic6n"&&(ce.textContent=Ke),me=te(We),Ve=M(We,"TD",{});var bt=G(Ve);Se=Y(bt,"["),Ee=Y(bt,ge),Ze=Y(bt,", "),ae=Y(bt,Te),ve=Y(bt,"]"),bt.forEach(w),We.forEach(w),Pe=te(ne),ot=M(ne,"TR",{});var It=G(ot);it=M(It,"TD",{"data-svelte-h":!0}),Le(it)!=="svelte-1r5at6y"&&(it.textContent=z),oe=te(It),j=M(It,"TD",{});var St=G(j);le=Y(St,"["),ut=Y(St,Ae),je=Y(St,", "),$=Y(St,pt),we=Y(St,"]"),St.forEach(w),It.forEach(w)},m(ne,ue){F(ne,e,ue),F(ne,i,ue),F(ne,n,ue),b(n,s),b(n,a),b(n,l),b(l,h),b(l,u),b(l,d),b(l,g),b(l,_),F(ne,m,ue),F(ne,y,ue),b(y,p),b(y,E),b(y,x),b(x,v),b(x,R),b(x,S),b(x,O),b(x,N),F(ne,V,ue),F(ne,U,ue),b(U,L),b(U,Q),b(U,q),b(q,ie),b(q,Z),b(q,fe),b(q,X),b(q,De),F(ne,Re,ue),F(ne,K,ue),b(K,ce),b(K,me),b(K,Ve),b(Ve,Se),b(Ve,Ee),b(Ve,Ze),b(Ve,ae),b(Ve,ve),F(ne,Pe,ue),F(ne,ot,ue),b(ot,it),b(ot,oe),b(ot,j),b(j,le),b(j,ut),b(j,je),b(j,$),b(j,we)},p(ne,ue){ue[0]&524288&&c!==(c=ne[19].cornerCoordinates.center[0]+"")&&pe(u,c),ue[0]&524288&&f!==(f=ne[19].cornerCoordinates.center[1]+"")&&pe(g,f),ue[0]&524288&&C!==(C=ne[19].cornerCoordinates.lowerLeft[0]+"")&&pe(R,C),ue[0]&524288&&P!==(P=ne[19].cornerCoordinates.lowerLeft[1]+"")&&pe(O,P),ue[0]&524288&&J!==(J=ne[19].cornerCoordinates.lowerRight[0]+"")&&pe(Z,J),ue[0]&524288&&Ie!==(Ie=ne[19].cornerCoordinates.lowerRight[1]+"")&&pe(X,Ie),ue[0]&524288&&ge!==(ge=ne[19].cornerCoordinates.upperLeft[0]+"")&&pe(Ee,ge),ue[0]&524288&&Te!==(Te=ne[19].cornerCoordinates.upperLeft[1]+"")&&pe(ae,Te),ue[0]&524288&&Ae!==(Ae=ne[19].cornerCoordinates.upperRight[0]+"")&&pe(ut,Ae),ue[0]&524288&&pt!==(pt=ne[19].cornerCoordinates.upperRight[1]+"")&&pe($,pt)},d(ne){ne&&(w(e),w(i),w(n),w(m),w(y),w(V),w(U),w(Re),w(K),w(Pe),w(ot))}}}function Fm(r){let e,t="<td><b>Extent:</b></td><td>null</td>";return{c(){e=D("tr"),e.innerHTML=t},l(i){e=M(i,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-i2zt20"&&(e.innerHTML=t)},m(i,n){F(i,e,n)},p:st,d(i){i&&w(e)}}}function Nm(r){let e,t="<td><b>Extent:</b></td><td></td>",i,n,s,o="Type:",a,l,h=r[19].extent.type+"",c,u,d,f,g="Coordinates:",_,m,y=r[19].extent.coordinates+"",p;return{c(){e=D("tr"),e.innerHTML=t,i=ee(),n=D("tr"),s=D("td"),s.textContent=o,a=ee(),l=D("td"),c=W(h),u=ee(),d=D("tr"),f=D("td"),f.textContent=g,_=ee(),m=D("td"),p=W(y)},l(T){e=M(T,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-jmbln"&&(e.innerHTML=t),i=te(T),n=M(T,"TR",{});var E=G(n);s=M(E,"TD",{"data-svelte-h":!0}),Le(s)!=="svelte-m26t5w"&&(s.textContent=o),a=te(E),l=M(E,"TD",{});var x=G(l);c=Y(x,h),x.forEach(w),E.forEach(w),u=te(T),d=M(T,"TR",{});var v=G(d);f=M(v,"TD",{"data-svelte-h":!0}),Le(f)!=="svelte-pfsme9"&&(f.textContent=g),_=te(v),m=M(v,"TD",{});var C=G(m);p=Y(C,y),C.forEach(w),v.forEach(w)},m(T,E){F(T,e,E),F(T,i,E),F(T,n,E),b(n,s),b(n,a),b(n,l),b(l,c),F(T,u,E),F(T,d,E),b(d,f),b(d,_),b(d,m),b(m,p)},p(T,E){E[0]&524288&&h!==(h=T[19].extent.type+"")&&pe(c,h),E[0]&524288&&y!==(y=T[19].extent.coordinates+"")&&pe(p,y)},d(T){T&&(w(e),w(i),w(n),w(u),w(d))}}}function Gm(r){let e,t="<td><b>Time#Units:</b></td><td>null</td>";return{c(){e=D("tr"),e.innerHTML=t},l(i){e=M(i,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-5jswxz"&&(e.innerHTML=t)},m(i,n){F(i,e,n)},p:st,d(i){i&&w(e)}}}function Um(r){let e,t,i="<b>Time#Units:</b>",n,s=r[19]["time#units"]+"",o;return{c(){e=D("tr"),t=D("td"),t.innerHTML=i,n=D("td"),o=W(s)},l(a){e=M(a,"TR",{});var l=G(e);t=M(l,"TD",{"data-svelte-h":!0}),Le(t)!=="svelte-1yux98e"&&(t.innerHTML=i),n=M(l,"TD",{});var h=G(n);o=Y(h,s),h.forEach(w),l.forEach(w)},m(a,l){F(a,e,l),b(e,t),b(e,n),b(n,o)},p(a,l){l[0]&524288&&s!==(s=a[19]["time#units"]+"")&&pe(o,s)},d(a){a&&w(e)}}}function zm(r){let e,t="<td><b>Time#Calendar:</b></td><td>null</td>";return{c(){e=D("tr"),e.innerHTML=t},l(i){e=M(i,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-1rhf9ss"&&(e.innerHTML=t)},m(i,n){F(i,e,n)},p:st,d(i){i&&w(e)}}}function Bm(r){let e,t,i="<b>Time#Calendar:</b>",n,s=r[19]["time#calendar"]+"",o;return{c(){e=D("tr"),t=D("td"),t.innerHTML=i,n=D("td"),o=W(s)},l(a){e=M(a,"TR",{});var l=G(e);t=M(l,"TD",{"data-svelte-h":!0}),Le(t)!=="svelte-vdo7f"&&(t.innerHTML=i),n=M(l,"TD",{});var h=G(n);o=Y(h,s),h.forEach(w),l.forEach(w)},m(a,l){F(a,e,l),b(e,t),b(e,n),b(n,o)},p(a,l){l[0]&524288&&s!==(s=a[19]["time#calendar"]+"")&&pe(o,s)},d(a){a&&w(e)}}}function Xm(r){let e,t="<td><b>Size:</b></td><td>null</td>";return{c(){e=D("tr"),e.innerHTML=t},l(i){e=M(i,"TR",{"data-svelte-h":!0}),Le(e)!=="svelte-1lms29z"&&(e.innerHTML=t)},m(i,n){F(i,e,n)},p:st,d(i){i&&w(e)}}}function Vm(r){let e,t,i="<b>Size:</b>",n,s,o=r[19].size[0]+"",a,l,h=r[19].size[1]+"",c,u;return{c(){e=D("tr"),t=D("td"),t.innerHTML=i,n=D("td"),s=W("["),a=W(o),l=W(", "),c=W(h),u=W("]")},l(d){e=M(d,"TR",{});var f=G(e);t=M(f,"TD",{"data-svelte-h":!0}),Le(t)!=="svelte-nge2si"&&(t.innerHTML=i),n=M(f,"TD",{});var g=G(n);s=Y(g,"["),a=Y(g,o),l=Y(g,", "),c=Y(g,h),u=Y(g,"]"),g.forEach(w),f.forEach(w)},m(d,f){F(d,e,f),b(e,t),b(e,n),b(n,s),b(n,a),b(n,l),b(n,c),b(n,u)},p(d,f){f[0]&524288&&o!==(o=d[19].size[0]+"")&&pe(a,o),f[0]&524288&&h!==(h=d[19].size[1]+"")&&pe(c,h)},d(d){d&&w(e)}}}function jm(r){let e,t,i="Data Visualization",n,s,o,a,l,h,c,u,d,f,g,_,m,y,p,T,E,x,v,C,R,S,P,O,N=r[18].toFixed(2)+"",V,U,L,k,Q,q,ie,J,Z,fe,Ie,X,De,Re,K,ce,Ke;o=new Z_({props:{w:"38"}});function me(B){r[31](B)}let Ve={};r[0]!==void 0&&(Ve.foldertype=r[0]),h=new k1({props:Ve}),Vi.push(()=>On(h,"foldertype",me)),h.$on("foldertype_changed",r[29]);let Se=r[0]&&Ah(r),ge=r[3]&&Ph(),Ee=r[16]&&r[2]&&Oh(r);function Ze(B){r[42](B)}let Te={cmin_real:r[20].min,cmax_real:r[20].max,num_digits:2,init_color_scheme:"prec_div"};r[4]!==void 0&&(Te.horizontal=r[4]),x=new V_({props:Te}),r[41](x),Vi.push(()=>On(x,"horizontal",Ze)),x.$on("color_stops_changed",r[27]);function ae(B,re){return B[19].varinfo!=null?Pm:Mm}let ve=ae(r),Pe=ve(r);function ot(B,re){return B[19].cornerCoordinates?km:Om}let it=ot(r),z=it(r);function oe(B,re){return B[19].extent?Nm:Fm}let j=oe(r),le=j(r);function Ae(B,re){return B[19]["time#units"]?Um:Gm}let ut=Ae(r),je=ut(r);function pt(B,re){return B[19]["time#calendar"]?Bm:zm}let $=pt(r),we=$(r);function ne(B,re){return B[19].size?Vm:Xm}let ue=ne(r),Me=ue(r);return{c(){e=D("div"),t=D("h1"),t.textContent=i,n=ee(),s=D("div"),Gi(o.$$.fragment),a=ee(),l=D("div"),Gi(h.$$.fragment),u=ee(),d=D("div"),f=D("input"),g=ee(),_=D("div"),Se&&Se.c(),m=ee(),ge&&ge.c(),y=ee(),Ee&&Ee.c(),p=ee(),T=D("div"),E=D("div"),Gi(x.$$.fragment),C=ee(),R=D("div"),S=D("div"),P=D("label"),O=W("Layer opacity "),V=W(N),U=ee(),L=D("input"),k=ee(),Q=D("div"),ie=ee(),J=D("div"),Z=D("table"),Pe.c(),fe=ee(),z.c(),Ie=ee(),le.c(),X=ee(),je.c(),De=ee(),we.c(),Re=ee(),Me.c(),this.h()},l(B){e=M(B,"DIV",{class:!0});var re=G(e);t=M(re,"H1",{class:!0,"data-svelte-h":!0}),Le(t)!=="svelte-jnn1rx"&&(t.textContent=i),n=te(re),s=M(re,"DIV",{class:!0});var nt=G(s);Ui(o.$$.fragment,nt),nt.forEach(w),re.forEach(w),a=te(B),l=M(B,"DIV",{class:!0});var Qe=G(l);Ui(h.$$.fragment,Qe),Qe.forEach(w),u=te(B),d=M(B,"DIV",{class:!0});var We=G(d);f=M(We,"INPUT",{class:!0,type:!0,placeholder:!0}),We.forEach(w),g=te(B),_=M(B,"DIV",{class:!0});var bt=G(_);Se&&Se.l(bt),m=te(bt),ge&&ge.l(bt),bt.forEach(w),y=te(B),Ee&&Ee.l(B),p=te(B),T=M(B,"DIV",{class:!0});var It=G(T);E=M(It,"DIV",{class:!0});var St=G(E);Ui(x.$$.fragment,St),St.forEach(w),C=te(It),R=M(It,"DIV",{class:!0});var $t=G(R);S=M($t,"DIV",{class:!0});var Zn=G(S);P=M(Zn,"LABEL",{});var bi=G(P);O=Y(bi,"Layer opacity "),V=Y(bi,N),U=te(bi),L=M(bi,"INPUT",{id:!0,type:!0,min:!0,max:!0,step:!0}),bi.forEach(w),Zn.forEach(w),k=te($t),Q=M($t,"DIV",{id:!0,class:!0}),G(Q).forEach(w),$t.forEach(w),It.forEach(w),ie=te(B),J=M(B,"DIV",{class:!0});var At=G(J);Z=M(At,"TABLE",{});var at=G(Z);Pe.l(at),fe=te(at),z.l(at),Ie=te(at),le.l(at),X=te(at),je.l(at),De=te(at),we.l(at),Re=te(at),Me.l(at),at.forEach(w),At.forEach(w),this.h()},h(){I(t,"class","content-heading"),I(s,"class","flex-center"),I(e,"class","flex px-4"),I(l,"class","px-2"),I(f,"class","input w-full mt-4 p-2"),I(f,"type","text"),I(f,"placeholder","Type to filter filenames..."),I(d,"class","p-2"),I(_,"class","lg:flex px-4 pt-4 w-full"),I(E,"class","flex justify-center items-center"),I(L,"id","opacity-input"),I(L,"type","range"),I(L,"min","0"),I(L,"max","1"),I(L,"step","0.01"),I(S,"class","absolute z-10 align-top right-[16px] px-1 text-black bg-[#ffffff88]"),I(Q,"id","map"),I(Q,"class","map svelte-nnyckg"),I(R,"class","px-4 pt-4 w-full relative"),I(T,"class",q=r[4]?"":"flex"),I(J,"class","mt-4")},m(B,re){F(B,e,re),b(e,t),b(e,n),b(e,s),zi(o,s,null),F(B,a,re),F(B,l,re),zi(h,l,null),F(B,u,re),F(B,d,re),b(d,f),jt(f,r[8]),F(B,g,re),F(B,_,re),Se&&Se.m(_,null),b(_,m),ge&&ge.m(_,null),F(B,y,re),Ee&&Ee.m(B,re),F(B,p,re),F(B,T,re),b(T,E),zi(x,E,null),b(T,C),b(T,R),b(R,S),b(S,P),b(P,O),b(P,V),b(P,U),b(P,L),jt(L,r[18]),b(R,k),b(R,Q),F(B,ie,re),F(B,J,re),b(J,Z),Pe.m(Z,null),b(Z,fe),z.m(Z,null),b(Z,Ie),le.m(Z,null),b(Z,X),je.m(Z,null),b(Z,De),we.m(Z,null),b(Z,Re),Me.m(Z,null),K=!0,ce||(Ke=[tt(f,"input",r[32]),tt(f,"input",r[30]),tt(L,"input",r[23]),tt(L,"change",r[43]),tt(L,"input",r[43])],ce=!0)},p(B,re){const nt={};!c&&re[0]&1&&(c=!0,nt.foldertype=B[0],Pn(()=>c=!1)),h.$set(nt),re[0]&256&&f.value!==B[8]&&jt(f,B[8]),B[0]?Se?Se.p(B,re):(Se=Ah(B),Se.c(),Se.m(_,m)):Se&&(Se.d(1),Se=null),B[3]?ge?re[0]&8&&rt(ge,1):(ge=Ph(),ge.c(),rt(ge,1),ge.m(_,null)):ge&&(cr(),ft(ge,1,1,()=>{ge=null}),ur()),B[16]&&B[2]?Ee?(Ee.p(B,re),re[0]&65540&&rt(Ee,1)):(Ee=Oh(B),Ee.c(),rt(Ee,1),Ee.m(p.parentNode,p)):Ee&&(cr(),ft(Ee,1,1,()=>{Ee=null}),ur());const Qe={};re[0]&1048576&&(Qe.cmin_real=B[20].min),re[0]&1048576&&(Qe.cmax_real=B[20].max),!v&&re[0]&16&&(v=!0,Qe.horizontal=B[4],Pn(()=>v=!1)),x.$set(Qe),(!K||re[0]&262144)&&N!==(N=B[18].toFixed(2)+"")&&pe(V,N),re[0]&262144&&jt(L,B[18]),(!K||re[0]&16&&q!==(q=B[4]?"":"flex"))&&I(T,"class",q),ve===(ve=ae(B))&&Pe?Pe.p(B,re):(Pe.d(1),Pe=ve(B),Pe&&(Pe.c(),Pe.m(Z,fe))),it===(it=ot(B))&&z?z.p(B,re):(z.d(1),z=it(B),z&&(z.c(),z.m(Z,Ie))),j===(j=oe(B))&&le?le.p(B,re):(le.d(1),le=j(B),le&&(le.c(),le.m(Z,X))),ut===(ut=Ae(B))&&je?je.p(B,re):(je.d(1),je=ut(B),je&&(je.c(),je.m(Z,De))),$===($=pt(B))&&we?we.p(B,re):(we.d(1),we=$(B),we&&(we.c(),we.m(Z,Re))),ue===(ue=ne(B))&&Me?Me.p(B,re):(Me.d(1),Me=ue(B),Me&&(Me.c(),Me.m(Z,null)))},i(B){K||(rt(o.$$.fragment,B),rt(h.$$.fragment,B),rt(ge),rt(Ee),rt(x.$$.fragment,B),K=!0)},o(B){ft(o.$$.fragment,B),ft(h.$$.fragment,B),ft(ge),ft(Ee),ft(x.$$.fragment,B),K=!1},d(B){B&&(w(e),w(a),w(l),w(u),w(d),w(g),w(_),w(y),w(p),w(T),w(ie),w(J)),Bi(o),Bi(h),Se&&Se.d(),ge&&ge.d(),Ee&&Ee.d(B),r[41](null),Bi(x),Pe.d(),z.d(),le.d(),je.d(),we.d(),Me.d(),ce=!1,xs(Ke)}}}const uo=432e5;function Wm(r,e){var t=["case",["==",e,0],[0,0,0,0]];for(let i=0;i<r.length;i++)i%2==0?t.push(["between",e,r[i][0],r[i][1]]):t.push(r[i]);return t.push(["<",e,r[0][0]]),t.push(r[1]),t.push([">",e,r[r.length-2][1]]),t.push(r[r.length-1]),t.push([0,0,0,0]),t}function Ym(r,e,t){let i=0,n=!1,s=!1,o=!0,a=!1,l=[],h=[],{foldertype:c="water_budget"}=e,{selected_file:u=""}=e,d="",f="",g="",_,m,y,p,T,E=1,x=1,v=[],C=[],R,S=null,P=null,O=1,N={},V,U=new ni({center:[25,-15],projection:"EPSG:4326",zoom:4.7}),L={min:0,max:0},k={min:0,max:0};function Q(){P&&P.setOpacity(O)}Qi(()=>{Ze()}),Qi(()=>{q(),ge()}),Qi(()=>{Q()}),Qi(()=>{u!=""&&X()});function q(){V=new Tg({target:"map",layers:[new Po({source:new C2})],view:U});function $(we){if(!P)return;const ne=P.getData(we.pixel);if(!ne)return;const ue=ne[0];var Me=document.getElementById("hovering_pixel_x"),B=document.getElementById("hovering_pixel_y");Me!=null&&(Me.textContent=we.pixel[0].toFixed(0)),B!=null&&(B.textContent=we.pixel[1].toFixed(0));var re=document.getElementById("hovering_value");re!=null&&(re.textContent=ue.toFixed(2))}V.on(["pointermove","click"],$)}async function ie($){if($=="")throw new Error("Empty url!");const ne=await(await fetch($)).blob();f=URL.createObjectURL(ne)}async function J(){await Gr(),a?R.set_bounds_real(L.min-k.max,L.max-k.min,!0):R.set_bounds_real(L.min,L.max,!0)}async function Z(){var $=N.bands;t(20,L.min=$[E].min,L),t(20,L.max=$[E].max,L),await J()}async function fe(){var $=N.bands;t(21,k.min=$[x].min,k),t(21,k.max=$[x].max,k),await J()}async function Ie(){if(!N.bands||!N.NETCDF_DIM_time_VALUES||!N["time#units"])throw t(3,s=!1),new Error("Missing either bands, NETCDF_DIM_time_VALUES or time#units on metadata. Visualization impossible.. Aborting.");var $=N.bands;try{var we=N.NETCDF_DIM_time_VALUES}catch(We){console.log(`Could not parse NETCDF_DIM_time_VALUES. Visualization impossible.. Aborting. Reason:
 ${We}`)}try{var ne=parseFloat($[E].min),ue=parseFloat($[E].max);if(isNaN(ne)||isNaN(ue))throw t(3,s=!1),new Error("Meta_min or Meta_max evaluated to NaN.");t(20,L.min=ne,L),t(20,L.max=ue,L),t(21,k.min=ne,k),t(21,k.max=ue,k)}catch(We){console.log(`Could not parse meta_min ${$[E].min} or meta_max ${$[E].max}.`),console.log(`Reason: ${We}`),console.log("Defaulting to min: -1000.0 and max: +1000.0 ... Change them in the Colorpicker as needed."),t(20,L.min=-1e3,L),t(20,L.max=1e3,L),t(21,k.min=-1e3,k),t(21,k.max=1e3,k)}t(16,v=[]);for(var Me=N["time#units"],B=Me.split(" "),re=NaN,nt=0;nt<B.length&&(re=Date.parse(B[nt]),!!isNaN(re));nt++);if(isNaN(re))throw console.log("Could not parse metadata timestamp."),Me="",new Error("Metadata timestamp is invalid.");try{var Qe=parseFloat(we[we.length-1]);if(Qe>365?i=0:i=1,Me=="")for(let We=0;We<we.length;We++)v.push(parseFloat(we[We]));else for(let We=0;We<we.length;We++)i==0?v.push(new Date(re+parseFloat(we[We])*uo*2).getFullYear()):i==1&&v.push(new Date(re+parseFloat(we[We])*uo*2).toLocaleDateString()),C.push(re+parseFloat(we[We])*uo*2)}catch(We){console.log(`Encountered error while assigning net_cdf_values to bandslider: ${We}`)}}async function X($){t(2,n=!1),t(3,s=!0),await Gr(),t(14,E=1),t(15,x=1),t(11,y=0),t(13,T=0),t(5,a=!1);var we=ja+"/climate/access_tif?type="+c+"&name="+u;const ne=await fetch(we,{method:"GET"});let ue=[];if(!ne.ok){t(3,s=!1);var Me=await ne.text();throw new Error(`${ne.status} ${ne.statusText}
Reason: ${Me}`)}ue=await ne.json();var B=ja+"/climate/get_temp_file_metadata?type="+c+"&name="+u;const re=await fetch(B,{method:"GET"});let nt=[];if(!re.ok){t(3,s=!1);var Me=await ne.text();throw new Error(`${re.status} ${re.statusText}
Reason: ${Me}`)}if(nt=await re.json(),!nt.metadata)throw t(3,s=!1),new Error("No metadata on the current metadata response.");t(19,N=nt.metadata),await Ie(),R.set_bounds_real(L.min,L.max,!0),d=ue.filedata.route,t(2,n=!0),t(3,s=!1),ie(d).then(()=>{t(2,n=!0),Ee(),t(3,s=!1)}).catch(Qe=>{t(2,n=!1),t(3,s=!1),console.log(`Encountered an error while trying to fetch file ${d}:
 ${Qe}`)})}async function De($){await Gr(),t(14,E=parseInt(y)+1),await Z(),Ee()}async function Re($){await Gr(),t(15,x=parseInt(T)+1),await fe(),Ee()}function K(){n&&Ee()}async function ce(){t(5,a=!a),a?(R.set_bounds_real(L.min-k.max,L.max-k.min),await Re()):(R.set_bounds_real(L.min,L.max),await De())}let me=new Ba({style:Se});const Ve=new Wt({fill:new Wi({color:"#eeeeee"}),stroke:new Xi({color:"rgba(255, 255, 255, 0.7)",width:2})});function Se($){var ne;const we=$.get("COLOR")||"#eeeeee";return(ne=Ve.getFill())==null||ne.setColor(we),Ve}const ge=function(){V.addInteraction(me),me.on("select",function($){document.getElementById("status").innerHTML="&nbsp;"+$.target.getFeatures().getLength()+" selected features (last operation selected "+$.selected.length+" and deselected "+$.deselected.length+" features)"})};function Ee(){var $=[];a?$=[E,x]:$=[E];const we=new v2({projection:"EPSG:4326",normalize:!1,interpolate:!1,sources:[{bands:$,url:f}]});var ne=[];a?ne=["-",["band",1],["band",2]]:ne=["band",1];const ue=ne,Me=Wm(R.get_color_boundaries("rgb"),ue);P=new Po({source:we,style:{color:Me}}),S!=null?(V.removeLayer(S),V.addLayer(P),S=P):(V.addLayer(P),S=P),P.setOpacity(O),V.setView(U)}async function Ze(){await F1(c,!0).then($=>{t(6,l=$.content)}).catch($=>{console.log($)}),t(8,g=""),Te()}function Te(){t(7,h=[]);var $=g.split(" ");for(var we in l){var ne=l[we].filename,ue=ne.toLowerCase().replace("-","").replace("_",""),Me=!1;for(var B in $)if(!ue.includes($[B].toLowerCase())){Me=!0;continue}Me||h.push(ne)}t(7,h)}function ae($){c=$,t(0,c)}function ve(){g=this.value,t(8,g)}function Pe($){Vi[$?"unshift":"push"](()=>{_=$,t(9,_)})}function ot(){u=Nh(this),t(1,u),t(7,h)}const it=()=>{ce()},z=()=>{ce()};function oe($){m=$,t(10,m)}function j($){y=$,t(11,y)}function le($){p=$,t(12,p)}function Ae($){T=$,t(13,T)}function ut($){Vi[$?"unshift":"push"](()=>{R=$,t(17,R)})}function je($){o=$,t(4,o)}function pt(){O=Ts(this.value),t(18,O)}return r.$$set=$=>{"foldertype"in $&&t(0,c=$.foldertype),"selected_file"in $&&t(1,u=$.selected_file)},[c,u,n,s,o,a,l,h,g,_,m,y,p,T,E,x,v,R,O,N,L,k,C,Q,X,De,Re,K,ce,Ze,Te,ae,ve,Pe,ot,it,z,oe,j,le,Ae,ut,je,pt]}class Km extends Rr{constructor(e){super(),br(this,e,Ym,jm,Yi,{foldertype:0,selected_file:1},null,[-1,-1,-1])}}function Hm(r){let e,t,i;return t=new Uh({}),{c(){e=D("div"),Gi(t.$$.fragment),this.h()},l(n){e=M(n,"DIV",{class:!0});var s=G(e);Ui(t.$$.fragment,s),s.forEach(w),this.h()},h(){I(e,"class","flex-center mt-8")},m(n,s){F(n,e,s),zi(t,e,null),i=!0},p:st,i(n){i||(rt(t.$$.fragment,n),i=!0)},o(n){ft(t.$$.fragment,n),i=!1},d(n){n&&w(e),Bi(t)}}}function Zm(r){let e,t;return e=new Km({props:{foldertype:r[1],selected_file:r[0]}}),{c(){Gi(e.$$.fragment)},l(i){Ui(e.$$.fragment,i)},m(i,n){zi(e,i,n),t=!0},p(i,n){const s={};n&2&&(s.foldertype=i[1]),n&1&&(s.selected_file=i[0]),e.$set(s)},i(i){t||(rt(e.$$.fragment,i),t=!0)},o(i){ft(e.$$.fragment,i),t=!1},d(i){Bi(e,i)}}}function qm(r){let e,t,i,n;const s=[Zm,Hm],o=[];function a(l,h){return l[2]?0:1}return t=a(r),i=o[t]=s[t](r),{c(){e=D("div"),i.c(),this.h()},l(l){e=M(l,"DIV",{class:!0});var h=G(e);i.l(h),h.forEach(w),this.h()},h(){I(e,"class","content-div")},m(l,h){F(l,e,h),o[t].m(e,null),n=!0},p(l,[h]){let c=t;t=a(l),t===c?o[t].p(l,h):(cr(),ft(o[c],1,1,()=>{o[c]=null}),ur(),i=o[t],i?i.p(l,h):(i=o[t]=s[t](l),i.c()),rt(i,1),i.m(e,null))},i(l){n||(rt(i),n=!0)},o(l){ft(i),n=!1},d(l){l&&w(e),o[t].d()}}}function $m(r,e,t){let i="",n="",s=!1;return Qi(()=>{{var o;if(Va.subscribe(a=>{o=a}),!o){t(2,s=!0);return}t(0,i=o.filename),t(1,n=o.foldertype),(i==null||n==null)&&(t(0,i=""),t(1,n="water_budget")),Va.set({filename:null,foldertype:null}),t(2,s=!0)}}),[i,n,s]}class E3 extends Rr{constructor(e){super(),br(this,e,$m,qm,Yi,{})}}export{m3 as L,E3 as P,p3 as a};
