import{s as k,d as g,i as j,l as E,c as P,e as S,h as F,o as G,p as _}from"../chunks/E-tlr8l-.js";import{S as I,i as T,t as p,a as c,e as A,d as D,m as L,c as R,b as U,g as q}from"../chunks/B1_27-lj.js";import{A as i}from"../chunks/BO6XNHuD.js";import{_ as x}from"../chunks/DnDx1xLd.js";import{F as C}from"../chunks/z9-SrD1Y.js";function w(l){let o,e;return o=new C({props:{folder_data:l[0],file_obj:y,foldertype:l[1],in_main_page:V}}),{c(){U(o.$$.fragment)},l(a){R(o.$$.fragment,a)},m(a,t){L(o,a,t),e=!0},p(a,t){const s={};t&1&&(s.folder_data=a[0]),t&2&&(s.foldertype=a[1]),o.$set(s)},i(a){e||(c(o.$$.fragment,a),e=!0)},o(a){p(o.$$.fragment,a),e=!1},d(a){D(o,a)}}}function M(l){let o,e,a=l[0]&&l[0].metadata&&w(l);return{c(){o=F("div"),a&&a.c(),this.h()},l(t){o=P(t,"DIV",{class:!0});var s=S(o);a&&a.l(s),s.forEach(g),this.h()},h(){E(o,"class","content-div")},m(t,s){j(t,o,s),a&&a.m(o,null),e=!0},p(t,[s]){t[0]&&t[0].metadata?a?(a.p(t,s),s&1&&c(a,1)):(a=w(t),a.c(),c(a,1),a.m(o,null)):a&&(q(),p(a,1,1,()=>{a=null}),A())},i(t){e||(c(a),e=!0)},o(t){p(a),e=!1},d(t){t&&g(o),a&&a.d()}}}const y=null,V=!1;function z(l,o,e){let a=[],t,s="",u="";async function v(r,n){e(0,t=await x(r,n)),console.log(t),b(n,r)}async function b(r,n){console.log("get_metadata_and_prov",r,n,y),e(0,t.tabset=0,t);const f=await fetch(i+"/climate/get_temp_file?name="+r+"&type="+n+"&filetype=meta",{method:"GET"});if(!f.ok)t.metadata||e(0,t.metadata={},t),e(0,t.metadata={"currently no metadata available":"for this file"},t),e(0,t.metadata_exists=!1,t),console.log(t.metadata);else{const m=await f.json();a=m,await _(),t.metadata||e(0,t.metadata={},t),e(0,t.metadata_exists=!0,t),e(0,t.metadata=m,t),await _(),console.log(a)}const d=await fetch(i+"/climate/get_temp_file?name="+r+"&type="+n+"&filetype=prov",{method:"GET"});if(!d.ok)t.metadata_prov||e(0,t.metadata_prov={},t),e(0,t.metadata_prov_exists=!1,t),e(0,t.metadata_prov={"currently no provenance information available":"for this file"},t),console.log(t.metadata_prov);else{const m=await d.json();a=m,await _(),t.metadata_prov||e(0,t.metadata_prov={},t),e(0,t.metadata_prov_exists=!0,t),e(0,t.metadata_prov=m,t),await _(),console.log(a)}const h=await fetch(i+"/climate/get_temp_file?name="+r+"&type="+n+"&filetype=prov_stats",{method:"GET"});if(!h.ok)t.metadata_prov_stats||e(0,t.metadata_prov_stats={},t),e(0,t.metadata_prov_stats_exists=!1,t),e(0,t.metadata_prov_stats={"currently no provenance information available":"for this file"},t),console.log(t.metadata_prov_stats);else{const m=await h.json();a=m,await _(),t.metadata_prov_stats||e(0,t.metadata_prov_stats={},t),e(0,t.metadata_prov_stats_exists=!0,t),e(0,t.metadata_prov_stats=m,t),await _(),console.log(a)}e(0,t.metadata_show=!0,t),history.pushState({},"","?type="+n+"&filename="+r)}G(()=>{v(s,u),console.log(t)});{const r=new URLSearchParams(window.location.search),n=r.get("type");n&&e(1,s=n);const f=r.get("filename");f&&(u=f)}return[t,s]}class O extends I{constructor(o){super(),T(this,o,z,M,k,{})}}export{O as component};
